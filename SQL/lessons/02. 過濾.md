# WHERE

**WHERE**：用於限制資料的範圍，能過濾出符合特定條件的資料條目。

- 用法：

```sql
SELECT <column_name> FROM <table_name> WHERE <condition>;
```

- 練習：

```sql
SELECT * FROM payment
WHERE amount > 0;

SELECT first_name, last_name FROM customer 
WHERE first_name = 'ADAM';

-- 查詢 amount 等於 0 的資料有幾筆
SELECT COUNT(*) FROM payment
WHERE amount = 0;

-- 查詢 amount 不等於 0 的資料有幾筆
-- 不等於操作可以使用 <>, !=，但 != 不符合 ISO 標準，因此建議使用 <>
SELECT COUNT(*) FROM payment
WHERE amount <> 0;
```

- **挑戰 1**：

寫一個 SQL 查詢來找到所有在 `Electronics` 分類中的產品紀錄。搜尋時僅需選擇產品名稱（`product`）和價格（`price`）。

注意：僅限使用 `SELECT`, `WHERE`, `ORDER BY` 等命令來完成此挑戰，並將查詢結果以 `price` 進行升序排列。

表與欄位名稱：

表名: `products`

欄位名稱: `product_id`, `name`, `category`, `price`

<details>
    <summary>參考答案</summary>

```sql
SELECT name, price FROM products
WHERE category='Electronics'
ORDER BY price ASC;

-- Ans:
-- Bluetooth Headphones	150
-- Gaming Console	450
-- Smartphone Ultra	999.99
-- Laptop Pro 15	1200
```
</details>

<br/>

- **挑戰 2**：

1. 查詢客戶 `customer_id` 為 `100` 建立了多少筆 `payment`   
2. 尋找客戶名 `first_name` 為 `ERICA` 的 `last_name`

<details>
    <summary>1. 參考答案</summary>

```sql
SELECT COUNT(*) FROM payment
WHERE customer_id = 100;

-- Ans: 24
```
</details>

<br/>

<details>
    <summary>2. 參考答案</summary>

```sql
SELECT first_name, last_name FROM customer
WHERE first_name = 'ERICA';

-- Ans: MATTHEWS
```
</details>

<br/>

# WHERE 運算子

- 練習：

```sql
SELECT * FROM payment
WHERE amount > 10.99;

-- 在 SQL 中，布林值被擴展為 TRUE, FALSE, UNKNOWN
-- NULL 值變代表著未知或不存在的狀態（UNKNOWN），而 = 運算子僅限用於值的比較
-- 因此 SQL 設計了 IS 運算子來專門進行 NULL 值比較
-- 延伸資訊：在 SQL 中，NULL 只能用 IS 比較的原因與程式語言不同，程式語言將 NULL 視為空指標
-- 因此一些程式語言要求使用 is null 等相似語法來進行比較而不是 ==
-- 大多程式語言的 == 也是設計來進行值的比較而非記憶體位址的比較
SELECT first_name, last_name FROM customer
WHERE first_name IS NULL;

SELECT first_name, last_name FROM customer
WHERE first_name IS NOT NULL;
```

- **挑戰 1 - UDEMY**:

寫一個 SQL 查詢來找到所有價格（`price`）大於 200 的產品（`products`）（只選擇名稱（`name`）和價格（`price`））

注意：僅限使用 `SELECT`, `WHERE`, `ORDER BY` 等命令來完成此挑戰，並將查詢結果以 `price` 進行升序排列。

表名與欄位名稱：

表名：products

欄位名稱：product_id, name, category, price

<details>
    <summary>參考答案</summary>

```sql
SELECT name, price FROM products
WHERE price > 200
ORDER BY price ASC;
```
</details>

<br/>

- **挑戰 2**:

1. 庫存經理要求你確認有多少筆租借（`rentals`）尚未歸還？（`return_date` 為 `null`）
2. 銷售經理要求你提交所有 `amount` 小於等於 2 的 `payment_ids` 的清單，清單中須包含 `payment_id` 和 `amount` 欄位

<details>
    <summary>1. 參考答案</summary>

```sql
SELECT COUNT(*) FROM rental
WHERE return_date is NULL;

-- Ans: 183
```
</details>

<br/>

<details>
    <summary>2. 參考答案</summary>

```sql
SELECT payment_id, amount FROM payment
WHERE amount <= 2;

-- Ans:
-- 16050	1.99
-- 16051	0.99
-- 16053	0.99
-- 16056	1.99
-- ...
-- total rows: 3644
```
</details>

# WHERE 結合 AND/OR

- 用法：

```sql
SELECT <column_name> FROM <table_name> WHERE <condition1> AND <condition2>;

SELECT <column_name> FROM <table_name> WHERE <condition1> OR <condition2>;
```

- 練習:

```sql
SELECT * FROM payment
WHERE amount = 10.99 AND customer_id = 426;

SELECT * FROM payment
WHERE amount = 10.99 OR amount = 9.99;

-- 在 SQL 中，AND 和 OR 運算子的優先順序是 AND > OR
-- 因此建議使用括號來明確指定運算子的優先順序
SELECT * FROM payment
WHERE (amount = 10.99 OR amount = 9.99) AND customer_id = 426;
```

- **挑戰 1**:

客戶經理要求你建立一筆清單，包含所有 `customer_id` 為 322, 346, 354 的客戶的 `payment_id` 和 `amount` 欄位，其中 `amount` 小於 2 或大於 10，並以 `customer_id` 進行升序排列，再以 `amount` 進行降序排列。

<details>
    <summary>參考答案</summary>

```sql
SELECT customer_id, amount FROM payment
WHERE 
(customer_id = 322 OR customer_id = 346 OR customer_id = 354)
AND 
(amount < 2 OR amount > 10)
ORDER BY customer_id ASC, amount DESC;

-- Ans:
-- 322	1.99
-- 322	1.99
-- 322	0.99
-- 322	0.99
-- ...
-- 354	0.00
-- total rows: 25
```
</details>

<br/>

# BETWEEN

- 用法:

```sql
SELECT <column_name> FROM <table_name> WHERE <column_name> BETWEEN <value1> AND <value2>;
```

- 練習:

```sql
-- 使用傳統方法
SELECT * FROM payment
WHERE payment_id >= 17000 AND payment_id <= 18000;

-- 使用 BETWEEN 更加優雅
SELECT * FROM payment
WHERE payment_id BETWEEN 17000 AND 18000;

-- 取範圍外
SELECT * FROM payment
WHERE payment_id NOT BETWEEN 17000 AND 18000;

-- 應用於時間
SELECT * FROM rental
WHERE rental_date BETWEEN '2005-05-24' AND '2005-05-26';
```
