# PenTest 概述

## 定義

-   **Penetration Testing(PenTesting)**（滲透測試）：指的是透過模擬各種攻擊向量和利用漏洞等方式來評估和測試系統、網路、應用的安全性和穩定性。

## 滲透測試的主要過程

-   **計劃（Planning the Engagement）**：定義滲透測試參與目標、範圍及規則，確保測試與受測者對測試的一切清楚，避免任何不必要的誤解和疑慮甚至是法律問題。
    
    -   **範圍（Scope）**：明確定義測試範圍，確保什麼是需要測試的、什麼不需要。
    -   **合法與合規要求（Legal and Regulatory requirements）**：根據行業的規則與國家／地區的法律，可能會對滲透測試有所限制。
    -   **交戰規則（ROE, Rule of Engagement）**：概述哪些測試行為是允許的與不允許的、哪些時間不應進行測試等，避免影響正常業務。
        
        -   **保密協定（NDA, Non-Disclosure Agreement）**：確保測試過程中得知的任何敏感資訊，包含代碼、資料、漏洞等不會被泄露。
        -   **工作說明書（SOW, Statement of Work）**：概述了測試任務與可交付成果，也包含詳細的交付服務說明與里程碑等資訊。

    -   **建立清晰的溝通管道與上報路徑（Clear communication channels and escalation paths）**：在客戶組織預定義測試中出現任何問題或緊急情況時，測試人員可以聯繫／上報客戶的管道。
    -   **了解客戶的風險承受能力與業務影響因素**：了解客戶對於風險願意承受的程度與對應的業務影響範圍來確認測試該如何進行。（例如：更嚴格的測試，但會造成業務影響；更謹慎的測試，不造成業務中斷等）
    
-   **資訊收集・偵查（Information Gathering／Reconnaissance）**：收集盡可能多的目標環境資訊，包括網路、系統、應用程式、資料庫等等。

    -   **Passive Reconnaissance（被動偵查）**：不直接與目標系統互動來收集信息，例如透過網路探測、檢測、掃描、OSINT（開源情報）等方式收集資訊，降低被檢測的風險。

        -   **常用工具與技術**：Maltego, Recon-ng, Whois Lookup, ARIN
        -   **另一視角**：搜尋求職網站通常能發現到目標組織所使用的技術與工具，更容易找尋出潛在的漏洞。

    -   **Active Reconnaissance（主動偵查）**：直接與目標系統互動來收集信息，例如透過連結系統、掃描端口、枚舉資源等方式收集資訊，能得到更準確的情報，但也提高了被檢測的風險。

        -   **常用工具與技術**：NMap, Banner grabbing, DNS enumeration, Shodan
        
    -   **平衡**：平衡資訊取得全面性與隱匿性，在難以被檢測的情況下獲得盡可能多的資訊，就是資訊收集階段的目標。

-   **攻擊和漏洞利用（Attacks and Exploits）**：試圖以各種方式進行攻擊，包含社交工程、系統攻擊、Web 應用攻擊等。

    -   **常用工具與技術**：Metasploit, Password attacks, Hydra, John the Ripper, Phishing, SQL Map
    -   **目標**：優先考慮高價值目標，並利用開源工具進行攻擊測試，找尋已知漏洞與歸納潛在影響。

-   **Post-Exploitation**：在漏洞利用後的活動，盡可能以各種手法擴大攻擊面，取得更多漏洞資訊，並清除入侵的相關紀錄。

    -   **建立持久性（Establish Persistent）**：確保對系統的持續存取，使掌控權持續存在。
    -   **提升權限（Escalate Privileges）**：若獲得的帳戶權限只是一般用戶，通常會利用各種可行方法來提權，讓攻擊面增大。
    -   **橫向移動（Lateral Movement）**：探索系統環境中是否還有能訪問的設備、帳戶或資源
    -   **目標**：這個階段更關注於最大化訪問價值，並最小化被檢測的風險。

-   **Reporting**：記錄滲透測試調查結果、方法與建議。

    1.  **創建執行摘要（Create an Execution Summary）**：以非技術語言、高層次的角度簡述對組織滲透後得知的情報，可能包含組織資安態勢、關鍵漏洞、潛在財務影響等。通常提供給組織高層參考並做出決策。
    2.  **說明測試範圍和方法（Detail the Scope and Methodology）**：詳述所使用的測試方法與目標範圍。用於向客戶展示透明度，了解方法得透徹性。
    3.  **陳述發現（Present the findings）**：報告的核心，提供各漏洞的描述、發現方法、潛在影響、收集到的相關證據等
    4.  **漏洞排序（Prioritize）**：對發現的漏洞根據嚴重程度予以排序，例如使用 CVSS 分數來排序，告知客戶哪些漏洞需要優先或稍後處理。
    5.  **提供補救建議（Actionable Recommendations）**：對於提出的每個漏洞可以提供具體的建議和修補方法，以便客戶可以進行相應的措施。
    6.  **總體評估（Overall security posture）**：評估組織的整體安全態勢、現行安全措施的趨勢、改進領域等。
    7.  **結論（Conclusions）**：總結客戶應採取的後續行動。