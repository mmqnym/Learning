# 腳本基礎

## 概念

- **Scripting**（腳本編寫）：在滲透測試中用於自動化工作流程的程式碼撰寫技術
  - 是掃描網路和自動化各種攻擊的重要工具
  - 能夠簡化複雜測試並確保安全檢查的徹底性和精確性
  - 主要關聯於滲透測試領域的「偵察和列舉」階段

- **Pseudocode**（虛擬碼）：以人類可讀的方式描述算法或系統步驟的方法
  - 使用類似程式語言的結構化慣例，但主要面向人類讀者而非機器
  - 不是實際可執行的程式碼，而是用於理解程式概念的教學工具
  - 可用於理解不同程式語言的通用概念

## 程式語言與殼層概述

- **Shell**（殼層）：使用者與作業系統互動的介面
  - 在滲透測試中常用於執行各種命令和腳本

- **Programming Languages**（程式語言）：在滲透測試中常用的語言包括
  - Bash：Unix/Linux系統的主要命令殼層和腳本語言
  - PowerShell：Windows環境下的強大腳本語言
  - Python：廣泛用於滲透測試的多功能語言
  - Ruby：另一種用於安全測試的腳本語言
  - Perl：強大的文本處理語言
  - JavaScript：主要用於網頁相關的測試

## 程式設計基本概念

- **Variables**（變數）：用於存儲數據的容器
  - 在腳本中用於暫時保存資訊以供後續使用

- **Loops**（迴圈）：重複執行特定程式碼區塊的結構
  - 在自動化測試中非常有用，如掃描多個目標

- **Logic Control Structures**（邏輯控制結構）：如條件判斷(if-else)等
  - 用於根據不同條件執行不同程式碼

- **Data Structures**（數據結構）：組織和存儲數據的方式
  - 包括列表、字典、陣列等

- **Object-Oriented Programming**（物件導向程式設計）：基於「物件」概念的程式設計方法
  - 在複雜腳本開發中常用的設計方法

## 滲透測試腳本的應用

- **Automation**（自動化）：使用腳本減少手動工作並提高效率
  - 重要性：讓滲透測試人員能夠更有效地完成工作
  - 隨著經驗累積，可建立個人腳本庫以加速工作流程

- **Custom Tools**（自訂工具）：針對特定環境開發的腳本工具
  - 可用於發現通用工具可能遺漏的漏洞
  - 例如使用 Python 或 PowerShell 腳本處理特定系統錯誤配置

## 滲透測試方法論的階段

- **Phase 1: Reconnaissance (Footprinting)**（偵察階段）：收集目標資訊
- **Phase 2: Scanning (Enumeration)**（掃描階段）：識別可用系統和服務
- **Phase 3: Gaining Access (Exploitation)**（獲取存取權階段）：利用漏洞進入系統
- **Phase 4: Maintaining Access (Persistence)**（維持存取權階段）：確保持續訪問
- **Phase 5: Covering Tracks**（清除痕跡階段）：移除入侵證據
- **Phase 6: Actions on Objectives**（目標行動階段）：執行任務目標

# 殼層與程式語言

## 腳本基礎概念

- **Script**（腳本）：一系列被特定程式或腳本引擎執行的命令列表
  - 可自動化安全測試工作流程，提高效率與準確性
  - 適用於設置重複性搜尋，可排程自動執行

## 腳本語言

- **Bash**（Bourne Again Shell）：Unix 系統的腳本語言和命令殼層
  - 為 Linux 和 Mac OS X 的預設殼層
  - 支援變數、迴圈、條件陳述式和函數
  - 腳本開頭使用 shebang（#!）標記：`#!/bin/bash`
  - 範例：使用 `echo` 顯示訊息、`grep` 過濾日誌、`cut` 格式化輸出

- **PowerShell**：Windows 系統的腳本語言和命令殼層
  - 支援變數、迴圈、條件陳述式、函數
  - 使用動詞-名詞語法的 cmdlet 指令
  - 範例：`Write-Host` 顯示訊息、`Get-EventLog` 獲取系統事件日誌

- **WMIC**（Windows Management Instrumentation Command）：用於檢視遠端 Windows 機器的日誌檔案
  - 可從管理員機器檢查網域內設備的日誌
  - 範例：`wmic NTEVENT where "LogFile='Security' and EventType=5"` 查找安全事件類型的記錄

- **Python**：高階、通用型、直譯式程式語言
  - 廣泛用於資安分析和滲透測試
  - 易於編寫，適合檔案搜尋和資料解析

- **Ruby**：高階、通用型、直譯式程式語言
  - 與 Python 類似，用於資安任務
  - 直譯執行，無需先編譯

- **Perl**：通用型直譯式程式語言
  - 創建於 1980 年代末，最初用於 Unix 文字處理
  - 實用、易用且高效，具大量第三方模組

- **JavaScript**：網頁腳本語言
  - 使網頁具互動性，如彈出視窗和點擊事件
  - 多種版本：ReactJS（前端）、NodeJS（後端）
  - 對網頁應用滲透測試非常重要

## 腳本編程特點

- **直譯式執行**：腳本語言逐行解釋執行，不需事先編譯
- **易讀性**：腳本存儲為文字檔，可直接閱讀源碼
- **自動化**：可設定排程執行，如每日固定時間執行特定任務
- **應用範圍**：從簡單的日誌分析到複雜的安全檢測

# 變數與資料類型

- **Variable**（變數）：用於儲存不同資料類型的值
  - 變數的值可以在程式執行過程中改變
  - 在虛擬碼（Pseudocode）中，變數名稱使用小寫表示

- **Data Type**（資料類型）：定義變數能夠儲存的資料種類
  - 決定了變數如何被儲存和處理

## 五種主要資料類型

- **Boolean**（布林值）：儲存邏輯狀態
  - 只能儲存兩種值：true 或 false
  - 在不同程式語言中可能表示為：
    - 文字 true/false
    - 字母 T/F
    - 數字 1/0

- **Integer**（整數）：儲存整數值
  - 只能儲存不含小數點的數字
  - 可以是正數或負數（如 5、15、100、-30、58 等）
  - 受限於程式語言中整數類型的範圍限制

- **Float/Decimal/Real Number**（浮點數/小數/實數）：儲存含小數點的數值
  - 用於表示需要小數點的數字（如 53.22）
  - 與整數是不同的資料類型

- **Character**（字元）：儲存單一 ASCII 字元
  - 只能儲存一個字元，如數字、字母或符號
  - 不能用於儲存多個字元的資訊

- **String**（字串）：儲存多個字元的序列
  - 用於儲存文字資訊（如名字、句子等）
  - 由多個字元組成
  - 即使字串中是純數字，也無法直接進行數學運算

## 變數使用注意事項

- **型別轉換**（Type Conversion）：不同類型變數進行運算時需要轉換
  - 例如：整數和浮點數相加前，需要先將整數轉換為浮點數

- **Constant**（常數）：程式執行過程中不會改變的值
  - 在虛擬碼中使用全大寫表示（如 PI = 3.14159）
  - 適用於固定不變的值，如數學常數

- **變數賦值**（Assignment）：使用等號（=）將值指派給變數
  - 例如：first_name = "Jason"，將字串 "Jason" 指派給變數 first_name
  - PI = 3.14，將數值 3.14 指派給常數 PI

## 虛擬碼（Pseudocode）

- **Pseudocode**（虛擬碼）：一種通用的程式設計表示法
  - 不代表任何特定程式語言（如 Bash、Python、PowerShell、Ruby、Perl、JavaScript 等）
  - 用於表達程式邏輯和概念，不需要嚴格遵循特定程式語言的語法
  - 在虛擬碼中不必定義變數的資料類型，但在實際程式語言中可能需要

# 迴圈流程控制

- **Loops**（迴圈）：一種流程控制方式，讓程式碼能夠有序地重複執行。
  - 迴圈可以讓特定的程式碼區塊重複執行，而不需要複製貼上相同的程式碼多次。
  - 例如：希望某段程式碼執行10次，可以使用迴圈而非複製程式碼10次。

## 迴圈的三種基本類型

- **For Loop**（for迴圈）：最基本的迴圈類型，適用於已知確切的重複次數。
  - 當你明確知道需要重複執行程式碼的次數時使用。
  - 語法示例：`For i = 1 to 10 OUTPUT(i) Endfor`
  - 執行結果會顯示：1, 2, 3, 4, 5, 6, 7, 8, 9, 10

- **While Loop**（while迴圈）：在不確定確切重複次數，但知道終止條件時使用。
  - 迴圈開始前會先檢查條件是否成立。
  - 語法示例：`i = 0, While i < 10 OUTPUT(i) i = i + 1 Endwhile`
  - 與for迴圈不同，while迴圈在初始條件不滿足時可能一次都不執行。
  - 執行結果會顯示：0, 1, 2, 3, 4, 5, 6, 7, 8, 9（當i=10時條件不再滿足）

- **Do Loop**（do迴圈）：用於不確定迭代次數，但條件檢查在迴圈結束時進行。
  - 無論條件是否滿足，至少會執行一次迴圈內容。
  - 語法示例：`Do OUTPUT(i) i = i + 1 Until i > 10`
  - 適合需要至少執行一次的場景，如文件讀取。
  - 如果初始值 i=50，會輸出50然後結束（因為51>10）。
  - 如果初始值 i=0，會輸出0到10（因為只有當i>10時才會停止）。

## 實際應用案例

- **Do Loop的實際應用**：常用於檔案讀取操作。
  - 例如：`Do OUTPUT(file_line) Until end_of_file`
  - 可以逐行讀取檔案內容，直到達到檔案末尾。

# 邏輯控制

- **Logic Control**（邏輯控制）：用於根據不同邏輯測試提供條件判斷的程式設計方法
  - 可用於測試布林運算符、算術運算符或字串運算符等條件

- **Boolean Operator**（布林運算符）：處理真假值的運算符
  - 在布林代數中，1 代表 true（真），0 代表 false（假）
  - 用於執行邏輯測試，返回真或假的結果

- **IF-THEN-ELSE Statement**（條件陳述句）：基於條件進行程式流程控制的結構
  - 基本格式：IF（條件）THEN（執行區塊1）ELSE（執行區塊2）ENDIF
  - 當條件為真時執行第一個區塊，否則執行第二個區塊

- **Arithmetic Operator**（算術運算符）：進行數值比較的運算符
  - 包含常見的比較運算符如大於（>）、小於（<）、等於（=）等
  - 應用實例：`IF balance < 10.00, THEN...`（檢查帳戶餘額是否足夠）

- **String Operator**（字串運算符）：用於比較字串值的運算符
  - 字串比較通常是區分大小寫的（case-sensitive）
  - 範例：`IF x = "Jason" THEN...`

- **Nested IF**（巢狀條件判斷）：在一個條件判斷內部包含另一個條件判斷
  - 格式：IF-THEN-ELSEIF-THEN-ELSE-ENDIF
  - 用於處理多層級條件判斷邏輯
  - 系統會按照順序檢查每個條件，一旦符合某個條件就執行對應的區塊而忽略其餘

- **Boolean Conditions**（布林條件）：可以使用 AND、OR、NOT 等邏輯運算符組合多個條件
  - AND（且）：兩個條件都必須為真，結果才為真
  - OR（或）：至少一個條件為真，結果就為真
  - NOT（非）：將條件的真假值反轉
  - 範例：`IF (minutes > 60 AND minutes < 120) THEN...`（檢查時間是否在特定區間內）

- **Compound Conditions**（複合條件）：將多個邏輯測試組合在一起
  - 可以使用括號來明確指定運算優先順序
  - 可以混合使用不同類型的運算符，例如算術運算符和布林運算符
  - 可用於建立更複雜的邏輯流程控制

- **Conditional Logic Flow**（條件邏輯流程）：使用邏輯條件控制程式執行路徑的方式
  - 條件判斷可以幫助程式依據不同情況選擇不同的執行路徑
  - 可以設計多重條件來處理各種可能的情況和例外

# 資料結構

- **JSON（JavaScript Object Notation，JavaScript 物件表示法）**：一種開放式資料格式，使用人類可讀的文字來儲存和傳輸由鍵值對和陣列組成的資料物件
  - 廣泛應用於電子資料交換，特別是客戶端與伺服器間的通訊
  - 雖源自 JavaScript，但現已成為語言無關的資料格式，被 Python、Ruby、Perl 等多種程式語言支援
  - 易於解析，可轉換為其他資料結構如變數、陣列和字典
  - 資料表示範例：`{"firstName": "Jason", "lastName": "Dion", "isAlive": true}`
  - 支援多種資料類型：字串（需引號）、布林值（無需引號）、數字（無需引號）和嵌套結構
  - 在網頁應用中極為普及，已成為主流 API 資料交換的首選格式

- **鍵值對（Key-Value Pairs）**：由鍵和值組成的資料結構，鍵名在左側，值在右側
  - 用於將值與某個標題或變數名關聯
  - 值的類型表示：
    - 字串：使用引號包圍（如 `"Jason"`）
    - 布林值：直接使用 true/false（無需引號）
    - 數字：直接使用數值（無需引號）
  - 數字若不加引號，視為整數可進行數學運算；加引號則視為文字字串，不可計算

- **陣列（Array）**：用於儲存相同類型的多個值的資料結構
  - 每個位置的值可通過索引存取，索引從 0 開始
  - 以逗號分隔各元素，如 `[John, Michael, Smith]`
  - 存取方式：以陣列名加方括號內索引值，如 `name[1]` 會返回第二個位置的值 `Michael`
  - 在 JSON 中以方括號 `[ ]` 表示陣列結構

- **字典（Dictionary）**：類似陣列但儲存鍵值對的資料結構
  - 適合儲存不同類型資料的關聯，如電話簿中的姓名和電話號碼
  - 以鍵來查詢對應的值，而非索引位置
  - 建立語法範例：`phonebook = {"John": "111-1111", "Mary": "222-2222", "Mark": "333-3333"}`
  - 查詢語法範例：`phonebook["Mark"]` 將返回 `"333-3333"`
  - 可視為鍵值對的集合或關聯陣列

- **CSV（Comma-Separated Values，逗號分隔值）**：一種以純文字格式儲存表格資料的檔案類型
  - 每行代表一筆記錄，逗號用作欄位分隔符
  - 優點是跨平台相容性高，幾乎所有資料處理程式都支援
  - 可視為扁平化的資料庫格式
  - 限制：若資料中含有逗號，需特別處理（跳脫字元）
  - 格式範例：`John,Smith,111-1111`（一行資料）
  - 通常第一行可用於定義欄位名稱：`first,last,phone`

- **列表（List）**：類似陣列但可儲存不同資料類型的順序性資料結構
  - 與陣列不同，列表中的元素可以是不同資料類型（整數、字串、浮點數等）
  - 每個元素有索引值，從 0 開始（正向索引）
  - 某些程式語言支援負索引（從 -1 開始，從末尾往前計數）
  - 建立語法範例：`my_list = [1, 2, 3, "example", 3.14]`
  - 存取方式與陣列類似：`my_list[3]` 將返回 `"example"`
  - 適合存儲混合類型的有序數據

- **樹（Tree）**：非線性資料結構，由根節點和多個子節點組成
  - 結構包含根（root）、節點（node）、葉（leaf/end node）
  - 根是基礎節點，所有其他節點從根發展而來
  - 節點關係：父節點（parent）和子節點（child）
  - 應用範例：HTML DOM 結構，用於區分標籤的階層關係
  - 適合用於搜尋和組織具有階層關係的資料
  - 並非所有程式語言都原生支援樹結構

# 物件導向程式設計（Object-Oriented Programming，OOP）

- **Object-Oriented Programming（物件導向程式設計）**：一種基於物件概念的程式設計範式，物件可包含資料和程式碼，以欄位或屬性的形式來表示和引用
    - 允許使用方法（procedures/methods）來呼叫不同函數，基於物件本身的內容來執行操作
    - 每個物件可擁有自己的程序，可被存取並修改資料欄位
    - 透過類別（如汽車類別）建立不同變體（如紅車、藍車）並在程式中重複使用
    - 主流程式語言多支援物件導向，包括 Python、Ruby、Perl、JavaScript、PowerShell 等
    - Bash 作為腳本語言不支援物件導向程式設計
    - 是現代程式設計的主要範式之一，具有高度模組化和重用性

- **Function（函數）**：一段被賦予特定名稱的程式碼區塊
    - 可在任何時間呼叫該函數名稱，執行區塊內的所有程式碼
    - 使程式更模組化，可在不同程式間重複使用這些程式碼區塊
    - 定義方式依程式語言而異，例如 Python 使用 `def` 關鍵字
    - 範例：`def area(radius):` 定義一個計算圓面積的函數
    - 可透過註解（如 Python 中的 `#`）來說明程式碼功能，幫助人類閱讀理解
    - 呼叫時使用函數名稱加上參數：`area(3)`

- **Procedure（程序）**：處理輸入、產生輸出和操作資料的程式碼單元
    - 可以是函數、方法、常式或子程式
    - 在大多數現代語言中，程序和函數概念經常通用
    - 程序是更高層級的概念，可包含多個函數
    - 用於組織程式碼並提供特定功能模組

- **Class（類別）**：特定類型物件的資料格式和可用程序的定義
    - 也可包含資料和程序（函數）
    - 作為物件分組的方式
    - 是使用者定義的原型或模板，用於創建其他物件
    - 例如：「汽車」可作為一個類別，而「紅車」、「藍車」、「電動車」都是此類別的實例
    - 類別定義了基本資料結構，如汽車類別可定義為具有引擎（電動或汽油）且至少有四個輪子的交通工具
    - 類別是物件導向程式設計的核心概念

- **Library（程式庫）**：函數、變數和類別的外部集合
    - 讓程式碼可重複使用而不會在環境關閉後丟失
    - 在新環境啟動時可引用程式庫，載入所有函數
    - 各程式語言有不同的程式庫引用方式
    - 實例：開發滲透測試工具時，可直接引入處理 TCP/IP 相關的程式庫，而非重新開發
    - 節省開發時間，避免從頭開始編寫所有功能
    - 物件導向程式設計的主要優勢之一，允許重用其他滲透測試人員和軟體開發人員編寫的程式碼
    - 提高開發效率和程式碼品質