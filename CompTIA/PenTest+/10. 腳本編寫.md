# 滲透測試腳本編寫

## 腳本基礎概念

- **Scripting**（腳本編寫）：在滲透測試中用於掃描網路和自動化攻擊的重要工具
  - 腳本使複雜的測試變得更簡單，確保安全檢查更加徹底和精確
  - 可比喻為「食譜」，透過適當的修改可以滿足特定需求

## 三種主要腳本類型

### 1. Bash 腳本

- **Bash Fundamentals**（Bash 基礎）：Linux環境中最常用的腳本語言
  - 是在Linux環境中導航的首選腳本語言
  - 適合用於命令列和終端視窗操作

- **Understanding a Bash Script**（理解Bash腳本）：
  - 學習如何閱讀腳本，理解其功能和各部分的作用

- **Modifying a Bash Script**（修改Bash腳本）：
  - 實際操作如何修改現有腳本以實現新功能或自動化新任務

### 2. PowerShell 腳本

- **PowerShell**（PowerShell）：Windows管理員用於系統管理的強大工具
  - 功能強大且多用途的腳本語言
  - 專為Windows環境設計的管理工具

- **Understanding a PowerShell Script**（理解PowerShell腳本）：
  - 逐行解析腳本，理解代碼結構和執行流程

- **Modifying a PowerShell Script**（修改PowerShell腳本）：
  - 學習如何更改腳本以修改其行為並根據需求進行客製化

### 3. Python 腳本

- **Python Fundamentals**（Python基礎）：安全領域最流行的程式語言之一
  - 易於閱讀、學習，且功能強大
  - 在資安領域應用廣泛

- **Understanding a Python Script**（理解Python腳本）：
  - 透過實際演示瞭解Python腳本的結構
  - 分解腳本以理解其工作原理

- **Modifying a Python Script**（修改Python腳本）：
  - 將學到的知識付諸實踐
  - 修改現有腳本以執行新任務或以新方式工作

# Bash Shell 程式設計

## 基本概念

- **Bash Shell**（Bourne Again Shell）：一種命令列腳本語言，用於 Unix-like 系統（包括 Linux 和 macOS）的指令殼層。
  - 在所有 Linux 發行版中都預設安裝
  - 對於自動化使用命令列環境的任務非常有用
  - 主要限制：不是物件導向語言，功能比 Python、Perl、Ruby、PowerShell 或 JavaScript 受限

## 腳本結構

- **Shebang**（井字標記）：`#!/bin/bash`
  - 腳本的第一行，告訴系統這是 bash 腳本，應使用 bash shell 執行
  - 是辨識腳本類型的重要標誌

- **註解**（Comments）：使用 `#` 符號
  - `#` 後的所有內容會被腳本引擎忽略，只有人類可讀
  - 例如：`# 這是腳本的第一行` 或 `# 此腳本用於系統備份`

## 變數

- **變數宣告**（Variable Declaration）：使用 `變數名稱=值` 格式
  - 例如：`customer=Jason`
  - 使用變數時需加上 `$` 符號：`$customer`
  - 賦值時不用 $ 符號，呼叫時要用 $ 符號

- **變數型別宣告**（Variable Typing）：使用 `declare` 命令
  - `declare -i`：宣告整數型變數
    - 例如：`declare -i phoneNumber=1111111`
  - `declare -r`：宣告唯讀常數
    - 例如：`declare -r Pi=3.14`

## 陣列

- **基本陣列**（Basic Arrays）：使用括號包含值，以逗號分隔
  - 例如：`tempArray=(value1, value2, value3)`
  - 存取陣列元素：`${tempArray[1]}`（注意索引從 0 開始）

- **關聯陣列**（Associative Arrays）：使用鍵值對儲存資料
  - 宣告：`declare -A phoneBook`
  - 賦值：`phoneBook[name]=Jason` 和 `phoneBook[number]=111-1111`
  - 存取：`${phoneBook[name]}` 或 `${phoneBook[number]}`

## 比較運算

- **算術比較**（Arithmetic Comparisons）：
  - 等於：`if [ "$a" -eq "$b" ]`
  - 不等於：`if [ "$a" -ne "$b" ]`
  - 大於：`if [ "$a" -gt "$b" ]`
  - 大於等於：`if [ "$a" -ge "$b" ]`
  - 小於：`if [ "$a" -lt "$b" ]`
  - 小於等於：`if [ "$a" -le "$b" ]`

- **新版 Bash 算術比較**：使用雙括號和運算符
  - 例如：`if (( "$a" < "$b" ))`
  - 替代了 if 和中括號的使用

- **字串比較**（String Comparisons）：
  - 等於：`if [ "$a" = "$b" ]` 或 `if [ "$a" == "$b" ]`
  - 不等於：`if [ "$a" != "$b" ]`
  - 小於（ASCII 順序）：`if [ "$a" \< "$b" ]` 或 `if [[ "$a" < "$b" ]]`
  - 大於（ASCII 順序）：`if [ "$a" \> "$b" ]` 或 `if [[ "$a" > "$b" ]]`

## 流程控制

- **條件語句**（Conditional Statements）：
  - 基本格式：`if 條件 then 命令 fi`
  - 複雜格式：`if 條件1 then 命令1 elif 條件2 then 命令2 else 命令3 fi`

- **迴圈**（Loops）：
  - **For 迴圈**（For Loop）：`for 變數 in 列表 do 命令 done`
    - 例如：`for value in {1..5} do echo $value done echo "All done"`
  
  - **While 迴圈**（While Loop）：`while 測試條件 do 命令 done`
    - 例如：`counter=1; while [ $counter -lt 10 ] do echo $counter; counter++; done echo "All done"`
  
  - **Until 迴圈**（Until Loop）：`until 測試條件 do 命令 done`
    - 例如：`counter=1; until [ $counter -gt 5 ] do echo $counter; counter++; done echo "All done"`

## 字串操作

- **字串存取**（String Access）：
  - 基本格式：`${變數名:起始位置:長度}`
  - 例如：`${testString:2:4}` 會取出從位置 2 開始的 4 個字元

## 輸入/輸出操作

- **螢幕輸出**（Screen Output）：使用 `echo` 命令
  - 例如：`echo "Please enter your name:"`
  - 包含變數：`echo "Hello $username!"`

- **使用者輸入**（User Input）：使用 `read` 命令
  - 例如：`read username`

- **檔案讀取**（File Reading）：
  - 讀取檔案到變數：`TempFile=$(<test.txt)`
  - 顯示內容：`echo $TempFile`

- **檔案寫入**（File Writing）：
  - 覆寫檔案：`echo "內容" > test.txt`
  - 附加到檔案：`echo "內容" >> test.txt`

# PowerShell 程式設計

## 註解操作（Commenting）

- **Hashtag Comment**（單行註解）：使用「#」符號標記的單行註解
  - 在程式碼行使用 # 後，該行其餘部分將被系統忽略
  - 例如：`# 這是我腳本的第一行`

- **Block Comment**（區塊註解）：使用 `<#` 和 `#>` 標記的多行註解
  - 在 `<#` 和 `#>` 標籤間的所有內容都會被忽略
  - 適合註解大量文字或程式碼區塊
  - 例如：
    ```powershell
    <#
    這是註解區塊
    可用於註解大量文字或程式碼
    #>
    ```

- **Comment-Based Help**（註解式說明文件）：特殊格式的註解，可與 Get-Help 指令配合使用
  - 使用特殊關鍵字（如 .SYNOPSIS）來標記說明文件的不同部分
  - 使用者可用 Get-Help 指令查看這些註解式說明
  - 提供自我文件化的程式碼，減少單獨文件的需求

## 變數（Variables）

- **變數宣告**：PowerShell 變數以「$」符號開頭
  - 格式：`$變數名稱 = 值`
  - 例如：`$CustomerName = "Jason"`

- **變數存取**：使用「$」符號加變數名稱
  - 例如：`$CustomerName` 

- **變數型別宣告**：可明確定義變數資料型別
  - 格式：`[資料型別]$變數名稱 = 值`
  - 例如：`[int]$AnswerNumber = 42`（限整數型別）
  - 例如：`[string]$AnswerString = "The life, the universe and everything."`（限字串型別）

- **常數宣告**：使用 Set-Variable 指令將變數設為唯讀
  - 格式：`Set-Variable 常數名稱 -Option ReadOnly -Value 值`
  - 例如：`Set-Variable Pi -Option ReadOnly -Value 3.14159`

## 陣列（Arrays）

- **索引陣列**（Indexed Arrays）：儲存多個值的基本陣列
  - 建立空陣列：`$tempArray = @()`
  - 建立有初值的陣列：`$tempArray = @('Jason', 'Sahra', 'Eduardo', 'Linda')`
  - 存取陣列元素：`$tempArray[索引]`（索引從 0 開始）
  - 例如：`$tempArray[1]` 會傳回 "Sahra"

- **關聯陣列**（Associative Arrays）：具名陣列，使用鍵值對儲存資料
  - 建立關聯陣列：`$PhoneBook = @{}`
  - 賦值方式一：`$PhoneBook.name = 'Jason'` 和 `$PhoneBook.number = '321-123'`
  - 賦值方式二：`$PhoneBook = @{'name'='Jason', 'number'='321-1234'}`
  - 存取資料：`$PhoneBook.name` 或 `$PhoneBook.number`

## 比較運算子（Comparisons）

- **相等比較**：
  - `-eq`：等於（equal）
  - `-ne`：不等於（not equal）

- **大小比較**：
  - `-gt`：大於（greater than）
  - `-ge`：大於或等於（greater than or equal to）
  - `-lt`：小於（less than）
  - `-le`：小於或等於（less than or equal to）

- **使用方式**：`$變數1 -比較運算子 $變數2`
  - 例如：`$a -eq $b`（檢查 a 是否等於 b）
  - 比較結果為 true 或 false

## 條件陳述式（Conditionals）

- **If 陳述式**：基本條件判斷
  - 格式：
    ```powershell
    if (條件) {
        # 當條件為 true 執行的程式碼
    }
    ```

- **If-Else 陳述式**：二選一條件判斷
  - 格式：
    ```powershell
    if (條件) {
        # 當條件為 true 執行的程式碼
    } else {
        # 當條件為 false 執行的程式碼
    }
    ```

- **If-ElseIf-Else 陳述式**：多條件判斷
  - 格式：
    ```powershell
    if (條件1) {
        # 條件1 為 true 時執行
    } elseif (條件2) {
        # 條件1 為 false 且條件2 為 true 時執行
    } else {
        # 所有條件皆為 false 時執行
    }
    ```

## 流程控制（Flow Control）

- **For 迴圈**：固定次數迴圈
  - 格式：
    ```powershell
    for (初始值; 條件; 遞增/遞減) {
        # 執行的程式碼
    }
    ```
  - 例如：
    ```powershell
    for ($i=1; $i -lt 5; $i++) {
        Write-Host $i
    }
    Write-Host "All done"
    # 輸出：1234All done
    ```

- **Do-While 迴圈**：條件後測試迴圈（至少執行一次）
  - 格式：
    ```powershell
    do {
        # 執行的程式碼
    } while (條件)
    ```
  - 例如：
    ```powershell
    $i = 1
    do {
        Write-Host $i
        $i++
    } while ($i -le 10)
    Write-Host "All done"
    # 輸出：123456789All done
    ```

- **Do-Until 迴圈**：直到條件為真才停止的迴圈
  - 格式：
    ```powershell
    do {
        # 執行的程式碼
    } until (條件)
    ```
  - 例如：
    ```powershell
    $i = 1
    do {
        Write-Host $i
        $i++
    } until ($i -gt 5)
    Write-Host "All done"
    # 輸出：12345All done
    ```

## 字串操作（String Operations）

- **字串宣告**：使用引號包裹文字
  - 例如：`$testString = "Test String"`

- **字串串接**（Concatenation）：使用「+」符號連接字串
  - 例如：`Write-Host $testString + "2"` 顯示 "Test String2"

- **子字串**（Substring）：擷取字串的部分內容
  - 格式：`$字串.Substring(起始位置, 長度)`
  - 例如：`$testString.Substring(2, 4)` 從位置 2 開始，擷取 4 個字元
  - 注意：位置從 0 開始計數

## 輸入輸出（Input/Output）

- **螢幕輸出**：使用 Write-Host 指令
  - 例如：`Write-Host "Please enter your name:"`

- **鍵盤輸入**：使用 Read-Host 指令
  - 例如：`$UserName = Read-Host`

- **檔案讀取**：使用 Get-Content 指令
  - 例如：`$TempFile = Get-Content -Path C:\test.txt`

- **檔案寫入**（覆寫模式）：使用「>」符號重定向輸出
  - 例如：`Write-Host "This is the beginning of a new script log file" > script.log`

- **檔案寫入**（附加模式）：使用「>>」符號附加輸出
  - 例如：`.\enumerate.ps1 >> script.log`

## PowerShell 特點

- **Cmdlet 命名慣例**：使用「動詞-名詞」格式
  - 例如：Write-Host（寫入到主機）、Read-Host（從主機讀取）
  - 這是辨識 PowerShell 腳本的主要特徵

# Python 程式設計

## 基礎語法與特性

- **Python**（Python 語言）：一種設計精簡且易於使用的程式語言
  - Python 語法簡潔，減少額外的符號和字元，使程式碼更易讀易寫
  - 是一種直譯式語言，適合快速開發和除錯

- **Hashtag**（井號註解）：Python 中使用 `#` 來標記註解
  - 在 Python 中沒有區塊註解功能，需要在每一行前加上 `#` 
  - 被註解的內容會被電腦忽略不執行
  - 例如：`# 這是一行註解`

## 變數與資料類型

- **Variables**（變數）：用於儲存數值或字串等資料的命名空間
  - 定義方式：`變數名稱 = 值`
  - 例如：`Price = 10` 或 `Vendor = "CompTIA"`
  - Python 會自動判斷並指派最合適的變數類型

- **Integer**（整數）：不含小數點的數值
  - 可透過 `int()` 函數明確指定變數為整數型態
  - 例如：`Price = int(42)`

- **Float**（浮點數）：包含小數點的數值
  - 可透過 `float()` 函數明確指定變數為浮點數型態
  - 例如：`Price = float(42.00)`

- **String**（字串）：文字資料，可用單引號或雙引號表示
  - 可透過 `str()` 函數明確指定變數為字串型態
  - 例如：`Vendor = "CompTIA"` 或 `Vendor = 'CompTIA'`
  - 數字放在引號中也會被視為字串：`Vendor = "123"`

- **Constant**（常數）：Python 中沒有內建常數概念
  - 依慣例，使用全大寫變數名稱表示常數
  - 例如：`PI = 3.14159`
  - 實際上仍是變數，可被修改，只是習慣上不去更改

## 資料結構

- **Array**（陣列）：在 Python 中使用方括號建立列表
  - 建立空陣列：`tempArray = []`
  - 建立含值陣列：`tempArray = [Value1, Value2, Value3]`
  - 字串陣列範例：`nameArray = ["Jason", "Mary", "Joe", "Susan"]`
  - 存取陣列元素：`nameArray[0]` (索引從 0 開始)

- **Dictionary**（字典）：使用大括號建立鍵值對資料結構
  - 建立空字典：`PhoneBook = {}`
  - 建立含值字典：`PhoneBook = {"name": "Jason", "number": "321-1234"}`
  - 存取字典值：`PhoneBook["name"]` 會回傳 "Jason"

## 比較運算符

- **Equal To**（等於）：使用雙等號 `==` 進行比較
  - 例如：`A == B` 檢查 A 和 B 是否相等
  - 注意：單等號 `=` 是指派值的運算符，而非比較

- **Not Equal To**（不等於）：可使用 `!=` 或 `<>` 比較兩值是否不同
  - 例如：`A != B` 或 `A <> B`

- **Greater Than**（大於）：使用 `>` 符號
  - 例如：`A > B`

- **Greater Than or Equal To**（大於等於）：使用 `>=` 符號
  - 例如：`A >= B`

- **Less Than**（小於）：使用 `<` 符號
  - 例如：`A < B`

- **Less Than or Equal To**（小於等於）：使用 `<=` 符號
  - 例如：`A <= B`

## 條件與流程控制

- **If Statement**（條件陳述式）：根據條件執行程式區塊
  - 語法：`if 條件: 執行動作`
  - 例如：`if a == b: print(a)`
  - 注意 Python 使用縮排來標示程式區塊

- **If-Else Statement**（條件-否則陳述式）：提供條件成立與不成立時的不同處理
  - 語法：`if 條件: 執行動作1 else: 執行動作2`

- **If-Elif-Else Statement**（條件-否則如果-否則陳述式）：處理多條件情境
  - 語法：`if 條件1: 動作1 elif 條件2: 動作2 else: 動作3`

- **For Loop**（迴圈）：針對集合中的每個元素執行操作
  - 語法：`for 變數 in 集合: 執行動作`
  - 例如：`for CertificationName in CertificationList: print(CertificationName)`

- **While Loop**（當...時迴圈）：當條件成立時重複執行操作
  - 語法：`while 條件: 執行動作`
  - 例如：`i = 1 while i < 6: print(i) i = i + 1`
  - Python 沒有 until 迴圈，但可透過反轉 while 條件達到類似效果

## 字串操作

- **String Operations**（字串操作）：處理和操作文字資料
  - 串接字串使用加號 `+`，例如：`print(testString + " in Python" + " today")`

- **String Slicing**（字串切片）：擷取字串特定部分
  - 語法：`字串[起始位置:結束位置]`
  - 索引從 0 開始，擷取範圍包含起始位置但不包含結束位置
  - 例如：`MyName[0:4]` 擷取位置 0 到 3 的字元
  - 負數索引從字串尾部開始計算，例如：`MyName[-2]` 表示倒數第二個字元
  - 可混用正負索引，例如：`MyName[6:-2]` 或 `MyName[-4:-2]`

## 輸入與輸出

- **Input**（輸入）：從鍵盤讀取使用者輸入
  - 語法：`變數 = input("提示訊息")`
  - 例如：`userName = input("please enter your name:")`

- **Output**（輸出）：將資料顯示到螢幕
  - 語法：`print(內容)`
  - 可串接變數和字串，例如：`print("Hello " + userName + "!")`

## 檔案操作

- **File Operations**（檔案操作）：讀取或寫入檔案
  - 開啟檔案：`tempFile = open("test.txt", "模式")`
  - 寫入模式 "w"：覆寫現有內容
  - 附加模式 "a"：將內容加到檔案尾端
  - 讀取模式 "r"：讀取檔案內容

- **File Reading**（檔案讀取）：從檔案讀取資料
  - 讀取全部內容：`print(tempFile.read())`
  - 讀取特定字元數：`print(tempFile.read(50))`
  - 讀取特定行數：`print(tempFile.readline(-5))` 讀取最後 5 行

## 資訊安全應用

- **String Manipulation**（字串操作）：在資安領域中常用於處理資料
  - 可用於擷取 IP 位址特定區段，如：`IP[8:11]` 擷取第三個八位元組
  - 對日誌檔進行分析，讀取最新活動記錄
  - 資安測試腳本中常需處理各種格式的輸入和輸出

- **Python Interactive Environment**（Python 互動環境）：
  - Kali Linux 內建 Python 解譯器，可在終端機輸入 `python` 開始使用
  - 適合測試字串操作和變數處理，有助於學習和除錯
