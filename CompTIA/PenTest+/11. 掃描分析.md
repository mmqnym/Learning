# 掃描分析

## 概述

- **Analyzing Scans**（掃描分析）：從收集的數據中篩選出有用的資訊，區分真實安全漏洞與誤報
  - 目的是找出真正的漏洞並據此規劃攻擊

## 掃描結果解讀

- **Positive and Negative Results**（正面與負面結果）：理解掃描產生的各種結果類型
  - 負面結果（無發現）與正面結果（有發現）同樣可以提供重要資訊
  - 「無消息也是消息」，需要理解沒有發現的意義

- **Validating Scan Results**（驗證掃描結果）：確認掃描結果的準確性
  - 不僅要獲取結果，還需確認其準確性
  - 包含使用多種技術來確認發現的漏洞

## 漏洞評級系統

- **CVEs and CVSS**（通用漏洞披露和通用漏洞評分系統）：幫助理解發現漏洞的嚴重程度
  - 用於確定漏洞的優先處理順序
  - 提供標準化的方法評估漏洞嚴重性

- **EPSS (Exploit Prediction Scoring System)**（漏洞利用預測評分系統）：預測漏洞被利用的可能性
  - 幫助優先處理最可能被攻擊者利用的漏洞

## 目標優先級

- **Target Prioritization**（目標優先級排序）：決定將精力集中在哪些目標上
  - 考量不同漏洞的風險程度和被利用的機會
  - 關注最有可能成功的攻擊目標

- **Common Target Criteria**（常見目標標準）：確定系統或應用程序成為目標的可能性
  - 分析什麼樣的系統更可能成為攻擊目標
  - 目標評估應考慮威脅情境（漏洞是否被主動利用）和業務背景

## 技術實施與掃描驗證

- **Scripting for Result Validation**（結果驗證腳本編寫）：使用腳本確認掃描結果
  - 自動化檢查結果的準確性
  - 提高驗證效率

- **Scan Validation**（掃描驗證）：確認掃描過程本身的正常運作
  - 解決常見的掃描配置問題
  - 避免因掃描設置錯誤而浪費時間追蹤不存在的目標或漏洞
  - 需驗證先前緩解措施是否有效解決已識別的漏洞

## 攻擊規劃

- **Capability Selection**（能力選擇）：基於掃描結果選擇合適的工具和方法
  - 根據發現的漏洞類型選擇最適合的攻擊工具

- **Documenting the Attack**（記錄攻擊）：保持清晰的攻擊計劃記錄
  - 幫助保持組織性並維護事件鏈
  - 為最終報告提供完整的文檔

- **Other Attack Considerations**（其他攻擊考量因素）：考慮網路佈局和攻擊可能帶來的業務影響
  - 應考慮攻擊者目標（存取、破壞、竊取或持續控制）及漏洞管理策略
  - 使用自動掃描工具檢測基礎架構中的缺陷，並基於CVSS、EPSS和業務背景進行優先排序

# 滲透測試結果分析

- **True Positive**（陽性）：測試正確識別出實際存在的弱點或威脅
  - 例如：漏洞掃描器發現登入表單中存在 SQL 注入漏洞，經手動測試確認該漏洞確實存在且可被利用
  - 例如：在社交工程測試中，釣魚郵件準確識別出哪些員工上當，反映了組織在安全意識方面的真正弱點

- **True Negative**（陰性）：測試正確確認沒有弱點存在的情況
  - 例如：對內部網路進行全面掃描尋找可能的攻擊入口點，掃描未發現重大問題，且後續手動檢查確認所有系統都已妥善保護
  - 掃描結果準確反映網路的真實安全狀態

- **False Positive**（偽陽性）：測試錯誤地指出存在弱點，但實際上沒有
  - 例如：網站應用程式掃描器標記出聯絡表單可能存在跨站腳本（XSS）漏洞，但手動檢查後發現表單已正確進行輸入淨化處理
  - 例如：漏洞掃描器警告伺服器軟體版本過時，但實際檢查後確認伺服器已完全更新修補
  - 偽陽性會導致浪費時間和精力去調查不存在的問題

- **False Negative**（偽陰性）：測試未能檢測出實際存在的弱點或威脅
  - 例如：掃描漏掉應用程式中存在的緩衝區溢位（Buffer Overflow）漏洞
  - 例如：在實體安全測試中，未注意到側門、後門等經常未被檢查的安全漏洞
  - 偽陰性特別危險，因為它會提供虛假的安全感，而實際漏洞仍可被攻擊者利用

- **有效管理測試結果的策略**：
  - 調整測試工具和方法
  - 定期更新工具以確保最新的漏洞特徵碼和檢測能力
  - 綜合使用自動掃描和手動測試，減少假陽性和假陰性的機會
  - 採用混合方法：先進行自動掃描，再用手動測試驗證結果
  - 手動測試可發現自動化工具可能漏掉的問題，並確認發現的準確性

# 滲透測試結果驗證

## 基本概念與重要性

- **Validation**（驗證）：確保滲透測試各階段收集的數據準確且可行動
  - 幫助減少誤判（false positives）和漏報（false negatives）的影響
  - 增強與客戶的信任度，使報告更可靠
  - 提高整體滲透測試的有效性，避免關鍵問題被忽略

## 各階段驗證方法

### 掃描階段驗證

- **Scan Validation**（掃描結果驗證）：確認掃描工具識別的潛在漏洞是否真實存在
  - 掃描工具雖然可靠，但仍可能產生誤判或漏報
  - 範例：當掃描報告顯示伺服器運行過時版本的 Apache，需登入伺服器實際檢查安裝的版本

### 偵察階段驗證

- **Reconnaissance Validation**（偵察結果驗證）：確保從公開資源收集的目標信息準確性
  - 驗證工具如 theHarvester、Maltego 收集的數據
  - 範例：使用 Hunter.io 交叉驗證目標組織的電子郵件地址，或發送測試郵件查看是否退回

### 枚舉階段驗證

- **Enumeration Validation**（枚舉結果驗證）：確認對目標系統、網路和服務的詳細信息準確性
  - 驗證 Nmap、Netcat 等工具收集的系統信息
  - 範例：若 Nmap 顯示目標主機開放 SSH（端口 22），嘗試使用 SSH 客戶端連接以驗證服務是否真的運行和可訪問
  - SNMP 枚舉通常會收集到網路設備配置、ARP 表、執行中進程或甚至明文憑證

## 驗證技術與方法

- **Cross-referencing**（交叉引用）：使用多種工具或方法交叉驗證結果
  - 將自動化工具輸出與手動檢查和其他來源交叉比對
  - 範例：網頁應用掃描器標示 SQL 注入漏洞時，手動嘗試注入以確認是否可被利用

- **Manual Verification**（手動驗證）：通過手動測試確認自動化工具的結果
  - 對於關鍵漏洞，必須進行手動確認以確保準確性
  - 雖然自動化滲透測試工具有進步，但在真實環境中的有效性仍需評估

- **Alternative Sources**（替代來源）：使用不同工具或方法驗證同一信息
  - 範例：若偵察工具發現與目標相關的子域名，使用不同工具或手動 DNS 查詢來驗證其存在
  - 測試時，可使用 nmap 掃描確認 FTP 運行，然後嘗試以「anonymous」作為用戶名和密碼登入

## 實用技巧

- **定量化成就**：專業滲透測試人員應記錄識別的漏洞數量和安全狀態改進，這有助於展示工作成效
  - 在報告中精確記錄已驗證的漏洞數量
  - 提供具體可行的改善建議，提高報告價值

- **可行動的洞察**：確保驗證過的結果能轉化為客戶可執行的具體建議
  - 說明漏洞的嚴重程度、可能的影響以及修復方法
  - 提供優先修復順序建議，協助客戶資源分配

# 資安情報蒐集與漏洞管理

## 資訊來源與漏洞識別系統

- **Penetration Testing**（滲透測試）：評估系統安全性的實踐方法
  - 滲透測試人員需要持續更新最新技術和漏洞知識
  - 每次安全事件都提供了新的測試工具和方法

- **CERT**（電腦緊急應變小組）：位於 cisa.gov/uscert
  - 由美國聯邦政府維護的網站
  - 列出所有已知漏洞，包括野外發現和業界自我報告的漏洞

- **JPCERT**：日本版的電腦緊急應變小組
  - 網址為 www.jpcert.or.jp
  - 提供病毒和威脅監控的相關警報和建議

- **NVD**（國家漏洞資料庫）：由 NIST 提供，位於 nvd.nist.gov
  - 顯示最新漏洞並為每個漏洞分配 CVE 編號
  - 根據危險程度將漏洞分為關鍵、高、中、低四個等級
  - 滲透測試主要專注於關鍵和高風險漏洞

## 漏洞分類與編號系統

- **CVE**（常見漏洞和暴露）：位於 cve.org
  - 全球通用的漏洞資料庫，所有廠商都會提交已知漏洞
  - 格式如 CVE-2025-53770，其中 2025 代表年份，53770 是該年的序號
  - 實例：SharePoint 零時差漏洞 CVE-2025-53770（ToolShell）被中國駭客組織利用，攻擊至少 85 台伺服器和 29 個企業組織

- **CWE**（常見弱點枚舉）：位於 cwe.mitre.org
  - 社群開發的軟體弱點清單
  - 與 CVE 不同，CWE 專注於跨軟體產品的共同"弱點類型"
  - 對軟體開發者和針對軟體進行滲透測試的人員尤其重要

- **CAPEC**（常見攻擊模式枚舉與分類）：位於 capec.mitre.org
  - 幫助理解和識別特定攻擊模式
  - 截至 2022 年 2 月，已有 546 種不同攻擊模式
  - 對滲透測試人員很有價值，可用於模擬特定威脅行為者的攻擊手法

## 現實案例與資安威脅監控

- **Cisco ISE 漏洞**（Identity Services Engine）：
  - 三項 CVSS 滿分 10 分的嚴重漏洞：CVE-2025-20281、CVE-2025-20282 和 CVE-2025-20337
  - 這些漏洞源於 API 輸入驗證不足，攻擊者可不經認證取得 Root 權限
  - 思科 PSIRT（產品安全事件應變小組）確認有駭客濫用這些漏洞

- **SharePoint 零時差漏洞**：
  - 三個中國駭客組織利用此漏洞：Linen Typhoon（APT27）、Violet Typhoon（APT31）和 Storm-2603
  - 攻擊者通過獲取 SharePoint 伺服器的 MachineKey 配置詳細資訊繞過身份驗證
  - 相關漏洞：CVE-2025-49704、CVE-2025-49706、CVE-2025-53770、CVE-2025-53771
  - 美國網路安全暨基礎設施安全局（CISA）將部分漏洞列入已知被利用漏洞（KEV）目錄

- **Full Disclosure**（完全揭露）：由 Nmap 開發者提供的郵件列表
  - 可通過電子郵件或 RSS 閱讀器接收最新的網路安全威脅和突破

## 漏洞利用與滲透測試實務

- **漏洞掃描**（Vulnerability Scanning）：滲透測試中的重要環節
  - 掃描工具通常會以 CVE 編號報告漏洞
  - 這有助於滲透測試人員將漏洞與可能的利用方式相連結

- **Metasploit**：常用的漏洞利用框架
  - 將其攻擊模組與 CVE 編號關聯，便於識別和使用

# 資安威脅與漏洞摘要

## SharePoint 漏洞

- **Zero-day Vulnerability（零日漏洞）**：指尚未被官方修補的安全漏洞，攻擊者可立即利用
  - CVE-2025-53770（ToolShell）是 SharePoint 伺服器的嚴重零時差漏洞，已被多組中國駭客利用
  - 至少影響 85 台伺服器、29 個企業組織，包含跨國企業組織及政府機關
  - 僅影響內部部署的 SharePoint 伺服器，不影響 Microsoft 365 中的 SharePoint Online

- **CVE（Common Vulnerabilities and Exposures，通用漏洞披露）**：標識資訊安全漏洞的標準編號
  - CVE-2025-49704：遠端程式碼執行漏洞，已被列入美國 CISA 的已知被利用漏洞（KEV）目錄
  - CVE-2025-49706：詐騙漏洞，同樣已被列入 CISA 的 KEV 目錄
  - 這兩個漏洞組合形成了 ToolShell 攻擊鏈，允許未授權存取內部 SharePoint 伺服器

## 思科 ISE 漏洞

- **ISE（Identity Services Engine，身分服務引擎）**：思科的網路存取控制平台
  - 發現三項嚴重漏洞，均獲得 CVSS 10 分（滿分）評級
  - 漏洞編號為 CVE-2025-20281、CVE-2025-20282 及 CVE-2025-20337
  - 思科 PSIRT（Product Security Incident Response Team，產品安全事件應變小組）已確認部分漏洞被駭客濫用

- **Root Privilege（Root 權限）**：系統最高管理權限
  - CVE-2025-20281：源於 API 輸入驗證不足，攻擊者可發送惡意 API 請求，無需驗證即以 Root 權限執行任意程式碼
  - CVE-2025-20282：源於對檔案上傳驗證不足，允許攻擊者上傳惡意檔案至特權目錄並以 Root 權限執行
  - CVE-2025-20337：同樣因輸入驗證不足，攻擊者可發送變造 API 請求，無需憑證即可以 Root 權限執行程式

## 威脅行為者

- **APT（Advanced Persistent Threat，進階持續性威脅）**：高級持續性威脅、先進持續性威脅等隱匿而持久的電腦入侵過程
  - Linen Typhoon：中國政府資助的駭客組織，被微軟確認參與 SharePoint 零時差漏洞攻擊
  - Violet Typhoon：另一個中國政府資助的駭客組織，同樣參與此次攻擊
  - Storm-2603：第三個來自中國的駭客組織，也加入了 SharePoint 漏洞利用攻擊

## 修補與緩解措施

- **Patch（修補程式）**：用於修補軟體漏洞的程式更新
  - 思科已發布修補程式：ISE 3.3 用戶應升級至 Patch 7，ISE 3.4 用戶應升級至 Patch 2
  - 微軟已為所有支援版本的 SharePoint Server（訂閱版、2019版和2016版）發布全面安全更新
  - CISA 要求美國聯邦機構在一天內完成 SharePoint 漏洞修補

- **KEV（Known Exploited Vulnerabilities，已知被利用漏洞）目錄**：美國 CISA 維護的已被實際利用漏洞清單
  - 美國 CISA 於 2025 年 7 月 22 日將 CVE-2025-49704 和 CVE-2025-49706 列入 KEV 目錄
  - 列入 KEV 表示漏洞已有明確證據被實際攻擊利用，提升了修補的緊急性

# 目標優先順序（Target Prioritization）

- **Target Prioritization**（目標優先順序）：滲透測試中的關鍵方面，確保測試工作專注在最重要的漏洞上
  - 有效的目標優先順序包括識別高價值資產、辨認生命週期終止的軟體和系統，以及理解預設配置所帶來的風險

- **High-value Asset Identification**（高價值資產識別）：識別對組織運營和成功最為關鍵的系統、資料和流程
  - 這些可能包括客戶資料庫、財務記錄、專有軟體，以及任何一旦被入侵可能導致嚴重財務損失、聲譽損害或運營中斷的系統
  - 例如：銀行的核心銀行系統、醫療機構的患者記錄系統
  - 識別這些資產需要與利害關係人密切合作，理解不同系統和資料的業務影響
  - 常使用業務影響分析（Business Impact Analysis, BIA）和風險評估等工具

- **End-of-Life Software and Systems**（生命週期終止軟體和系統）：指不再受廠商支援的應用程式和作業系統
  - 缺乏支援意味著不再提供更新，包括安全補丁，使系統容易遭受攻擊
  - 例如：Windows XP、Adobe Flash Player 等已達生命週期終止的軟體
  - 識別並優先處理這些系統至關重要，因為攻擊者經常針對它們，知道漏洞將保持未修補狀態
  - 滲透測試人員應掃描 EOL 系統，並建議升級到受支援的版本或實施補償性控制以降低風險

- **Default Configurations**（預設配置）：許多系統來時的預設設定，旨在使初始設置更輕鬆，但對生產環境不安全
  - 預設的使用者名稱和密碼是常見例子，它們通常是眾所周知且易於被利用的
  - 例如：許多路由器的預設登入是 admin/admin 或 root/root
  - 預設配置可能啟用不必要的服務或使用不安全的設定
  - 在滲透測試中，識別這些仍使用預設配置的系統非常關鍵，因為這些設定對攻擊者來說是容易得手的目標
  - 應確保更改所有預設憑證、停用不必要的服務，並根據最佳實踐配置安全設定

## 應用案例

在中型企業滲透測試中的優先順序安排：

1. 識別高價值資產（如客戶關係管理系統和財務資料庫）
2. 掃描網路尋找生命週期終止軟體（如 Windows 7 和過時的 PHP 版本）
3. 發現使用預設配置的內部工具（如使用預設管理員憑證的資料庫）

處理順序：
1. 首先關注高價值資產，確保它們受到良好保護
2. 其次處理生命週期終止軟體，建議立即升級或隔離這些系統以限制其風險
3. 最後處理預設配置，建議變更預設設定並安全配置以防止容易的攻擊

通過專注於這些領域，確保測試工作在改善組織安全態勢方面提供最大效益，保護業務的最關鍵部分，緩解已知漏洞，並關閉攻擊者的容易入口點。

# 滲透測試目標評估標準

## 主要目標評估標準

- **Running Services**（執行中的服務）：系統上運行的服務是攻擊者潛在的入侵點
  - 每個服務可能有自己獨特的漏洞和錯誤設定
  - 例如：Apache 網頁伺服器和 FTP 伺服器可能存在不同類型的漏洞
  - 使用 Nmap 等工具可掃描開放端口並識別運行的服務
  - 識別服務後應檢查與其相關的已知漏洞（如過時的 OpenSSH 版本）

- **Vulnerable Encryption Methods**（易受攻擊的加密方法）：過時或不當實施的加密可能成為重大漏洞
  - 常見問題包括使用已棄用的算法（如 MD5 或 SHA-1）
  - 不當的金鑰管理也會導致安全風險
  - SSL/TLS 協議若使用過時版本（如 SSL 2.0/3.0）容易受到攻擊
  - 滲透測試中需識別所有使用中的加密方法並評估其強度
  - 可使用 OpenSSL 等工具評估網頁伺服器上的 SSL/TLS 實現安全性

- **POODLE**（Padding Oracle On Downgraded Legacy Encryption）：針對 SSL 3.0 協議漏洞的中間人攻擊
  - 利用 SSL 3.0 協議中的漏洞進行攻擊

- **Defensive Capabilities**（防禦能力）：組織用於檢測和應對攻擊的安全措施
  - 包括防火牆、入侵檢測和防禦系統（IDS/IPS）、安全資訊和事件管理系統
  - 了解這些能力有助於調整測試方法
  - 若組織有強大的 IDS/IPS，可能需要在偵查和利用階段更加隱蔽
  - 例如：降低 Nmap 掃描速度（如使用 T2 選項）
  - 測試這些防禦措施的有效性也很重要（如嘗試繞過 Web 應用防火牆）

## 滲透測試實例：金融機構案例

- 使用 Nmap 掃描發現混合的 HTTP、SSH 和資料庫服務
- 發現資料庫服務運行過時的 MySQL 版本，存在已知漏洞
- 使用 OpenSSL 測試網頁應用程式，發現某些應用仍支援弱加密和過時的 SSL 版本
- 評估組織的防禦能力，發現有 IDS 和 IPS 系統
- 進行隱蔽掃描和受控攻擊以測試警報觸發和阻擋效果
- 結果：IDS/IPS 能檢測明顯的掃描，但會漏掉更隱蔽和混淆的掃描

# 掃描驗證與排錯

## 概念

- **Scan Validations**（掃描驗證）：確保滲透測試準確性和有效性的重要環節
   - 包含兩大關鍵部分：掃描完整性(Scan Completeness)和掃描配置故障排除(Troubleshooting Scan Configurations)

## 掃描完整性

- **Scan Completeness**（掃描完整性）：指掃描過程能夠徹底識別出目標系統中所有潛在漏洞的程度
   - 確保系統的所有部分都被檢查，不遺漏任何可能的漏洞
   - 需要使用多種掃描工具及技術來覆蓋系統的不同層面，包括網路掃描、應用程式掃描和資料庫掃描
   - 應同時執行驗證型掃描(Authenticated Scan)和非驗證型掃描(Unauthenticated Scan)，以獲得更全面的安全評估

- **Authenticated Scan**（驗證型掃描）：使用有效憑證進行的掃描
   - 可以發現非驗證型掃描無法檢測的漏洞，例如內部環境的配置問題或缺失補丁

- **Unauthenticated Scan**（非驗證型掃描）：無需憑證的外部掃描
   - 模擬外部攻擊者的視角

- **Exclusion Status**（排除狀態）：某些資產或IP被暫時排除在掃描範圍外的狀態
   - 應定期檢視這些被排除的設備，確保其狀態未變更，以免造成不必要的安全漏洞

## 掃描設定故障排除

- **Troubleshooting Scan Configurations**（掃描配置故障排除）：確保掃描工具設定正確以提供準確且有意義的結果
   - 不正確的設定可能導致掃描不完整或產生錯誤結果，誤導安全評估

- **Common Configuration Issues**（常見配置問題）：
   - 不正確的IP範圍設定
   - 不適當的掃描政策
   - 阻礙掃描器訪問目標環境的網路問題

- **Scan Policies**（掃描政策）：根據不同環境需要進行適當配置
   - 生產環境在工作時間可能需要較低強度的掃描
   - 可能需要在非高峰時段安排掃描

## 掃描工具實例

- **Nikto**：專用於網頁應用程式漏洞掃描的工具
   - 適合用於檢測網站伺服器的安全問題

- **Nessus**：用於掃描網路漏洞的綜合性工具
   - 可執行驗證型和非驗證型掃描
   - 掃描結果中遺漏關鍵系統時，應檢查網路連接、掃描憑證和掃描政策設定

- **Nmap**：網路探索和安全審核工具
   - 當某些主機未被掃描到時，需檢查IP範圍設定，確保包含所有子網路
   - 防火牆規則或網路分段可能會阻擋掃描流量，需確認掃描能如預期穿越網路

## 掃描驗證的價值

- 提供目標環境的全面安全狀態視圖
- 降低遺漏重要漏洞的風險
- 增強滲透測試的可靠性與有效性
- 確保評估結果全面且可操作

# 滲透測試能力選擇

- **Capability Selection**（能力選擇）：滲透測試中選擇最有效工具和漏洞利用方法的關鍵部分
  - 包含工具選擇、漏洞利用選擇和自訂，以及公開漏洞利用選擇

## 工具選擇

- **Tool Selection**（工具選擇）：為滲透測試選擇合適工具，以有效率地發現漏洞
  - 不同工具適用於不同任務，選擇取決於測試需求

- **網路掃描工具**：
  - **Nmap**：強大的網路掃描工具
  - **Nessus**：完整的漏洞掃描工具

- **Web應用測試工具**：
  - **Burp Suite**：專門針對Web漏洞的精密測試工具
  - **OWASP ZAP**：開源Web應用安全掃描器

- **選擇考量因素**：
  - 測試類型（網路、Web或無線）
  - 環境類型（內部vs外部）
  - 目標漏洞類型
  - 工具的最新版本及其功能限制
  - 工具的學習曲線

- **Metasploit**：功能強大的漏洞利用開發和執行框架，需要對其模組有深入了解

## 漏洞利用選擇與自訂

- **Exploit Selection and Customization**（漏洞利用選擇與自訂）：選擇並自訂漏洞利用程式以測試已發現的漏洞
  - 包含分析漏洞利用代碼，確保適用於特定目標環境

- **Code Analysis**（代碼分析）：理解漏洞利用運作方式，進行必要調整以：
  - 繞過安全措施
  - 針對特定軟體版本進行調整

- **自訂案例**：
  - 針對發現的緩衝區溢位漏洞，可能需要自訂有效載荷（payload）
  - 修改腳本程式碼（shellcode）或調整漏洞利用參數

## 公開漏洞利用選擇

- **Public Exploit Selection**（公開漏洞利用選擇）：使用公開發布的漏洞利用程式，可在各種資料庫中找到
  - **資源來源**：Exploit-DB、GitHub等
  - 節省時間和開發新漏洞利用的精力

- **使用注意事項**：
  - 在受控環境中驗證和測試
  - 確保與已識別的漏洞相關
  - 確認與目標系統配置兼容
  - 了解潛在影響

- **VAPT**（**Vulnerability Assessment and Penetration Testing**，漏洞評估和滲透測試）：
  - 識別系統漏洞並進行利用，以評估組織的安全狀況

## 實際應用案例

- **企業網路滲透測試流程**：
  1. 工具選擇：Nmap（初始網路探索）、Nessus（詳細漏洞掃描）、Burp Suite（Web應用測試）
  2. 發現漏洞：如過時的Apache Tomcat版本存在遠程代碼執行漏洞
  3. 尋找漏洞利用：在Exploit-DB中尋找相應公開漏洞利用
  4. 代碼分析：了解漏洞利用原理
  5. 自訂：修改有效載荷以繞過入侵檢測系統
  6. 驗證：在受控環境中測試修改後的漏洞利用
  7. 部署：在實際滲透測試中使用

- **其他專業工具**：
  - **BeEF**（**Browser Exploitation Framework**）：專注於Web瀏覽器漏洞的滲透測試工具
  - **OpenVAS**：開源漏洞掃描工具
  - **Acunetix**：精確的漏洞掃描工具

# 滲透測試文件製作

## 文件製作的核心組成

- **Attack Path Documentation**（攻擊路徑文件）：詳細記錄滲透測試過程中的攻擊步驟
  - 包含從初始偵察到最終利用的每個行動
  - 文件需詳盡到足以讓其他測試人員能夠重現步驟
  - 對參與漏洞獎勵計劃尤為重要，因為報酬取決於公司能否複製漏洞

- **Low-level Diagram**（低階圖表）：攻擊技術細節的視覺化呈現
  - 展示網路佈局、被利用的漏洞和行動流程
  - 幫助利害關係人無需解讀大量技術文字即可理解攻擊
  - 可使用 Microsoft Visio、Draw.io 等工具製作

- **Storyboard**（故事板）：攻擊過程的高階視覺化呈現
  - 結合螢幕截圖、圖表和簡短描述來說明攻擊序列
  - 特別適合向非技術人員展示漏洞的影響
  - 類似漫畫形式，易於理解

## 攻擊路徑文件製作

- **Penetration Test**（滲透測試）：評估系統安全性的過程
  - 需詳細記錄每個步驟、使用的命令和結果
  - 例如：使用 Nmap 執行網路偵察，找到執行過時 SMB 版本的開放端口

- **Network Reconnaissance**（網路偵察）：識別網路中的活躍主機和服務
  - 常用工具如 Nmap、Burp Suite 等
  - 記錄發現的 IP 地址、開放端口和運行服務

- **Vulnerability Exploitation**（漏洞利用）：利用發現的弱點進入系統
  - 記錄每個利用的方法，如 SQL 注入、EternalBlue 等
  - 需包含使用的確切有效負載（payload）和命令

- **Privilege Escalation**（權限提升）：獲取系統中更高權限
  - 記錄如何從一般用戶升級到管理員權限
  - 包含使用的特定技術和工具

- **Lateral Movement**（橫向移動）：從已入侵系統移動到網路中的其他系統
  - 詳述如何在不同設備間移動
  - 記錄使用的特定憑證或漏洞

## 實際應用範例：電子商務平台滲透測試

- **SQL Injection**（SQL 注入）：利用輸入驗證不足注入惡意代碼
  - 在此例中使用了 `' OR '1'='1` 成功繞過認證
  - 進階有效負載如 `'union select username, password from users--` 用於提取資料庫資訊

- **Authentication Bypass**（認證繞過）：未經授權獲取系統存取權
  - 透過 SQL 注入成功登入管理員帳戶
  - 獲取管理面板存取權並繪製內部網路佈局

- **Data Extraction**（資料提取）：從資料庫中獲取敏感資訊
  - 獲取使用者名稱和雜湊密碼列表
  - 識別資料庫類型（MySQL 5.7）

## 文件呈現的良好實務

- **Screenshots**（螢幕截圖）：每個重要攻擊步驟都應有截圖
  - 包括初始掃描結果、利用嘗試和成功存取點
  - 結合簡短說明解釋每個螢幕截圖的重要性

- **Network Layout**（網路佈局）：在圖表中清楚標示網路組件
  - 標明重要 IP 地址（如 192.168.1.10、192.168.1.20）
  - 顯示攻擊流程和數據流向

- **Comprehensive Documentation**（全面文檔）：文件應該清晰、全面且易於理解
  - 對技術和非技術利害關係人都應可理解
  - 不僅展示滲透測試的有效性，也提供改進安全性的寶貴見解

# 滲透測試其他考量

## 核心考量事項

- **Dependencies**（依賴性）：系統中相互連接的組件，會影響滲透測試的成功
  - 包括軟體庫、服務和目標系統依賴的其他系統
  - 識別和理解這些依賴性可避免意外問題並確保全面評估
  - 範例：測試網頁應用程式時需考慮底層資料庫、第三方API和外部認證服務
  - 記錄依賴性並了解它們與目標的互動有助於設計更有效的攻擊策略

- **Scope Limitations**（範圍限制）：定義測試過程中可以和不可以測試的邊界
  - 通常與客戶合作設定，確保測試在約定參數內進行
  - 理解並尊重這些限制對維持專業性和避免法律或道德問題至關重要
  - 可能包括：禁止測試的特定系統、時間限制、特定攻擊類型的限制
  - 範例：客戶可能禁止對關鍵基礎設施進行拒絕服務攻擊
  - 需要與客戶持續溝通以釐清任何模糊之處並獲得必要的批准

- **Labeling Sensitive Systems**（標記敏感系統）：識別包含或處理重要資訊的系統
  - 需要在滲透測試期間特別處理
  - 標記這些系統有助於確保它們被識別、記錄和保護
  - 與客戶合作確定哪些系統被視為敏感，例如：
    - 包含個人識別資訊（PII）的系統
    - 財務記錄系統
    - 智慧財產權系統
  - 一旦識別，這些系統應在文件中明確標記，並格外謹慎以避免造成意外損害或資料遺失

## 實際應用案例

- **醫療保健提供者滲透測試**：
  - **依賴性識別**：外部電子健康記錄系統、第三方計費系統
  - **範圍限制**：客戶設定的限制，如禁止直接測試關鍵系統、禁止任何形式的拒絕服務攻擊
  - **敏感系統標記**：
    - 包含病患記錄的資料庫伺服器
    - 用於病患溝通的內部電子郵件伺服器
  - 這些系統在文件中清楚標記，確保任何測試都使用非破壞性方法
  - 通常敏感系統會被排除在測試範圍外，可使用假資料複製系統來模擬保護

## 滲透測試與弱點評估的區別

- Vulnerability Assessment（弱點評估）：系統掃描以發現潛在的常見安全問題
  - 是完整滲透測試計劃的一部分
  - 發現潛在問題，但不會演示實際攻擊情境

- Penetration Testing（滲透測試）：對電腦系統、網路或網頁應用程式的模擬網路攻擊，評估應用程式安全性
  - 目的是識別攻擊者可能利用的弱點並評估系統整體安全態勢
  - 步驟包括：
    - 計劃和偵察：定義範圍和目標，收集情報以了解系統運作和潛在弱點
    - 掃描：檢查系統或應用程式代碼，確定其對不同入侵中斷的反應
    - 攻擊和滲透
    - 後期利用
    - 報告和文檔
    - 修復測試

## 滲透測試RFP（請求建議書）關鍵要素

- RFP關鍵組成部分：
  - **專案概述**：要測試什麼以及為什麼
  - **工作範圍**：測試範圍內的系統/應用（以及哪些不在範圍內）