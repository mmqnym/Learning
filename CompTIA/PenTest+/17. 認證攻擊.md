# 認證攻擊

## 基本概念

- **Authentication Attacks（認證攻擊）**：針對驗證使用者身份的機制進行攻擊，以獲取未授權的系統和資料存取權限。
  - 主要利用密碼管理、認證協議和身份驗證方法中的弱點

## 密碼攻擊類型

- **Brute Force Attack（暴力破解攻擊）**：嘗試所有可能的密碼組合直到找到正確密碼。
  - 針對單一帳戶進行大量嘗試，容易觸發帳戶鎖定機制
  - 常用於破解密碼雜湊值

- **Dictionary Attack（字典攻擊）**：使用預定義的常見密碼清單進行嘗試。
  - 比暴力破解效率高，因為只測試可能性高的密碼

- **Keylogging（鍵盤記錄）**：記錄用戶的按鍵輸入以捕獲密碼。
  - 屬於被動攻擊方式，用戶難以察覺

- **Password Spraying（密碼噴灑攻擊）**：嘗試使用少數常見密碼來訪問大量帳戶。
  - 與暴力破解相反，針對多個帳戶使用少量密碼
  - 可規避帳戶鎖定機制，更加隱蔽
  - 一個成功的突破可能導致更廣泛的網路存取權限

- **Password Masking Attack（密碼遮罩攻擊）**：操控密碼輸入欄位，誘使用戶揭露密碼。

- **Credential Stuffing（憑證填充攻擊）**：使用從資料外洩事件獲取的憑證自動注入到其他網站。
  - 利用用戶在不同網站使用相同密碼的傾向
  - 使用從資料外洩中獲取的憑證嘗試登入其他服務

## 進階認證攻擊

- **Credential Passing Attacks（憑證傳遞攻擊）**：
  - **Pass the Hash（傳遞雜湊值攻擊）**：利用捕獲的雜湊值而非明文密碼進行身份驗證
  - **Pass the Ticket（傳遞票證攻擊）**：利用捕獲的 Kerberos 票證進行身份驗證

- **Multi-factor Authentication Fatigue（多因素認證疲勞攻擊）**：
  - 透過持續發送大量認證請求使用戶疲於應對
  - 期望用戶最終會錯誤地批准攻擊者的存取請求

- **Directory Service Attacks（目錄服務攻擊）**：
  - **Kerberoasting**：利用配置了服務主體名稱(SPN)的使用者物件，從網域控制器請求票證授予服務(TGS)票證，然後嘗試破解該票證以取得明文密碼
  - **Golden Ticket Attack（黃金票證攻擊）**：攻擊者利用 Kerberos 認證協議中的弱點，透過存取 Microsoft Active Directory 中的用戶資料，以獲取幾乎無限制的網域存取權限

- **SAML Attacks（SAML 攻擊）**：針對安全聲明標記語言(Security Assertion Markup Language)實作的漏洞利用，攻擊單一登入流程。

- **OpenID Connect Attacks（OpenID Connect 攻擊）**：利用 OIDC 實作中的弱點冒充用戶或竊取敏感資訊。

- **Hash Attacks（雜湊攻擊）**：針對實作不良的雜湊函數進行攻擊。
  - 包括利用雜湊碰撞技術來破解密碼儲存

## 常用工具

- **John the Ripper**：強大的密碼破解工具，能快速破解弱密碼。

- **Hashcat**：利用 GPU 加速的密碼破解工具，效能極高。

- **CrackMapExec (CME)**：用於自動評估網路系統安全狀態的工具。
  - 常用於利用 SMB 漏洞和列舉用戶

# 密碼攻擊類型

- **Brute-force Attack**（暴力破解攻擊）：嘗試所有可能的字符組合，直到找到正確的密碼
  - 類似於嘗試鎖的每個鑰匙組合，直到開鎖
  - 可使用的工具包括 Hydra 和 John the Ripper
  - 示例命令：`hydra -l jkelly -x 4:8:abcdefghijklmnopqrstuvwxyz1234567890 ssh://192.168.1.100`
  - 其中 -x 選項指定密碼長度範圍和字符集

- **Dictionary Attack**（字典攻擊）：使用預定義的常用詞彙列表猜測密碼
  - 比暴力破解更快，因為依賴於人們常用的密碼和詞組
  - 可使用 John the Ripper 等工具進行
  - 示例命令：`john --wordlist=[字典檔案路徑] --rules=[規則選項] --format=[格式選項] [目標檔案]`
  - 對弱密碼策略的系統特別有效

- **Hybrid Attack**（混合攻擊）：結合暴力破解和字典攻擊的策略
  - 從字典攻擊開始，然後加入變化，如在每個詞後添加數字或符號
  - 利用了許多人以可預測方式修改簡單密碼的習慣
  - 示例命令：`john --wordlist=[字典檔案路徑] --rules=[規則選項] --format=md5 [目標檔案]`
  - 規則選項允許嘗試字典中每個詞的變體
  - 混合攻擊將字典與暴力破解組合，在字典的每個詞前或後附加暴力破解的結果

- **Rainbow Table Attack**（彩虹表攻擊）：一種預計算的攻擊方式
  - 使用已經雜湊過的密碼表及其對應的明文密碼來快速破解密碼雜湊
  - 高效但需要大量儲存空間存放表格
  - 可使用 Hashcat 工具進行
  - 示例命令：`hashcat -m 0 -a 3 -o [輸出檔案路徑] [其他選項和檔案路徑]`
  - 對於未使用加鹽（salt）計算的雜湊密碼特別有效

- **Rule-based Attack**（規則基礎攻擊）：在字典攻擊基礎上應用特定變形規則
  - 可以改變字母大小寫、添加數字或特殊字符等
  - John the Ripper 和 Hashcat 都支持規則基礎攻擊
  - 示例：將 "tryhackme" 變形為 "Tryh@ckm3"
  - John the Ripper 使用 `--rules` 選項指定要使用的規則

- **常用密碼破解工具**：
  - **Hydra**：適用於在線服務如 SSH、FTP 等的密碼破解
  - **John the Ripper**：適用於多種密碼雜湊格式的破解
  - **Hashcat**：強大的密碼破解工具，支持多種攻擊模式和雜湊類型

# 密碼破解工具

## 密碼破解基本工具

- **密碼破解工具**：四種常用工具：Hashcat、John the Ripper、Hydra、Medusa
  - 這些工具可用於破解雜湊值或進行服務登入暴力攻擊

## 字典檔

- **Wordlist（字典檔）**：用於密碼破解的常見密碼列表
  - 常用字典檔如rockyou.txt，位於`/usr/share/wordlists/rockyou.txt`
  - 包含許多常見密碼如123456、password、iloveyou等

## 雜湊值破解

- **MD5 Hash**：一種常見的雜湊算法
  - 可使用echo和md5sum來產生：`echo 'ABC123' | md5sum | awk '{print $1}' > hash.txt`

### Hashcat

- **Hashcat**：功能強大的密碼破解工具
  - 基本語法：`hashcat -m 0 -a 0 hash.txt /usr/share/wordlists/rockyou.txt`
  - `-m 0`：指定雜湊類型，0代表MD5
  - `-a 0`：指定攻擊模式，0代表字典攻擊

### John the Ripper

- **John the Ripper**：靈活的密碼破解工具
  - 基本語法：`john --format=raw-md5 --wordlist=/usr/share/wordlists/rockyou.txt hash.txt`
  - `--format`：指定雜湊算法類型
  - `--wordlist`：指定字典檔路徑
  - 雖然可自動檢測雜湊類型，但建議明確指定以提高準確性

## 服務暴力破解

### Hydra

- **Hydra**：網路服務密碼暴力破解工具
  - 基本語法：`hydra -l ftpuser -P /usr/share/wordlists/rockyou.txt ftp://127.0.0.1`
  - `-l`：指定單一使用者名稱
  - `-L`：使用包含多個使用者的檔案
  - `-P`：指定密碼字典檔
  - 還可指定不同的服務類型（如FTP、SSH等）
  - 輸出格式清晰，成功破解時有明確標示

### Medusa

- **Medusa**：多執行緒網路服務暴力破解工具
  - 基本語法：`medusa -h 127.0.0.1 -u ftpuser -P /usr/share/wordlists/rockyou.txt -M ftp`
  - `-h`：指定目標主機IP或網域名稱
  - `-u`：指定單一使用者名稱
  - `-U`：使用包含多個使用者名稱的檔案
  - `-P`：指定密碼字典檔
  - `-M`：指定服務模組（如ftp、ssh等）
  - 也支援多種額外選項，如測試空密碼(`-e n`)、用戶名作為密碼(`-e s`)等
  - 允許調整執行緒數量和自定義攻擊設置

## 安全建議

- 這些工具應在合法、授權的環境中使用
- 了解這些工具的工作原理有助於加強系統安全性
- 複雜密碼和多因素認證可有效防護暴力破解攻擊

# 密碼與身分驗證攻擊方法

## 主要攻擊類型

- **Password Spraying**（密碼噴灑攻擊）：嘗試使用少量常見密碼來攻擊大量帳戶，而非對單一帳戶嘗試大量不同密碼。
  - 避免了傳統暴力破解攻擊可能觸發的帳戶鎖定機制
  - 常用工具：CrackMapExec
  - 命令範例：`crackmapexec smb 192.168.1.0/24 -u users.txt -p 'Summer2004!'`

- **Password Masking Attacks**（密碼遮罩攻擊）：基於特定規則或模式創建可能的密碼組合。
  - 利用了組織的密碼政策（如要求大寫字母、數字和特殊字元）
  - 常用工具：Hashcat
  - 命令範例：`hashcat -a 3 -m 0 hashfile.txt ?u?l?l?l?l?d?d?s`
  - 參數說明：?u=大寫字母、?l=小寫字母、?d=數字、?s=特殊字元

- **Credential Stuffing**（憑證填充攻擊）：利用從之前洩漏的資料庫中獲取的用戶名和密碼組合，嘗試登入其他網站或服務。
  - 利用使用者在多個網站重複使用相同密碼的習慣
  - 常用工具：Hydra
  - 命令範例：`hydra -L usernames.txt -P passwords.txt http-post-form "/login:username=^USER^&password=^PASS^:F=incorrect" -v example.com`

- **MFA Fatigue**（多因素驗證疲勞攻擊）：透過連續發送大量身份驗證請求，使用戶因疲勞而批准惡意請求。
  - 攻擊者將被盜用戶名/密碼組合與社交工程技術結合使用
  - 攻擊流程：
    1. 初始存取：使用收集的資訊（如盜取的密碼）嘗試登入
    2. 重複發送MFA請求：反覆發起登入嘗試，每次都產生新的MFA請求
    3. 使用者疲勞：用戶因不斷收到提示而感到煩躁，最終可能批准惡意請求

## 攻擊風險與防護措施

- **MFA Fatigue的危險性**：
  - 用戶可能因疲勞而忽略安全驗證步驟
  - 可能導致誤批惡意請求：
    - 假批准（False Approval）：用戶在MFA請求轟炸下可能意外批准駭客的驗證請求
    - 信任侵蝕（Trust Erosion）：過多MFA提示可能導致用戶對系統信任度下降
    - 釣魚機會（Phishing Opportunity）：攻擊者可將釣魚訊息偽裝成MFA提示

- **防範措施**：
  - 密碼攻擊防護：
    - 實施強密碼政策
    - 使用密碼管理工具創建並儲存強密碼
    - 監控異常登入嘗試
  
  - MFA疲勞防護：
    - 實施用戶友善的MFA解決方案，減少不必要的提示
    - 教育用戶驗證每個認證請求的重要性
    - 監控異常的認證模式
    - 考慮使用數字匹配或地理位置驗證等更安全的MFA方法

## 檢測方法

- 監控系統日誌中的重複驗證請求
- 分析一認證事件，例如：
  ```
  "authenticationRequirement": "multiFactorAuthentication",
  "additionalDetails": "The user didn't complete the MFA prompt."
  "authenticationStepDateTime": "2023-12-05T15:11:22Z"
  ```
- 實施行為分析系統，識別異常的認證模式

# Credential Passing Attacks（憑證傳遞攻擊）

## 主要類型

- **Pass-the-Hash Attack**（傳遞雜湊攻擊）：使用密碼雜湊值進行身分驗證
  - 攻擊者可使用用戶密碼的雜湊值代替明文密碼進行身分驗證
  - Windows 系統將密碼雜湊存儲在記憶體中，攻擊者可提取並利用
  - 常用工具：Mimikatz（提取雜湊）、CrackMapExec（使用雜湊進行認證）
  - 範例命令：
    - `mimikatz # sekurlsa::logonpasswords`（提取記憶體中的登入憑證）
    - `crackmapexec smb [IP] -u [用戶名] -H [雜湊] -x "command.exe"`（利用雜湊訪問遠端系統）

- **Pass-the-Ticket Attack**（傳遞票證攻擊）：使用竊取的 Kerberos 票證進行身分驗證
  - 利用竊取的 Kerberos 票證訪問網路服務
  - Kerberos 票證用於 Windows 環境中的身分驗證，避免重複傳送密碼
  - 常用工具：Mimikatz（提取票證）、Impacket's psexec（利用票證進行認證）
  - 範例命令：
    - `mimikatz # kerberos::list /export`（匯出機器上的 Kerberos 票證）
    - `psexec.py -k -no-pass DOMAIN/user@192.168.1.100`（使用票證進行認證）
  - 防護措施：
    - 確保票證定期過期
    - 使用強健的身分驗證機制
    - 監控異常的身分驗證模式
    - 在遭到入侵時輪換 KDC（Key Distribution Center）密碼

- **Pass-the-Token Attack**（傳遞令牌攻擊）：使用竊取的身分驗證令牌進行訪問
  - 使用竊取的身分驗證令牌獲取未授權訪問
  - 常見於網路應用程式和 API 的身分驗證
  - 攻擊者可通過截取網路流量或入侵會話來獲取令牌
  - 範例：攻擊者截取 JWT（JSON Web Token）並在 HTTP 授權標頭中重用
  - 防護措施：
    - 使用安全通訊通道（如 HTTPS）
    - 實施令牌過期和撤銷機制
    - 監控異常的令牌使用情況

## 關鍵技術資訊

- **Kerberos**（克貝洛斯協議）：Windows 網域中的預設身分驗證協議
  - 使用票證系統讓使用者在登入後能透明地進行身分驗證
  - 包含 TGT（Ticket-Granting Ticket，票證授予票證）和服務票證
  - KDC（Key Distribution Center，密鑰分發中心）位於網域控制器上，負責發行票證

- **Mimikatz**：強大的憑證提取工具
  - 可從 Windows 系統中提取密碼、雜湊和 Kerberos 票證
  - 在滲透測試中廣泛使用，但也被攻擊者利用

- **JWT**（JSON Web Token）：網路應用和 API 中常用的身分驗證機制
  - 可被攻擊者截取並重用，尤其是未設定適當過期時間時

## 重要比較

- **Pass-the-Hash** vs **Pass-the-Ticket**：
  - Pass-the-Hash 使用密碼雜湊進行認證
  - Pass-the-Ticket 使用 Kerberos 票證進行認證，不需要密碼雜湊

# CrackMapExec (CME) 

- **CrackMapExec（CME）**：一種常用於滲透測試的工具，專門用於執行身份驗證攻擊，特別是在 Windows 環境中
  - 因其多功能性和自動化各種攻擊類型的能力而受到滲透測試人員的青睞
  - 現已不再積極維護，逐漸被 NetExec 取代

- **CME 常用攻擊類型**：
  - **Pass-the-Hash**：利用獲取的密碼雜湊值進行身份驗證的技術
  - **Pass-the-Ticket**：使用已獲取的 Kerberos 票據進行身份驗證
  - **Credential Stuffing**：使用已知憑證嘗試登入多個系統

- **攻擊目標**：
  - 主要針對使用 **SMB（Server Message Block Protocol）**的系統
  - Windows 網路環境中的常見目標

- **CME 功能**：
  - 在整個網路中驗證憑證
  - 檢查常見漏洞的存在
  - 執行任意命令
  - 將多種功能整合在單一工具中

- **整合性**：
  - 可與 **Mimikatz** 集成，直接從內存中轉儲憑證
  - 可與 **PowerShell Empire** 整合，遠程執行腳本
  - 適合在滲透測試中進行橫向移動（Lateral Movement）

- **使用案例**：
  - 將一組憑證對主機列表進行測試，檢查哪些地方可以獲得未授權訪問
  - 快速確認憑證有效的位置，幫助繪製網路中潛在的攻擊路徑

- **限制與注意事項**：
  - 不再積極維護，功能可用但不會更新以應對新的安全特性或修復可能出現的錯誤
  - 對於較新的 Windows 安全機制可能測試不足
  - 隨著安全技術的發展，其有效性可能會逐漸降低

- **替代工具**：
  - **Rubeus**：可實現類似功能的替代工具
  - **NetExec**：CrackMapExec 的繼任者，更新維護中

- **使用建議**：
  - 雖然 CME 仍然有用，但應同時熟悉其他替代工具
  - 用更新的工具補充 CME 的功能
  - 密切關注依賴工具的最新發展

# SAML 安全威脅與防禦

## SAML 基本概念

- **SAML（Security Assertion Markup Language）**（安全宣告標記語言）：一種開放標準，用於在身分提供者（Identity Provider，IdP）和服務提供者（Service Provider，SP）之間交換身分驗證和授權資料。
  - 廣泛用於單一登入（SSO）系統，讓使用者只需認證一次即可存取多個應用程式。

- **SAML 運作流程**：
  - 使用者嘗試登入服務提供者（SP）
  - SP 向身分提供者（IdP）發送請求
  - IdP 檢查使用者是否已登入，若未登入則要求提供憑證
  - 成功登入後，IdP 建立宣告（assertion）確認使用者身分
  - 宣告被傳回 SP
  - SP 讀取宣告並允許使用者存取，無需再次登入

## SAML 安全威脅

### SAML 令牌操縱攻擊

- **SAML Token Manipulation**（SAML 令牌操縱攻擊）：攻擊者修改 SAML 令牌以獲取未授權存取。
  - SAML 令牌是基於 XML 的，包含關於使用者身分和權限的宣告
  - 若令牌簽名不正確或簽名驗證較弱，攻擊者可以修改內容提升權限或冒充其他使用者

- **攻擊示例**：
  - 使用 SAML Raider（Burp Suite 擴充功能）攔截並修改令牌
  - 將使用者角色從普通用戶改為管理員
  - 若服務提供者未正確驗證簽名，攻擊者可使用自己的金鑰重新簽署令牌

- **防禦措施**：
  - 使用身分提供者的公鑰驗證 SAML 令牌的簽名
  - 確保 SAML 訊息的完整性和機密性
  - 強制執行嚴格的 XML 驗證

### SAML 重放攻擊

- **SAML Replay Attack**（SAML 重放攻擊）：攻擊者攔截有效令牌並重複使用以獲取未授權存取。
  - 當服務提供者未檢查令牌重複使用或未設定令牌過期時間時容易發生

- **攻擊示例**：
  - 使用 Wireshark 等工具攔截有效的 SAML 令牌
  - 使用攔截的令牌向服務提供者重複發送請求
  - 無需使用者憑證即可獲得未授權存取

- **防禦措施**：
  - 為每個 SAML 令牌使用唯一標識符，以檢測並拒絕重放的令牌
  - 確保令牌具有較短的有效期
  - 實作 `NotBefore` 和 `NotOnOrAfter` 屬性來定義令牌的有效時間窗口

### SAML 注入攻擊

- **SAML Injection**（SAML 注入攻擊）：攻擊者利用處理 SAML 令牌的應用程式中的漏洞。
  - 通過注入惡意 SAML 資料，攻擊者可以操縱認證過程獲取未授權存取

- **攻擊示例**：
  - 攻擊者利用應用程式程式碼中未經適當驗證的用戶輸入
  - 注入惡意 XML 內容修改認證邏輯

- **防禦措施**：
  - 驗證並淨化用戶輸入
  - 使用參數化查詢
  - 強制執行嚴格的 XML 結構描述驗證

## 其他 SAML 安全檢查項目

- 檢查是否驗證接收者（防止令牌接收者混淆攻擊）
- 檢查是否易受跨站請求偽造攻擊（未經請求的回應）
- 檢查 SAML 回應是否可能受 XML 外部實體（XXE）攻擊影響
- 檢查時間窗口是否被驗證（嘗試在過期後使用相同的 SAML 回應）

## 總結

- **SAML 令牌操縱攻擊**：修改 SAML 令牌以提升權限
- **SAML 重放攻擊**：使用攔截的令牌獲取未授權存取
- **SAML 注入攻擊**：利用 SAML 處理中的漏洞

# OpenID Connect (OIDC) 攻擊

## 基礎概念

- **OpenID Connect（OIDC）**：建立在 OAuth 2.0 協議之上的身份層，允許客戶端基於授權伺服器執行的身份驗證來驗證終端使用者的身份。
  - 常用於單一登入（Single Sign-On）場景，使用者只需登入一次即可訪問多個應用程式。

- **OIDC 運作流程**：
  - 使用者嘗試登入應用程式（稱為 Relying Party，RP）
  - RP 向 OpenID Provider（OP）發送驗證請求
  - OP 對使用者進行身份驗證並返回 ID Token
  - RP 驗證 ID Token 並授予使用者訪問權限

- **ID Token**：一種 JSON Web Token（JWT），包含用戶身份信息
  - 結構包含：標頭（header）、資料負載（payload）和簽名（signature）
  - 資料負載中包含聲明（claims）

## 常見攻擊方式

### ID Token 操縱攻擊

- **ID Token 操縱攻擊**：攻擊者修改 ID Token 以獲取未授權的訪問權限。
  - 當 Token 簽名驗證薄弱或實現不當時，攻擊者可以更改 Token 的負載以提升權限或冒充其他用戶。
  - 攻擊者可以攔截、解碼、修改後重新編碼 Token（例如使用 Burp Suite）。

- **防禦措施**：
  - 始終使用 OP 的公鑰驗證 Token 簽名
  - 確保 Token 的完整性和機密性
  - 對 Token 聲明實施嚴格的驗證規則

### ID Token 重放攻擊

- **ID Token 重放攻擊**：攻擊者攔截有效的 ID Token 並重複使用以獲取未授權的訪問權限。
  - 當 RP 未正確檢查 Token 重用或未設置 Token 過期時間時可能發生。
  - 攻擊者可以使用 Wireshark 等工具在有效登入會話中捕獲 ID Token。

- **防禦措施**：
  - 實施檢測和拒絕重放 Token 的機制
  - 使用每個令牌的唯一識別符（nonce）
  - 確保 Token 具有短暫的生命週期
  - 使用 Token 綁定機制

### ID Token 注入攻擊

- **ID Token 注入攻擊**：攻擊者利用處理 ID Token 的應用程式中的漏洞，注入惡意 Token 來操縱身份驗證過程。
  - 例如，攻擊者可能利用應用程式未正確處理 Token 請求中的用戶輸入。

- **防禦措施**：
  - 驗證和淨化用戶輸入
  - 使用參數化查詢
  - 對 JWT Token 實施嚴格的驗證

### WebFinger 服務濫用

- **WebFinger 服務**：幫助找到用戶的 OpenID 提供者，位於 .well-known/webfinger 端點。
  - 攻擊者可以濫用此端點檢查特定用戶是否在伺服器上有帳戶，可能導致信息洩露。

### 透過動態客戶端註冊的伺服器端請求偽造（SSRF）

- **動態客戶端註冊**：允許應用程式動態註冊到 OpenID 提供者。
  - 攻擊者可以通過修改註冊請求中的特定參數，誘使 OpenID 提供者向其指定的伺服器發送 HTTP 請求。
  - 這可能導致提供者獲取惡意數據並暴露敏感信息。
  - 建議對 `request_uri` 參數進行限制，防止訪問本地主機或私有 IP

### 受眾注入攻擊

- **受眾注入攻擊（Audience Injection Attacks）**：影響 OAuth 2.0、OpenID Connect 等協議的新型漏洞類別。
  - 利用簽名型客戶端認證機制中受眾（audience）處理的關鍵弱點。
  - 允許攻擊者冒充用戶並獲取未授權的資源訪問權限。
  - 已收錄 NVD CVE-2025-27370（OpenID Connect）和 CVE-2025-27371（IETF OAuth2）

# 雜湊攻擊與密碼安全

## 雜湊攻擊類型

- **Collision Attack**（碰撞攻擊）：指兩個不同的輸入產生相同的雜湊值
  - 這會威脅資料完整性，因為攻擊者可以在不被察覺的情況下替換資料

- **Birthday Attack**（生日攻擊）：基於生日悖論的碰撞攻擊
  - 基於機率理論，在23人的群體中，有超過50%的機率兩人會有相同的生日
  - 對於雜湊函數來說，找到兩個產生相同雜湊值的不同輸入比想像中更容易
  - 如果攻擊者找到兩個產生相同雜湊值的不同密碼，他們可以使用任一密碼登入系統

## 密碼儲存與認證

- **Hash Function**（雜湊函數）：將輸入（如密碼）轉換為固定長度的字元串，看似隨機
  - 儲存雜湊值而非明文密碼
  - 使用者登入時，系統會雜湊其密碼並與儲存的雜湊值比較
  - 若匹配，認證成功

## 增強雜湊安全的技術

- **Salting**（加鹽）：在雜湊前將一個唯一的隨機值加到每個密碼
  - 即使兩個使用者使用相同的密碼，其雜湊值也會不同
  - 防止攻擊者使用預先計算的彩虹表（Rainbow Tables）快速破解雜湊值
  - 例如：原密碼是 "password123"，加鹽後變成 "randomSaltpassword123" 再進行雜湊
  - 鹽值是公開儲存在資料庫中的，每個使用者都應該有唯一的鹽值

- **Key Stretching**（金鑰延展）：多次應用雜湊函數以增加破解所需的計算資源
  - 使暴力破解和字典攻擊更加耗時和資源密集
  - 常見的金鑰延展算法：PBKDF2
  - PBKDF2 可配置迭代次數，以平衡安全性和性能

## 密碼安全最佳實踐

- 避免明文儲存密碼
- 使用雜湊結合加鹽技術
- 選擇強大的現代雜湊演算法
- 應用適當的金鑰延展技術
- 了解並防範雜湊碰撞和彩虹表攻擊

- **Peppering**（加胡椒）：在密碼中加入一個秘密值，與加鹽不同的是，胡椒值是單一的且儲存在資料庫之外
  - 增強安全性，即使資料庫被入侵

- **Bcrypt**（Bcrypt 演算法）：整合了雜湊和加鹽的過程
  - 自動處理加鹽過程，使每個密碼雜湊值唯一