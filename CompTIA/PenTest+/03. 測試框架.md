# 滲透測試框架

## 概述

- **Penetration Test**（滲透測試）：一種經授權的測試方法，模擬真實攻擊者使用的工具和技術，以評估組織的安全狀況並識別漏洞
  - 滲透測試提供對組織防禦強度的重要檢查，幫助降低網路威脅風險
  - 根據測試者事前知識的多寡，可分為黑盒測試、白盒測試和灰盒測試
  - 測試結果通常記錄於報告中，提供降低或緩解風險的建議

- **Pen-test Frameworks**（滲透測試框架）：指導如何從頭到尾進行滲透測試的規則集或指導手冊
  - 提供結構化方法來識別電腦系統、網路或應用程式中的安全弱點
  - 確保測試全面性，涵蓋所有重要領域
  - 協助測試人員遵循法律和技術指南，降低滲透測試人員的風險

## 滲透測試框架與方法

- **MITRE ATT&CK**：由非營利組織 MITRE 開發的一個框架，記錄攻擊者可能威脅網路和系統的不同方式的指南
  - 有助於理解潛在威脅和規劃防禦策略

- **OWASP**（Open Web Application Security Project，開放式網頁應用程式安全專案）：是一個線上社群，在Web應用安全領域提供免費的文章、方法、文件、工具和技術。
  - 提供網頁安全的最佳實踐指南
  - 作為防範駭客入侵嘗試的重要參考

- **MASVS**（Mobile Application Security Verification Standard，行動應用程式安全驗證標準）：OWASP專為行動應用程式設計的安全標準
  - 幫助測試人員了解評估行動應用安全性時應關注的要點

- **PTES**（Penetration Testing Execution Standard，滲透測試執行標準）：概述完整的滲透測試流程
  - 涵蓋從初始資訊收集到最終結果報告的整個過程

- **CREST**（Council of Registered Ethical Security Testers，註冊道德安全測試人員委員會）：設定滲透測試高標準的認證和認可機構
  - 為符合其嚴格標準的測試人員提供認可

- **OSSTMM**（Open-Source Security Testing Methodology Manual，開源安全測試方法論手冊）：提供測試系統和網路安全的全面方法
  - 內容全面且涵蓋範圍廣泛

- **STRIDE**：用於識別電腦安全威脅的框架
  - 代表六種威脅類型：
    - Spoofing（偽裝）
    - Tampering（竄改）
    - Repudiation（否認）
    - Information disclosure（資訊揭露）
    - Denial of service（拒絕服務）
    - Elevation of Privileges（權限提升）

- **Purdue Model**（普渡模型）：關於工業控制系統的網路安全組織模型
  - 特別適用於理解如何保護控制實體設備的系統

- **OCTAVE**（Operationally Critical Threat, Asset, and Vulnerability Evaluation，操作關鍵威脅、資產和漏洞評估）：用於識別和管理組織及企業風險的框架

- **DREAD**：評估安全威脅風險的簡易方法
  - 代表五個評估要素：
    - Damage（損害）
    - Reproducibility（可重現性）
    - Exploitability（可利用性）
    - Affected users（受影響用戶）
    - Discoverability（可發現性）

## 框架選擇考量

- 每種框架都有其特定用途和應用場景
- 滲透測試人員應根據測試目標和環境選擇合適的框架
- 了解各框架的優缺點有助於在實際測試中做出最佳選擇

# MITRE ATT&CK 框架

- **MITRE ATT&CK**（MITRE 攻擊）：一個廣泛應用於網路安全領域的框架，旨在改進對威脅行為的理解並強化防禦能力
  - ATT&CK 是縮寫，代表 Adversarial Tactics, Techniques, and Common Knowledge（對抗性戰術、技術和通用知識）
  - 由 MITRE 開發，受美國電腦應急準備小組和美國國土安全部資助
  - 可在 https://attack.mitre.org 免費存取
  - 提供矩陣式目錄，記錄真實世界攻擊中觀察到的各種戰術和技術
  - 是滲透測試工作者的重要資源，有助於發展準確的威脅模型和方法論

- **ATT&CK Framework Design**（ATT&CK 框架設計）：設計用於提供對進階持續性威脅在網路攻擊不同階段行為的詳細洞察
  - 涵蓋從初始存取到資料外洩的整個攻擊流程
  - 分為多個矩陣，針對不同環境如企業、行動裝置和雲端
  - 每個矩陣專為特定環境量身定制，詳細說明 Windows、macOS、Linux、雲服務和基於網路的設備的潛在攻擊媒介

- **ATT&CK Tactics and Techniques**（ATT&CK 戰術與技術）：框架將對抗性戰術和技術進行結構化分類
  - 戰術分類包括：初始存取（Initial Access）、執行（Execution）、持久性（Persistence）、權限提升（Privilege Escalation）和防禦規避（Defense Evasion）等
  - 每個戰術類別下又細分為特定技術，描述執行方法
  - 例如，初始存取類別中包含魚叉式網路釣魚（Spear Phishing）或路過式入侵（Drive-by Compromise）等技術

- **Spear Phishing Attachment**（魚叉式釣魚附件）：一種初始存取技術，通過電子郵件附件傳遞惡意軟體
  - 與廣泛的釣魚活動不同，魚叉式釣魚高度針對性，專注於特定個人、公司或產業
  - 攻擊者精心製作適合收件人的郵件，附上執行後會啟動惡意活動的檔案
  - 附件類型多樣，包括 Microsoft Office 文件、可執行檔、PDF 和 ZIP 等壓縮檔
  - 每種檔案可以不同方式武器化，利用其格式相關的特定漏洞或直接執行惡意代碼
  
- **Framework's Value in Security**（框架在安全中的價值）：MITRE ATT&CK 框架在攻擊性和防禦性安全方面都有重要作用
  - 攻擊性價值：協助滲透測試人員模擬已知威脅，制定精心設計的攻擊策略
  - 防禦性價值：幫助安全團隊了解攻擊執行方式、識別入侵指標和與不同攻擊技術相關的行為
  - 這種知識使威脅的檢測和緩解更快速、更準確
  - 將 MITRE ATT&CK 框架整合到滲透測試中，可確保安全團隊做好攻擊和應對複雜威脅的準備

# OWASP

## OWASP 概述

- **OWASP**（Open Web Application Security Project，開放式網頁應用程式安全計畫）：一個致力於改善軟體安全的非營利基金會
  - 透過社群主導的開源軟體專案推動安全改進
  - 在全球擁有數百個本地分會和數萬名成員
  - 定期舉辦本地和全球性的安全會議
  - 使命：讓軟體安全可視化，使全球個人和組織能夠對真實軟體安全風險做出明智決策

- **OWASP Top 10**：每隔幾年更新一次，列出十大最關鍵的網頁應用程式安全風險
  - 對執行安全評估或滲透測試的人員至關重要
  - 幫助測試人員將精力集中在最可能被利用的弱點上
  - 作為評估網頁應用程式漏洞的基礎檢查清單或起點
  - 專注於這份清單上的風險，可確保測試者解決最基本和最常被利用的漏洞

## OWASP Top 10 主要風險（2021版）

- **Broken Access Control**（存取控制失效）：當對已認證使用者允許執行的操作限制未被正確實施時發生
  - 使用者可能利用這些缺陷訪問未授權的功能或數據
  - 例如：訪問其他用戶的帳戶、查看敏感檔案、修改他人數據
  - 案例：若線上銀行應用程式未正確驗證訪問帳戶的用戶身份，攻擊者可透過更改URL中的userID獲取其他用戶的帳戶資料

- **Cryptographic Failures**（加密失效）：前身為敏感數據洩露（Sensitive Data Exposure）
  - 由於對數據保密性和完整性的重大影響而上升至第二位
  - 包括與安全管理敏感數據相關的失敗
  - 例如：不當加密或錯誤實施導致數據暴露
  - 案例：應用程式使用自訂加密而非標準加密協議儲存密碼，加密算法錯誤可能使攻擊者利用彩虹表解密所有用戶密碼

- **Injection**（注入）：包括SQL、NoSQL、命令注入等
  - 當不可信數據作為命令或查詢的一部分被發送給解釋器時發生
  - 攻擊者的惡意數據可能誘使解釋器執行非預期命令或未授權訪問數據
  - 案例：網站使用動態SQL查詢獲取用戶信息，若未妥善過濾輸入，攻擊者可能輸入如「105; DROP TABLE Users;」的程式碼，導致刪除Users表

- **Insecure Design**（不安全設計）：排名第4

- **Security Misconfiguration**（安全配置錯誤）：排名第5

- **Vulnerable and Outdated Components**（易受攻擊和過時的元件）：排名第6

- **Identification and Authentication Failures**（身份識別和驗證失敗）：排名第7

- **Software and Data Integrity Failures**（軟體和數據完整性失敗）：排名第8

- **Security Logging and Monitoring Failures**（安全日誌記錄和監控失敗）：排名第9

- **Server-Side Request Forgery**（伺服器端請求偽造）：排名第10

## OWASP 的重要性

- 對網頁應用程式安全領域的從業者幾乎是必不可少的資源
- 熟悉OWASP Top 10可顯著加深對網頁應用程式漏洞的理解
- 有助於更好地準備滲透測試，並保護應用程式免受常見威脅
- 不僅對執行有效滲透測試重要，也對從一開始就開發安全應用程式至關重要

# OWASP MASVS 行動應用程式安全標準

- **MASVS**（Mobile Application Security Verification Standard，行動應用程式安全驗證標準）：由 OWASP 制定的基準安全標準，旨在保護行動應用程式的安全
  - 提供行動應用安全的結構化方法
  - 將安全需求分為不同的控制群組（MASVS-XXXXX）
  - 每個控制群組針對行動應用的主要攻擊面，用於緩解特定的安全風險
  - 是開發、測試和評估行動應用程式安全性的重要資源

## MASVS 控制群組

- **MASVS-STORAGE**（儲存）：專注於敏感資料的安全儲存
  - 保護個人資料、使用者憑證和財務資訊等敏感資訊
  - 透過良好的加密方式保護資料
  - 防止資料洩漏，確保敏感資料不被未授權存取

- **MASVS-CRYPTO**（密碼學）：聚焦保護敏感資料的密碼學措施
  - 使用強大、符合行業標準的加密方法
  - 保護傳輸中和靜止狀態的資料
  - 確保加密金鑰長度足夠
  - 金鑰管理遵循行業最佳實踐

- **MASVS-AUTH**（認證與授權）：涵蓋認證和授權流程
  - 實作強大機制來驗證使用者身分
  - 授予適當的訪問權限
  - 使用安全協議
  - 安全執行本地認證
  - 對敏感操作使用額外的身份驗證

- **MASVS-NETWORK**（網路）：處理行動應用與遠端端點間的網路通訊安全
  - 保護傳輸中的資料，防止攔截、篡改和竊聽
  - 通常使用 SSL/TLS 等協議
  - 實施憑證綁定（certificate pinning）以確保僅信任特定的 CA

- **MASVS-PLATFORM**（平台）：關注應用如何與底層行動平台和其他應用安全互動
  - 處理進程間通信（inter-process communication）
  - WebView 和使用者界面的安全
  - 避免敏感資料透過平台機制（如自動生成的螢幕截圖）無意間洩漏

- **MASVS-CODE**（程式碼）：涉及應用程式碼的安全開發與維護
  - 強調保持應用和作業系統的更新以增強安全性
  - 將所有輸入資料視為不可信任
  - 正確驗證和淨化資料，防止 SQL 注入或跨站腳本攻擊等漏洞

- **MASVS-RESILIENCE**（彈性）：指應用抵抗和應對逆向工程及篡改的能力
  - 包含檢測和緩解程式碼或行為被篡改的策略
  - 使用反靜態分析或反動態分析等技術

- **MASVS-PRIVACY**（隱私）：強調實施符合隱私法律和法規的隱私控制
  - 應用僅請求必要的數據
  - 確保用戶知情同意
  - 與第三方分享數據應基於用戶同意且必要
  -
  - 對繞過同意協議的第三方 SDK（軟體開發套件）進行嚴格控制

## OWASP 支援資源

- **Mobile Application Security Testing Guide**（行動應用安全測試指南）：
  - 提供詳細的測試框架
  - 幫助驗證 MASVS 中概述的安全控制
  - 確保符合標準

- **OWASP MAS Checklist**（OWASP 行動應用安全檢查清單）：
  - 提供實用格式評估應用中的安全功能
  - 幫助開發人員和安全測試人員檢查合規性

# 滲透測試執行標準(PTES)

- **PTES (Penetration Testing Execution Standard，滲透測試執行標準)**：一種用於進行徹底和有效滲透測試的框架
  - 與臨時方法不同，PTES提供結構化方法來測試資訊系統和網路的安全性
  - 由七個主要部分組成，指導測試人員從規劃到詳細報告的整個過程

## PTES七大階段

- **Pre-engagement Interactions（前期互動）**：滲透測試的初始階段，涉及首次溝通和確定測試理由
  - 提供成功開始測試所需的基本工具和技術
  - 在測試開始前應參考通用問題部分，以釐清細節並確保過程順暢
  - 重點關注識別業務風險
  - 內容涵蓋：時間估算標準、範圍會議、額外支援、問卷調查、一般問題、範圍蔓延、開始和結束日期、IP範圍和網域、處理第三方、可接受的社交工程藉口、DoS測試、付款條款、目標、溝通途徑、緊急聯絡資訊、交戰規則和現有技術

- **Information Gathering（資訊收集）**：為有效滲透測試奠定基礎的關鍵階段
  - 結構化逐步深入收集目標情報，分為三個級別：合規驅動、最佳實踐和國家贊助
  - 包含開源情報(OSINT)收集，提供目標實體和數位足跡的深入見解
  - 包括企業結構和技術設置
  - 足跡分析包括被動和主動技術，用於映射目標的外部和內部網路環境
  - 幫助識別潛在漏洞和安全缺口

- **Threat Modeling（威脅建模）**：系統的探索技術，以結構化的形式紀錄任何系統上的威脅相關資訊，包括以破壞、披露、修改數據或拒絕服務等攻擊手段，而造成損害的情況或事件。
  - 幫助優先考慮最關鍵的資產和需要關注的威脅向量
  - 應與被測試組織合作進行，或基於黑盒情境下發現的開源情報建立
  - 最終威脅模型將在滲透測試報告中詳細記錄
  - 將發現結果與特定威脅聯繫起來，提供量身定制的風險評估
  - 有助於加強組織對最可能威脅的防禦

- **Vulnerability Analysis（漏洞分析）**：使用主動和被動測試技術來識別組織IT基礎設施中的安全弱點
  - 主動測試涉及直接與系統交互，探測漏洞如過時軟體或配置錯誤
  - 被動測試涉及在不直接交互的情況下觀察系統，收集可能指示潛在漏洞的信息
  - 一旦識別出漏洞，驗證步驟確認其存在和可利用性，確保它們不僅是虛假警報

- **Exploitation（漏洞利用）**：主動利用已識別的漏洞階段
  - 模擬攻擊者試圖利用弱點獲取目標系統的訪問權限或提升權限
  - 展示漏洞對組織的潛在實際影響
  - 使用的技術可能包括注入代碼、操縱協議或劫持會話，以評估系統可能被入侵的程度

- **Post-exploitation（漏洞利用後活動）**：在成功利用漏洞獲得某種訪問權限後的階段
  - 探索攻擊者在系統內可能進一步實現的目標
  - 這階段的活動包括訪問敏感數據、提升權限、安裝後門以維持持久性，以及導航網路以到達關鍵系統或數據
  - 幫助了解漏洞可能造成的潛在損害和影響
  - 評估內部防禦和應對策略的有效性

- **Reporting（報告）**：PTES的最終階段，涉及編撰測試期間所有活動、利用的漏洞、訪問的系統以及對組織潛在影響的詳細報告
  - 提供對發現的安全弱點的徹底分析
  - 包含清晰、可執行的補救建議
  - 目標是指導組織加強防禦並改善整體安全框架以抵禦未來攻擊
  - 報告應對技術和非技術利益相關者均可理解，因為最終許多時候做決定的是非技術利益相關者

## PTES總結

- PTES提供了進行滲透測試的結構化框架
- 透過遵循PTES的七個關鍵階段，測試人員可以執行徹底、有效和價值導向的滲透測試
- 這種方法不僅突出目前的漏洞，還為改善組織的安全狀態提供可行的建議

# CREST 滲透測試指南

## 基本概念

- **CREST**（Council of Registered Ethical Security Testers，註冊道德安全測試人員委員會）：設立嚴格網路安全服務標準的安全公司組織
  - 全球擁有超過300名成員，包括許多領先的安全公司
  - 運作完善的認證系統，旨在評估會員提供服務的品質
  - CREST認證公司必須遵循嚴格的行為和倫理準則，並承諾採取完善的投訴和解決措施
  - 政府、公共服務和企業使用CREST認證公司的服務，可以信任他們將獲得專業和高素質的服務

- **CDPT Guidelines**（CREST Defensible Penetration Test Guidelines，CREST可防禦性滲透測試指南）：建立明確結構化的滲透測試標準
  - 確保滲透測試有效並提供高品質結果
  - 強調測試必須由專業技術人員規劃、執行和評估
  - 由CREST組織制定，用於標準化滲透測試流程
  - 確保測試全面、可防禦且由合格專業人員進行

## CDPT指南架構

CDPT指南文件分為10個章節加上額外的定義部分，每個章節都對可防禦性滲透測試的性質有所貢獻：

- **Executive Summary**（執行摘要）：描述常見術語，為業界統一理解滲透測試奠定基礎

- **Background**（背景）：討論滲透測試實踐的演變和多樣性
  - 強調全球標準的重要性，以確保一致性和品質

- **Commercially Defensible Assurance Activity**（商業可防禦保證活動）：強調滲透測試的法律和商業防禦性
  - 要求由有能力的人員進行測試，以確保其可信度和可靠性

- **How This Specification Should be Used**（如何使用本規範）：確保滲透測試實踐符合標準且有效

- **Quality Assurance of Organizations**（組織的品質保證）：討論可靠和認證的滲透測試提供商的需求

- **Benefits of the CREST Accreditation**（CREST認證的好處）：概述選擇CREST認證公司的優勢
  - CREST認證公司經過嚴格審核，提升服務的信任度和可靠性

- **Suitably Skilled and Competent Individuals**（具備適當技能和能力的個人）：強調進行滲透測試的專業人員需要具備的資格和道德標準

- **Importance of Defining Goals & Objectives**（定義目標和宗旨的重要性）：強調滲透測試需要明確的目標
  - 組織採購滲透測試服務時，是為了滿足特定需求或要求
  - 這些目標應在採購過程中明確向買方說明
  - 服務提供商應在所有範圍文件和報告中列出這些目標

- **A Question of Scope**（範圍問題）：突出適當定義滲透測試範圍的重要性
  - 正確範圍界定有助於識別相關攻擊服務，如網路或局域網等
  - 確保關注與客戶最相關的攻擊向量

- **Reporting Framework**（報告框架）：詳細說明全面測試結果報告的期望
  - 確保報告對客戶有價值且信息豐富

## CREST認證過程

- **認證審核**：成為CREST認證公司需經過廣泛的審核和認證流程
  - 確保公司符合CREST嚴格的標準

- **資格要求**：進行滲透測試的專業人員必須具備特定資格
  - 必須遵循道德標準
  - 需要擁有相關技術能力

## 關鍵要點

- CDPT指南旨在標準化滲透測試流程
- 確保測試徹底、可防禦且由合格專業人員進行
- 這些標準不僅保障測試過程的完整性，還確保發現的問題可操作並有助於增強客戶的網路安全狀態
- CREST的核心目標是為滲透測試尋找高素質的個人和公司

# STRIDE 安全模型

## 概述

- STRIDE（資安威脅分類模型）：由微軟團隊開發的安全模型，用於軟體開發和網路安全領域，提供系統化的安全方法，涵蓋六個關鍵元素
  - 適用於識別和解決系統潛在安全漏洞
  - 通過針對性安全措施增強軟體與系統的可靠性和完整性

## 六大核心要素

- **Spoofing**（偽裝）：身分驗證相關威脅
  - 定義：攻擊者冒充其他使用者身分以獲取未授權的資訊、系統或網路存取權
  - 主要攻擊驗證程序，通過操縱資料來模仿其他使用者
  - 範例：使用被盜的憑證（如用戶名和密碼）存取系統
  - 防護措施：
    - 保護機密資料（尤其是個人識別資訊 PII）
    - 使用強大的加密技術確保敏感資訊保密
    - 儘可能避免儲存機密資訊，減少可被利用的資料點

- **Tampering**（竄改）：資料完整性相關威脅
  - 定義：對資料進行惡意修改或竄改
  - 形式多樣化，包括更改資料庫中的資料或修改網路傳輸中的資料
  - 主要關注資料完整性，未授權的變更可能帶來重大影響
  - 範例：攻擊者更改系統設定，可能危及整個系統
  - 防護措施：
    - 使用密碼學雜湊函數確保資料完整性
    - 實施適當的輸入驗證技術防止未授權的資料修改
    - 採用訊息認證碼（MAC）和數位簽章來驗證資料真實性和完整性
    - 使用防竄改協議（如 HTTPS）確保資料在傳輸過程中保持不變

- **Repudiation**（否認）：可追溯性相關威脅
  - 定義：在系統中執行無法追蹤到個人使用者的操作
  - 在缺乏適當審計和日誌記錄控制的環境中更為普遍
  - 攻擊者可否認其活動，因為沒有留下證據
  - 防護措施（不可否認性機制）：
    - 日誌記錄和數位簽章確保系統中的操作可歸因於個別使用者
    - 數位簽章提供可靠方法證明資料來源和完整性，反駁否認聲明
    - 時間戳記作為操作的時間記錄，增加問責層面
    - 審計追蹤記錄使用者活動詳細資訊，提供能確認或反駁否認企圖的證據

- **Information Disclosure**（資訊洩露）：機密性相關威脅
  - 定義：未經授權存取機密資訊，無論資料是靜態還是傳輸中
  - 通過向未授權個人公開敏感資料違反機密性，可能導致資料盜竊或洩漏
  - 防護措施：
    - 實施特定存取控制，如角色基礎存取控制（RBAC），確保只有具必要權限的使用者才能存取特定資料
    - 使用強大的演算法（如 AES-256）加密資料，保護儲存和傳輸中的資料
    - 使用安全通訊渠道（如 TLS 協議）保護傳輸中的資料
    - 保護敏感資料，除非絕對必要，否則避免儲存，以最大限度減少潛在洩露風險
  - 資料分類：根據敏感度分類資料並實施適當的安全措施
  - 錯誤處理：小心處理錯誤以避免洩露敏感資訊

- **Denial of Service**（拒絕服務）：可用性相關威脅
  - 定義：通過大量請求淹沒系統，中斷網站、服務或網路的正常功能，使合法使用者無法使用
  - 主要針對服務的可用性
  - 防護措施：
    - 部署防火牆
    - 設置速率限制規則
    - 在關鍵系統中實施冗餘，確保即使在負載下也能保持可用性
    - 過濾和流量控制機制限制流量至可管理水平
    - 服務品質（QoS）規則確保關鍵服務維持對資源的優先存取，從而在攻擊下保持系統可用性
  - 影響：拒絕服務攻擊的影響可能是毀滅性的，有可能通過產生大量請求耗盡所有可用資源

- **Elevation of Privilege**（權限提升）：授權相關威脅
  - 定義：權限有限的使用者能夠利用系統中的弱點或疏忽獲得更高級別的權限
  - 涉及可能導致重大安全漏洞的授權機制，如果管理不當
  - 防護措施：
    - 實施最小權限原則，確保使用者只擁有執行任務所需的權限
    - 此原則限制了攻擊發生時的潛在損害

## 安全屬性與威脅對應關係

| STRIDE 威脅類型 | 安全屬性 | 說明 |
|--------------|--------|------|
| Spoofing | 身分驗證 | 冒充他人身分 |
| Tampering | 完整性 | 修改資料或程式碼 |
| Repudiation | 不可否認性 | 聲稱未執行某動作 |
| Information Disclosure | 機密性 | 向未授權人員公開資訊 |
| Denial of Service | 可用性 | 拒絕或降低對使用者的服務 |
| Elevation of Privilege | 授權 | 未經適當授權獲取能力 |

## 特殊考量

- 否認（Repudiation）是一種特殊情況：從安全角度看是威脅，但在一些隱私系統中卻是理想的屬性，例如 Goldberg 的「離線記錄」（Off the Record）通訊系統
- 這展示了安全設計分析有時必須面對的矛盾

# OSSTMM

- **OSSTMM**（開源安全測試方法論手冊）：由 ISECOM（安全與開放方法研究院）開發的開源安全測試方法論，始於 2000 年，旨在提供科學方法來準確評估運作安全性（OpSec）。
  - 作為開源專案，任何人都可以提交建議供納入手冊
  - 透過徹底檢驗和比較測試結果，確保不同類型審計（如滲透測試、道德駭客、安全評估等）的一致性和可信度
  - 專注於透過安全驗證過程呈現事實和專業的安全指標

- **ISECOM**（安全與開放方法研究院）：OSSTMM 的開發和維護機構。
  - 提供額外資源如「駭客高中」(Hacker Highschool) 和「網路安全手冊」(Cybersecurity Playbook)
  - 這些資源透過付費會員形式提供，有助於提高安全意識和組織最佳實踐

- **Operational Security**（運作安全性，OpSec）：OSSTMM 評估的核心目標。
  - OSSTMM 提供了評估運作安全性的科學方法
  - 包含數位、人員和實體安全的全面測試方法

- **Security Testing**（安全測試）：OSSTMM 涵蓋多種安全測試方法。
  - 包括：滲透測試、道德駭客行為、安全評估、弱點評估、紅隊演練和藍隊演練
  - 無論組織規模、技術或保護級別如何，都提供統一的參考標準
  - 強調測試必須符合法律要求，並產出可測量、一致且可重複的結果

- **Human Security**（人員安全）：OSSTMM 關注的重要安全面向之一。
  - 與數位資產和實體安全測試共同組成全面的安全測試方法

- **Physical Security**（實體安全）：OSSTMM 測試的重要組成部分。
  - 與數位和人員安全測試相結合，提供全面的安全方法
  - 對醫療保健到金融等多個行業至關重要，這些行業需要同時保護數據和實體資產

- **Quick Start Guide**（快速入門指南）：OSSTMM 為新使用者提供的指南。
  - 協助識別測試對象和方法
  - 強調記錄測試方法以確保全面性和準確性
  - 幫助用戶設置符合全球安全標準的測試

- **OSSTMM Certification**（OSSTMM 認證）：提供給專業人士的資格認證。
  - 驗證專家在進行嚴格安全測試方面的專業知識
  - 提升專業證書和展示對高標準安全測試的承諾
  - 證明專業人士處理複雜安全情境的能力和適應網路安全威脅演變的能力

- **Environmental and Operational Security**（環境和運營安全）：OSSTMM 的附加指南。
  - 使 OSSTMM 適用於多個不同行業
  - 確保組織全面考慮各種安全因素

# 普渡模型（Purdue Model）筆記

- **Purdue Model/Purdue Enterprise Reference Architecture（普渡企業參考架構模型）**：一個保護工業控制系統（ICS）和營運技術（OT）環境的基礎框架。
  - 最初開發用於支援電腦整合製造（Computer-Integrated Manufacturing）
  - 通過網路分隔來隔離和保護OT系統免受網路威脅
  - 確保數據流遵循支持安全和順暢運營的階層結構
  - 在邊緣運算和直接雲連接環境中特別有用
  - 模型分為六個不同層級或區域，每個區域設計用於處理特定類型的數據和系統交互

- **Industrial Control Systems（工業控制系統，ICS）**：管理和自動化各行業運營流程的系統。
  - 由用於運行或自動化工業流程的設備、系統、網路和控制組成

- **Operational Technology（營運技術，OT）**：用於監控和控制物理設備和運營流程的系統。
  - 在普渡模型中，與資訊技術（IT）區域分離

## 普渡模型的層級結構

- **Level 5（第5層）- External/Vendor Support/Cloud Access（外部/供應商支援/雲端存取）**：
  - 屬於企業安全區域（Enterprise Security Zone）
  - 具有強大的IT控制，專注於風險降低
  - 管理與外部供應商和雲服務的互動
  - 支持依賴外部合作夥伴和雲技術的工業運營

- **Level 4（第4層）- Business Logistics Systems/Enterprise IT（業務物流系統/企業IT）**：
  - 具有強大的IT控制
  - 涵蓋企業IT運營，包括企業資源規劃系統（ERP）
  - 管理關鍵業務功能，如生產排程、物料使用、運輸和庫存管理

- **Level 3.5（第3.5層）- Demilitarized Zone（非軍事區，DMZ）**：
  - 緩衝區域，部署安全措施如防火牆和代理伺服器
  - 控制IT和OT系統之間的數據交換
  - 防止潛在威脅擴散

- **Level 3（第3層）- Manufacturing Operations Systems Zone（製造營運系統區域）**：
  - 部署營運管理系統，如製造執行系統（Manufacturing Execution Systems，MES）
  - 指導實時製造流程
  - 包括儲存關鍵運營數據的歷史記錄系統（Data Historians）
  - 確保基於準確數據的持續監控和優化

- **Level 2（第2層）- Control Systems Zone（控制系統區域）**：
  - 包括監督控制和數據採集（SCADA）系統
  - 監控和實際控制物理流程

- **Level 1（第1層）- Intelligent Devices Zone（智能設備區域）**：
  - 包括可編程邏輯控制器（Programmable Logic Controllers，PLCs）
  - 根據來自第0層傳感器的實時數據管理操作

- **Level 0（第0層）- Physical Process Zone（物理流程區域）**：
  - 實際製造流程發生的區域
  - 包括直接與製造操作互動的傳感器和執行器

## 普渡模型的持續相關性

- **現代網路環境中的適應性**：
  - 儘管工業網路發生變化、IT和OT融合，特別是隨著工業物聯網（Industrial Internet of Things，IIoT）的發展，普渡模型仍然高度相關
  - 雖然第0層設備到雲的直接數據流挑戰了傳統模型，但仍提供網路分隔和保護的堅實框架
  - 模型的明確區域和每個層級的嚴格控制有助於防止未授權訪問並管理網路風險

- **安全價值**：
  - 對確保工業環境的運營完整性和安全性至關重要
  - 在處理傳統和新挑戰方面具有很大的靈活性
  - 提供網路分段的結構化方法，對保護免受網路威脅和管理複雜數據流非常重要

# OCTAVE 威脅模型

- **OCTAVE**（營運關鍵威脅、資產與弱點評估）：一個由卡內基美隆大學軟體工程研究所開發的風險基礎框架，專注於識別、評估和降低組織層面的資安風險。
  - 全名為 Operationally Critical Threat, Asset, and Vulnerability Evaluation
  - 不僅是技術性威脅模型，而是專為突顯和管理組織風險的框架
  - 特別適合中小型組織使用
  - 著重於營運影響（如資料外洩）而非單純技術問題

- **自主導向方法**（Self-directed Approach）：OCTAVE 讓組織能夠主動塑造自身的安全評估，無需大量外部顧問支援。
  - 允許內部管理和營運團隊主導評估過程
  - 鼓勵組織對安全策略擁有主導權
  - 有助於將安全策略整合到業務營運中

- **OCTAVE 三大階段**（Three Main Phases）：OCTAVE 的結構圍繞三個主要階段，這些階段又細分為八個流程。
  1. 建立企業級安全需求（Build Enterprise-Wide Security Requirements）
  2. 識別基礎設施弱點（Identify Infrastructure Vulnerabilities）
  3. 制定安全風險管理策略（Determine Security Risk Management Strategies）

## 第一階段：建立企業級安全需求

- **資產為基礎的威脅剖析**（Asset-based Threat Profiles）：識別和分類各種資產，從實體設備到無形元素（如公司聲譽）。
  - 流程一：識別企業知識（Identify Enterprise Knowledge）
    - 由高階管理者提供對關鍵資產的見解
    - 討論資產價值、面臨的威脅、風險指標及現有保護策略
  
  - 流程二：識別營運區域知識（Identify Operational Area Knowledge）
    - 關注營運區域管理者對關鍵資產和威脅的觀點
    - 提供中層管理視角的安全和風險評估
  
  - 流程三：識別員工知識（Identify Staff Knowledge）
    - 納入前線和營運人員的洞察
    - 增強對組織各層級安全理解
  
  - 流程四：建立安全需求（Establish Security Requirements）
    - 整合前三個流程的信息
    - 發展全企業視角的資產、威脅、保護策略和安全需求
    - 將不同組織觀點整合為統一策略

## 第二階段：識別基礎設施弱點

- **基礎設施弱點評估**（Infrastructure Vulnerability Evaluation）：對支援關鍵資產的基礎設施進行詳細評估，找出可能被利用的弱點。
  - 流程五：將高優先級信息資產對應至信息基礎設施（Map High-Priority Information Assets to Information Infrastructure）
    - 使用已編製的資產和威脅信息來映射高優先級基礎設施組件
    - 識別資產如何與組織的實體和數位基礎設施互動
  
  - 流程六：執行基礎設施弱點評估（Perform Infrastructure Vulnerability Evaluation）
    - 整合第一階段的見解和基礎設施額外評估
    - 識別缺失的政策、實踐和可能構成風險的弱點
    - 幫助企業將最顯著的弱點與相應威脅配對
    - 根據潛在影響和相關風險可能性來優先處理弱點（如過時的 SCADA 軟體、弱密碼政策等）

## 第三階段：制定安全風險管理策略

- **客製化安全計劃**（Customized Security Plan）：創建針對已識別風險的特定安全計劃，包括具體緩解措施、實施時間表和責任分配。
  - 流程七：進行多維度風險分析（Conduct Multi-Dimensional Risk Analysis）
    - 使用前兩階段的數據分析潛在風險
    - 檢查入侵情境、資產弱點和威脅可能性
    - 根據影響和可能性對風險進行優先排序
  
  - 流程八：制定保護策略（Develop Protection Strategy）
    - 創建策略性計劃以減輕和優先處理風險
    - 選擇適當的風險緩解策略並制定風險管理計劃
    - 實施具體措施（如針對釣魚攻擊的多因素認證、員工培訓等）
    - 確保持續的風險評估和緩解

- **OCTAVE 的綜合特點**（Integrated Approach）：OCTAVE 以其全面和整合的方法脫穎而出。
  - 強調理解完整的組織風險範疇，而非僅是技術弱點
  - 結合從高層管理到操作人員的所有組織層級的見解
  - 開發符合組織目標和營運的安全策略
  - 培養主動風險管理文化，提高各部門的安全意識
  - 將安全考量整合到決策過程中
  - 通過涉及各種組織部門的評估和策略開發，創建平衡且有效的安全態勢

# DREAD 威脅模型

- **DREAD**（威脅風險評估模型）：一種用於量化、優先排序和比較各種安全威脅風險等級的風險評估模型。
  - 最初是微軟威脅建模框架的一部分
  - 是 Damage potential（損害潛力）、Reproducibility（可重現性）、Exploitability（可利用性）、Affected users（受影響用戶）、Discoverability（可發現性）的縮寫
  - 透過對每個類別評分（0-10分），計算總分來決定威脅的嚴重程度

## 風險嚴重程度分級

- **Critical（嚴重）**：40-50分，必須立即解決的漏洞
- **High（高）**：25-39分，嚴重漏洞，應盡快審查並解決
- **Medium（中）**：11-24分，中等風險，在處理更嚴重風險後再審查
- **Low（低）**：1-10分，對基礎設施和數據構成的風險較小

## DREAD 評估要素

- **Damage Potential（損害潛力）**：評估成功利用漏洞可能造成的損害程度
  - 範圍從輕微不便到嚴重的操作中斷或敏感數據洩露
  - 評分範例：
    - 0：無損害
    - 5：信息洩露
    - 8：非敏感用戶數據洩露
    - 9：非敏感管理數據洩露
    - 10：信息系統遭到破壞；數據或應用程序不可用

- **Reproducibility（可重現性）**：衡量攻擊者重複威脅的容易程度
  - 高分表示漏洞可在各種條件下可靠地被利用，無需高級技能或特定環境
  - 評分範例：
    - 0：難以實現或不可能
    - 5：複雜
    - 7.5：容易
    - 10：非常容易

- **Exploitability（可利用性）**：評估利用漏洞所需的努力和資源水平
  - 受攻擊複雜性和所需訪問級別影響
  - 評分範例：
    - 2.5：需要高級編程和網路技能
    - 5：有可用攻擊工具
    - 9：需使用網路應用程式代理
    - 10：只需網頁瀏覽器即可完成

- **Affected Users（受影響用戶）**：量化若漏洞被利用，會影響的用戶群體範圍
  - 範圍從單一用戶到整個客戶群
  - 評分範例：
    - 0：無用戶受影響
    - 2.5：個別用戶
    - 6：少數用戶
    - 8：管理用戶
    - 10：所有用戶

- **Discoverability（可發現性）**：潛在攻擊者發現漏洞的難易程度
  - 高分通常給予明顯或有完善文檔的漏洞，這類漏洞只需最低技能即可識別
  - 評分範例：
    - 0：難以發現漏洞
    - 5：HTTP 請求可發現漏洞
    - 8：公共領域中發現的漏洞
    - 10：網址列或表單中發現的漏洞

## DREAD 模型使用注意事項

- DREAD 應作為現有安全評估策略的補充，而非替代
- 應與其他模型和最新安全實踐結合使用
- 此模型可能無法涵蓋所有類型的現代網路安全威脅
- 可能過度簡化複雜的漏洞
- 有助於組織根據可量化的潛在影響評估，對需要立即處理的漏洞做出明智決策
