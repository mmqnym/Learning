# 無線網路攻擊

- **無線攻擊**（Wireless Attacks）：針對 Wi-Fi 和其他射頻上的網路連接進行攔截、操縱和干擾數據傳輸的攻擊
  - 這些攻擊利用無線網路協議和設備中的漏洞
  - 理解這些戰術對滲透測試人員來說是保護無線網路的必備技能

## 概要

### 1. 無線安全基礎
- 學習無線網路安全基礎，包括加密類型和安全協議，以防止未授權訪問

### 2. 無線訊號利用
- 學習與無線訊號相關的各種漏洞及其如何被利用來獲取通信網路的未授權訪問

### 3. Aircrack-ng 工具
- **Aircrack-ng**（無線網路破解工具）：用於破解 Wi-Fi 密碼和網路監控的強大工具
  - 幫助理解無線協議中的弱點
  - 執行解除驗證攻擊（Deauthentication Attack）

### 4. 無線網路入侵實作
- 對真實無線網路進行實際攻擊演示，說明理論知識的實際應用

### 5. WPS PIN 攻擊
- 展示攻擊者如何利用 WPS 功能繞過 Wi-Fi 安全措施
- 強調在無線網路設置中禁用 WPS 的重要性

### 6. 強制門戶攻擊
- **強制門戶攻擊**（Captive Portal Attacks）：攻擊者創建假冒登錄頁面以竊取憑證或在用戶嘗試連接公共 Wi-Fi 網路時注入惡意軟體

### 7. 邪惡雙胞胎攻擊
- **邪惡雙胞胎攻擊**（Evil Twin Attack）：設置與合法網路無法區分的惡意無線接入點
  - 欺騙用戶連接並提交敏感信息

### 8. Kismet 工具演示
- **Kismet**（無線網路檢測工具）：用於 802.11 無線區域網的網路檢測器、封包嗅探和入侵檢測系統
  - 可識別隱藏網路和易受攻擊的設備
  - 是一種被動式無線檢測和嗅探工具

### 9. Wi-Fi 協議模糊測試
- **Wi-Fi 協議模糊測試**（Wi-Fi Protocol Fuzzing）：攻擊者通過發送意外或隨機數據到網路設備來引入錯誤
  - 可能導致設備崩潰或暴露安全弱點

### 10. 解除驗證攻擊
- **解除驗證攻擊**（Deauthentication Attack）：攻擊者在 Wi-Fi 網路中發送解除驗證幀，強制將無線客戶端從接入點斷開
  - 通過偽裝成目標設備或接入點，攻擊者可以說服另一方斷開連接
  - 這種攻擊針對通信而非加密，使即使受保護良好的網路也容易受到攻擊

## 網路安全威脅

- **家庭網路**：弱密碼或默認 Wi-Fi 密碼是常見的家庭安全漏洞
  - 使個人數據容易受到暴力攻擊、密碼破解或未授權訪問
  - 用戶需實施強大、獨特的密碼並啟用加密

- **公共網路**：特別危險，因常缺乏強大的端點安全措施
  - 使用戶暴露於封包嗅探和釣魚攻擊風險中

# 無線加密類型（Wireless Encryption Types）

## 基本概念

- **無線加密（Wireless Encryption）**：保護無線網路傳輸中資料安全的關鍵技術
  - 大多數無線加密方案依賴預共享金鑰（Pre-shared Key）
  - 使用預共享金鑰的問題是：擴充性差，密鑰洩露風險高

## 無線加密類型

- **WEP（Wired Equivalent Privacy）**：最初的 802.11 無線安全標準
  - 聲稱提供等同有線網路的安全性（實際上安全性很低）
  - 使用 RC4 加密算法
  - 最初使用 40 位元密鑰，後來升級到 64 位元和 128 位元
  - 主要弱點：24 位元初始化向量（IV）以明文方式傳送
  - 可用 Aircrack-ng 等工具在幾分鐘內破解

- **WPA（Wi-Fi Protected Access）**：取代 WEP 的標準
  - 使用暫時密鑰完整性協議（TKIP, Temporal Key Integrity Protocol）
  - 採用 48 位元初始化向量（取代 WEP 的 24 位元）
  - 使用 RC4 加密算法
  - 加入訊息完整性檢查（MIC, Message Integrity Check）

- **WPA2（Wi-Fi Protected Access version 2）**：802.11i 標準的一部分
  - 使用 CCMP（Counter Mode with Cipher Block Chaining Message Authentication Code Protocol）
  - 結合 AES（Advanced Encryption Standard）加密
  - 使用 128 位元或更高的加密密鑰
  - 可在個人模式（使用預共享金鑰）或企業模式（使用中央認證伺服器）運行

- **WPA3（Wi-Fi Protected Access version 3）**：2018 年引入
  - 個人模式：使用 AES-CCMP-128（128 位元金鑰 + AES 加密）
  - 企業模式：192 位元加密強度，最高可達 256 位元AES 加密金鑰
  - 使用 SHA-384 進行雜湊和完整性檢查
  - 最大改進：使用 SAE（Simultaneous Authentication of Equals）取代預共享金鑰
  - 提供前向保密（Forward Secrecy）防止長期密鑰被破解

## 重要安全技術

- **SAE（Simultaneous Authentication of Equals）**：WPA3 使用的認證方式
  - 基於安全密碼身份驗證和密碼驗證金鑰協議方法
  - 實現完美前向保密（Perfect Forward Secrecy）

- **前向保密（Forward Secrecy）**：即使長期密鑰被破解，會話金鑰也不會被破解
  - 工作流程：
    1. 存取點和客戶端生成長期金鑰對（僅一次）
    2. 交換一次性會話金鑰（使用 Diffie-Hellman 或 TLS）
    3. 存取點使用會話金鑰加密消息
    4. 客戶端使用會話金鑰解密消息
    5. 重複此過程並定期重新協商新的會話金鑰

## 其他無線安全概念

- **WPS（Wi-Fi Protected Setup）**：設計為簡化無線設備設置的方法
  - 安全性非常弱，使用 8 位數 PIN 碼（實際上分為兩組 4 位數）
  - 每組 4 位數只有 10,000 種組合，容易被暴力破解
  - 建議：安全防護者應立即禁用所有 WPS 設備

- **MAC 過濾（MAC Filtering）**：提供虛假的安全感
  - 可設置為顯式允許或顯式拒絕
  - 攻擊者可使用 `macchanger` 等工具輕鬆更改 MAC 地址繞過

## 考試提示

- 題目中提到「開放（open）」表示網路沒有安全性或加密
- WEP - 弱點是初始化向量（IV），可進行暴力破解
- WPA - 弱點是 RC4 和 TKIP
- WPA2 - 弱點是 AES 和 CCMP，可嘗試字典攻擊或暴力破解預共享金鑰
- WPA3 - 目前算法本身沒有已知攻擊，Dragonfly 是 SAE 的暱稱

# 無線訊號利用技術

## 主要技術概念

- **Signal Jamming**（訊號干擾）：透過噪音或其他訊號淹沒特定頻率，破壞無線通訊的行為
    - 透過發送干擾訊號，阻止裝置連接網路或有效通訊
    - 類似於房間內所有人同時講話，使單一對話難以聽清
    - 在許多國家屬非法行為，因可能干擾緊急通訊和關鍵服務
    - 頻率干擾主要針對使用無線電頻率傳輸數據的通訊系統

- **Wardriving**（戰爭駕駛）：通過移動方式搜尋Wi-Fi網路的實踐
    - 通常使用車輛在特定地理區域進行移動，故稱「wardriving」
    - 使用筆記型電腦或智慧型手機配合Wi-Fi掃描工具進行
    - 可繪製特定區域中可用的網路地圖
    - 有助於識別安全性不足的網路，作為滲透測試的潛在目標
    - wardriving 涉及使用筆記型電腦或手機捕獲Wi-Fi網路數據（位置、SSID、加密類型）

## 相關工具

- **WiGLE.net**：收集並繪製全球使用者發現的Wi-Fi網路位置的網站
    - 使用者可以上傳自己wardriving的發現結果（須先獲得客戶許可）
    - 提供特定區域的無線網路全景，無需實地考察
    - 可搜尋特定區域的網路，了解Wi-Fi網路的密度和安全性
    - 特別適合分析位於辦公園區等多企業環境中的目標

- **inSSIDer**：Wi-Fi掃描工具，用於視覺化周圍的無線網路
    - 顯示每個檢測到的網路詳細資訊，包括：
        - 訊號強度
        - 頻道
        - 安全類型等
    - 協助識別值得進一步調查的網路
    - 可識別使用弱安全設置（如WEP）或無加密的網路
    - 有助於識別在同一頻道上重疊的網路（可能造成干擾）
    - 使用方式簡單，安裝後會持續掃描周圍的Wi-Fi訊號

## 安全協議知識

- **WPA3**：較高安全性的Wi-Fi保護協議
    - 相較於其他協議，更能抵抗攻擊
    - 不建議在滲透測試中花費過多精力嘗試破解
    - WPA3比WPA2對離線暴力破解攻擊的抵抗力更強

- **WEP**（Wired Equivalent Privacy）：早期的網路安全協議
    - 來自1997年的舊IEEE 802.11標準
    - 安全性極弱，密碼通常可在幾分鐘內被破解
    - 為滲透測試的理想目標

## 實用技巧

- 進行wardriving時，建議先獲得客戶許可再上傳數據到WiGLE.net
- 在無線網路滲透測試中，優先關注使用弱安全設置的網路
- 使用inSSIDer實時分析Wi-Fi訊號以提高效率
- 留意WPA3保護的網路，這些網路通常更難以滲透

# Aircrack-ng

- **Aircrack-ng Suite**（無線網路安全稽核工具集）：一套用於無線網路稽核和滲透測試的工具集
  - 包含多個實用工具，主要工具為 Aircrack-ng 本身
  - 主要用於破解 WEP、WPA 和 WPA2-PSK 金鑰（需要先捕獲足夠的資料封包）
  - 破解前需要收集握手封包或初始化向量（IVs）

- **Deauthentication Attack**（解除驗證攻擊）：一種針對無線網路的阻斷服務攻擊
  - 目標是通過發送偽造的解除驗證封包強制使客戶端與無線存取點斷開連接
  - 這種攻擊利用的是管理框架在 Wi-Fi 中默認不受保護的弱點（除非啟用 802.11w PMF）
  - 可用作其他進階攻擊的前置步驟，例如破解 WPA/WPA2 金鑰或架設釣魚熱點

- **攻擊步驟**：
  1. **網卡設為監聽或混雜模式**：使用 `airmon-ng start wlan0` 讓網卡能夠捕獲所有無線封包
  2. **掃描網路**：使用 `airodump-ng wlan0mon` 識別周圍無線網路和目標
  3. **鎖定目標網路監聽**：使用 `airodump-ng --bssid <MAC地址> -c <頻道> -w <捕獲檔名> wlan0mon`
  4. **執行解除驗證攻擊**：使用 `aireplay-ng --deauth <封包數量> -a <存取點MAC> -c <客戶端MAC> wlan0mon`
     - `-a` 指定存取點的 MAC 地址
     - `-c` 指定目標客戶端的 MAC 地址（可省略以攻擊所有連接的客戶端
     - `--deauth` 後面數字指定發送多少解除驗證封包
  5. **捕獲 WPA 握手封包**：客戶端重新連線時會產生握手封包
  6. **破解密碼**：使用 `aircrack-ng -w <字典檔案路徑> -b <目標MAC> <捕獲封包檔案名>`

- **攻擊用途**：
  - **DoS（阻斷服務）**：使用者長時間無法連接網路
  - **捕獲 WPA 握手**：用於後續破解 WPA/WPA2 加密
  - **Evil Twin 攻擊**：配合假冒熱點進行更複雜的攻擊

- **攻擊流程摘要**：
  - 網路掃描：識別目標網路
  - 封包嗅探：使用 Wireshark 或 airodump-ng 捕獲封包
  - 發送解除驗證封包：使用 aireplay-ng 工具發送偽造封包
  - 捕獲資料：當受害者嘗試重新連接時捕獲握手過程

- **法律與道德提醒**：
  - 這些技術應僅用於經授權的安全測試和受控環境
  - 未經授權對網路進行攻擊是違法行為

# Aircrack-ng 簡易使用方式

## 原理解釋

1. Aircrack-ng 需要捕獲到完整的四向握手過程
    - 這些握手封包內含了經過雜湊處理的認證資訊，但不包含明文密碼
    - 破解過程是離線進行的「比對」，而非直接解密

2. 去認證攻擊的目的：
    - 自然等待握手可能需要很長時間
    - 去認證攻擊強制使已連接的客戶端斷線
    - 客戶端嘗試重新連接時會產生新的握手過程
    - 這是一種「強制產生」攻擊者所需的握手封包的方法

3. 離線破解的工作原理：
    - 有了握手封包後，即可取得雜湊過的認證資訊，可以在不需要繼續監聽網路的情況下進行離線破解
    - Aircrack-ng 會嘗試字典中的每個密碼
    - 將每個可能的密碼經過相同的雜湊處理，與握手包中的雜湊值比對
    - 當找到匹配時，就確定了正確的密碼

### 相對暴力破解的優勢

- 只需一次網路交互（獲取握手包）
- 可以高速離線運算
- 不受網路防護機制限制（暴力破解很容易被發現從而封鎖流量）
- 破解速度僅受本地計算能力限制

## 主要模組

- **Airmon-ng**（監聽模式工具）：
  - 用於將無線網卡切換到監聽模式（Monitor mode）
  - 使無線網卡能夠捕獲所有頻道上的無線流量，而不僅限於連接到的網路

- **Airodump-ng**（流量捕獲工具）：
  - 用於監控無線頻率、識別客戶端和接入點
  - 捕獲網路流量並保存為 PCAP 文件
  - 常用參數：
    - `-c`：指定監聽的頻道
    - `--bssid`：指定目標接入點的 MAC 地址
    - `--write`：指定保存捕獲數據的文件名

- **Aireplay-ng**（流量注入工具）：
  - 用於生成網路流量或進行攻擊
  - 可執行去認證（Deauthentication）攻擊，使客戶端與接入點斷開連接
  - 常用參數：
    - `--deauth`：指定發送的去認證封包數量
    - `-a`：指定目標接入點的 MAC 地址
    - `-c`：指定要斷開連接的客戶端 MAC 地址

- **Aircrack-ng**（密碼破解工具）：
  - 用於破解 WEP 和 WPA/WPA2 PSK（預共享金鑰）
  - 使用字典攻擊或暴力破解方法
  - 常用參數：
    - `-w`：指定要使用的字典文件路徑

## WPA/WPA2 字典攻擊步驟

1. **啟用監聽模式**：使用 Airmon-ng 將無線網卡設置為監聽模式
   ```
   airmon-ng start wlan0
   ```

2. **發現目標網路**：使用 Airodump-ng 掃描並識別 WPA/WPA2 保護的網路
   ```
   airodump-ng wlan0mon
   ```

3. **捕獲網路流量**：針對特定接入點捕獲流量，保存為文件
   ```
   airodump-ng wlan0mon -c [頻道] --bssid [接入點MAC] --write [文件名]
   ```

4. **執行去認證攻擊**：使用 Aireplay-ng 執行去認證攻擊，迫使客戶端重新連接
   ```
   aireplay-ng --deauth [數量] -a [接入點MAC] -c [客戶端MAC] wlan0mon
   ```

5. **密碼破解**：使用 Aircrack-ng 對捕獲的握手包進行字典攻擊
   ```
   aircrack-ng [捕獲文件] -w [字典文件路徑]
   ```

## 安全建議

- **使用複雜密碼**：密碼應包含大小寫字母、數字和特殊字符，且長度足夠
- **避免使用常見密碼**：即使複雜的密碼，如果存在於常見字典中（如 rockyou.txt）也容易被破解
- **定期更換密碼**：降低被破解的風險

# WPS 攻擊技術與防禦

## 基本概念

- **Wi-Fi Protected Setup (WPS)（Wi-Fi 保護設定）**：一種簡化無線網路設定的協議，讓使用者不需記憶複雜密碼即可連接裝置。
  - 通常在路由器上有一個按鈕或 PIN 碼用於連接
  - 設計用來簡化使用者體驗，但犧牲了安全性

- **WPS PIN（個人識別碼）**：八位數字的代碼，用於自動設定連接 WPS 網路。
  - 實際上只有七位有效數字，第八位為檢查碼（校驗和）
  - PIN 碼在驗證過程中被分為兩部分（前四位和後三位）進行驗證

## WPS 的安全漏洞

- **PIN 驗證機制漏洞**：
  - 路由器會先驗證 PIN 碼的前四位數字，再驗證後三位
  - 這使得攻擊者可以分階段破解，而不是一次嘗試所有可能組合
  - 前四位只有 10,000 種可能（10^4）
  - 後三位只有 1,000 種可能（10^3）
  - 總共只需嘗試約 11,000 次，遠低於完整七位數（10^7 = 1千萬）的可能性

- **沒有有效的鎖定機制**：
  - 許多路由器在多次失敗嘗試後不會鎖定 WPS 功能
  - 這允許攻擊者可以無限次嘗試 PIN 碼
  - 部分路由器甚至沒有實施 60 秒的鎖定時間

## 攻擊工具

- **Wash**：用於掃描啟用 WPS 的網路
  - 顯示目標的 MAC 地址、頻道、WPS 版本以及是否被鎖定

- **Reaver**：WPS PIN 碼暴力破解工具
  - 透過嘗試所有可能的 PIN 碼組合來破解 WPS
  - 需要啟用監聽模式的無線網卡
  - 每次嘗試間隔約 5 秒，完整破解可能需要數小時

- **Bully**：利用已知的 PIN 碼獲取 Wi-Fi 密碼
  - 一旦獲取 PIN 碼，能夠在幾秒內連接並獲取實際的 Wi-Fi 密碼

## 攻擊流程

1. 將網卡設為監聽模式（使用 airmon-ng）
2. 使用 Wash 掃描啟用 WPS 的網路
3. 使用 Reaver 對目標進行 PIN 碼暴力破解
4. 獲取 PIN 碼後，使用 Bully 連接網路並獲取 Wi-Fi 密碼

## 防禦方法

- **關閉 WPS 功能**：這是唯一完全有效的防禦方法
  - 雖然犧牲了易用性，但能徹底消除此類威脅
  - 許多現代網路設備已預設關閉 WPS 

- **注意事項**：
  - 即使更改了 Wi-Fi 密碼，如果未關閉 WPS 或更改 PIN 碼，攻擊者仍可輕易獲取訪問權
  - 許多路由器甚至不允許更改 WPS PIN 碼

## 重要結論

- WPS 漏洞沒有已知的有效緩解措施，除了完全關閉 WPS
- 攻擊成功率幾乎 100%，只是時間長短問題
- 消費級和小型商業環境中的路由器常常仍啟用 WPS
- PIN 暴力破解是常見的攻擊方式，只需嘗試 11,000 個可能組合
- 與加密通訊協定無關，這就像留了一道非常簡易的後門一樣，除非被徹底摧毀（無效），否則仍然可被破解出密碼

# 利用公共 Wi-Fi 驗證機制的攻擊

## 基本概念

- **Captive Portal（強制門戶）**：
  - 使用者連接公共 Wi-Fi 時自動導向的網頁
  - 要求使用者互動（登入、接受條款、提供電子郵件）才能獲得網路存取
  - 常見於咖啡店、機場、飯店和飛機上的 Wi-Fi

## 攻擊技術

- **Evil Twin Attack（惡魔孿生攻擊）**：
  - 攻擊者設置假冒的 Wi-Fi 存取點，模仿合法網路
  - 使用相同的 SSID 並配置更強的訊號，誘使使用者連接
  - 提供看似真實的強制入口網頁以竊取憑證或敏感資訊
  - 例如：在咖啡店創建同名的假冒 "CoffeeShop WiFi" 網路

- **軟體漏洞利用**：
  - 利用強制入口網頁軟體中的安全漏洞
  - 常見漏洞包括跨網站指令碼（XSS）、SQL 注入，或工作階段處理不當
  - 攻擊者可能繞過驗證、注入惡意指令碼、獲取管理權限

- **滲透測試場景**：
  - 在機場休息室設置假的強制入口網頁
  - 收集旅客的常客帳號資訊或其他敏感資料

## 防護措施

- **網路安全設置**：
  - 使用獨特的 SSID，避免通用名稱
  - 實施強加密（如 WPA3）搭配強密碼

- **軟體維護**：
  - 定期更新和修補強制入口網頁軟體
  - 進行安全評估和滲透測試

- **用戶教育**：
  - 教導用戶驗證 Wi-Fi 網路的真實性
  - 在公共網路上謹慎輸入敏感資訊
  - 儘量避免使用公共 Wi-Fi，改用手機熱點
  - 提醒用戶：合法強制入口網頁通常不會要求高敏感度資訊（如銀行詳細資料）

## 安全建議

- 未授權的 Wi-Fi 設備（惡意存取點）可能會暴露敏感資料或讓攻擊者潛入網路
- 攻擊者可能透過中間人攻擊冒充內部 Wi-Fi 網路
- Wi-Fi Karma 攻擊利用設備尋找網路的正常行為，設立欺騙性網路來冒充曾經連接過的合法網路
- 公共熱點常顯示強制入口網頁，攻擊者可能複製入口網頁設計，誘騙使用者洩露登入數據

# Evil Twin 攻擊與 WiFi-Pumpkin 工具

- **Evil Twin Attack**（惡魔孿生攻擊）：攻擊者設置一個模仿合法Wi-Fi接入點的惡意接入點，目的是誘騙使用者連接到假冒的接入點
  - 這是一種「On-path Attack」（路徑上攻擊）的形式，過去稱為中間人攻擊（Man-in-the-Middle Attack）
  - 攻擊者可以截取並操縱受害者的流量
  - 可能會暴露敏感資訊如用戶名、密碼或任何未加密傳輸的資料

- **攻擊原理**（Evil Twin Attack機制）：
  - 攻擊者創建與合法網路同名（相同SSID）的仿冒接入點
  - 使用者在不仔細檢查網路詳情的情況下連接到惡意網路
  - 一旦連接，攻擊者可以截取流量、竊取登入憑證或注入惡意內容
  
- **攻擊範例**：
  - 在咖啡店中，正常Wi-Fi名稱為「Coffee_WiFi」
  - 攻擊者設置同名的惡意接入點「Coffee_WiFi」
  - 使用者誤連到攻擊者的網路，攻擊者可截取所有流量

- **WiFi-Pumpkin**（Wi-Fi南瓜工具）：用Python編寫的強大框架，用於創建假接入點，便於執行Evil Twin攻擊
  - 可以克隆目標網路的SSID
  - 建立釣魚入口網站
  - 操控DNS設定，將受害者流量重定向到惡意網站
  - 捕獲傳輸中的數據

- **WiFi-Pumpkin功能**：
  - 資料截取：從連接的受害者捕獲資料
  - 流量操作：注入假登入頁面以竊取憑證
  - SSL降級：整合SSLstrip工具將HTTPS降級為HTTP，便於竊取加密連接中的敏感資訊
  - 擴展模組：提供封包嗅探、DNS欺騙和強制入口網站等功能

- **防護措施**：
  - 使用VPN
  - 避免連接開放式Wi-Fi網路
  - 確保強加密和適當的憑證

# Kismet

- **Kismet**（Kismet 無線網路偵測工具）：一款強大的開源無線網路偵測和監控工具，可作為嗅探器、無線入侵偵測系統、戰爭駕駛工具和封包捕獲工具
   - 支援多種無線技術：Wi-Fi、Bluetooth、BTLE（低功耗藍牙）、無線溫度計、飛機、電錶、Zigbee 等
   - 主要用於滲透測試的偵察階段，收集無線環境資訊

## 主要功能與特點

- **Passive Mode**（被動模式）：Kismet 以完全被動方式運作，只監聽而不與網路互動
   - 不會發送任何封包，避免被目標偵測到存在
   - 非常適合隱秘的偵察活動

- **Hidden Network Detection**（隱藏網路偵測）：能夠偵測設定為隱藏的 SSID
   - 即使網路不廣播 SSID，Kismet 仍能捕獲信標和客戶端與存取點之間交換的封包
   - 當客戶端連接到隱藏網路時，Kismet 會在握手過程中捕獲並顯示 SSID

- **Network Information Collection**（網路資訊收集）：收集並顯示各種網路詳情
   - 顯示 SSID、訊號強度、加密類型（如 WPA2、WEP）
   - 記錄存取點和連接設備的 MAC 位址

- **Traffic Logging**（流量記錄）：記錄捕獲的流量以便後續分析
   - 可與 Wireshark 等工具結合使用進行深入分析
   - 可用於尋找未加密的傳輸資訊或結合 Aircrack-ng 嘗試破解 WEP/WPA2 加密

- **Multi-Protocol Support**（多協議支援）：不限於 802.11 Wi-Fi 網路
   - 可偵測 Bluetooth 設備、Zigbee 網路和其他無線協議
   - 有助於發現使用不同通訊協議的 IoT 設備

## 應用場景

- **企業無線評估**：在辦公大樓進行無線安全評估，監控區域內的所有 Wi-Fi 流量
- **安全審計**：了解環境中所有無線網路，包括不容易被發現的網路
- **惡意存取點偵測**：偵測非法或惡意的存取點
- **IoT 設備探索**：識別使用不同無線協議的物聯網設備

# Wi-Fi 協定模糊測試

## 基本概念

- **Wi-Fi Protocol Fuzzing**（Wi-Fi 協定模糊測試）：一種通過向無線設備發送隨機或非預期數據並觀察其行為來識別 Wi-Fi 實現中漏洞的技術。
  - 目的是在惡意行為者利用漏洞之前發現並修復這些漏洞
  - 透過生成和傳輸各種畸形封包來測試 Wi-Fi 設備的反應
  - 畸形封包可能導致設備崩潰、資料洩露或遠端程式碼執行

## Wi-Fi 協定基礎

- **IEEE 802.11**（IEEE 802.11 協定）：定義數據如何在無線網路上傳輸的協定。
  - 包含不同類型的幀：管理幀（Management Frames）、控制幀（Control Frames）和數據幀（Data Frames）
  - 每種幀類型在網路維護和數據傳輸中有不同用途

## 模糊測試過程

- **測試環境準備**：需要支持監聽模式的無線網路適配器
  - 監聽模式（Monitor Mode）允許捕獲和注入 Wi-Fi 網路上的數據包

- **封包製作與發送**：使用工具如 Scapy 創建畸形 Wi-Fi 封包
  - 例如：創建帶有無效原因碼的取消認證幀（De-authentication Frame）
  - 或創建具有非預期 SSID 值的信標幀（Beacon Frame）

- **結果分析**：觀察目標設備對畸形封包的反應
  - 尋找崩潰、錯誤訊息或異常行為的跡象
  - 這些反應可能表明設備無法正確處理封包，存在潛在漏洞

## 常見的畸形封包示例

- **Frame Check Sequence (FCS)**（幀檢查序列）：封包中用於檢查錯誤的部分。
  - 故意發送帶有錯誤 FCS 值的幀可能導致接收設備混淆
  - 可能導致設備丟棄幀或產生異常行為

- **虛假 MAC 地址或錯誤序列號**：
  - 可能干擾網路正常運作
  - 揭示網路錯誤處理機制中的弱點

## 常用工具

- **Scapy**：用於封包製作和發送的 Python 庫
  - 可以創建自定義 Wi-Fi 幀並設定特定屬性（包括錯誤或非預期值）
  - 示例：`sendp(RadioTap()/Dot11()/Dot11Deauth(reason=99), iface="wlan0")`

- **Wireshark**：用於封包分析的工具
  - 可用於觀察目標設備對畸形封包的反應

## 案例示例

- **取消認證幀模糊測試**：
  - 創建具有無效原因碼（如 99）的取消認證幀
  - 使用 Scapy 的 sendp 函數通過無線接口發送該幀

- **信標幀模糊測試**：
  - 創建具有非預期 SSID 值的信標幀
  - 發送該信標幀以觀察設備反應

## 防護措施

- **強健的錯誤處理**：製造商需在設備韌體和軟件中實現強健的錯誤處理機制

- **定期更新與修補**：定期更新設備以修補已識別的漏洞

- **IDS/IPS 系統**：
  - **Intrusion Detection Systems (IDS)**（入侵檢測系統）：監控可疑的無線流量
  - **Intrusion Prevention Systems (IPS)**（入侵防禦系統）：阻止惡意的無線流量
