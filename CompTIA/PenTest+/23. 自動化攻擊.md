# 自動化攻擊

## 自動化攻擊概述

- **Automated Attacks**（自動化攻擊）：使用腳本和自動化工具來利用系統和網路中的漏洞
  - 允許攻擊者快速且重複地執行複雜任務，提高攻擊效率和範圍
  - 對於滲透測試執行和防禦都是必要的知識

## Bash 自動化攻擊

- **Bash Scripting**（Bash 腳本編寫）：用於自動化例行任務
  - 可自動化資料收集、解析和執行複雜的命令序列

## Windows 攻擊框架

- **Empire and PowerSploit**（Empire 和 PowerSploit）：Windows 域滲透測試工具
  - 提供後漏洞利用模組，例如權限提升、建立持久性和資料竊取

- **PowerView**：進階 Windows 環境列舉工具
  - 用於獲取 Windows 環境的深入洞察，提高網路環境感知能力

- **PowerUpSQL**：SQL 伺服器利用工具
  - 設計用於利用 SQL 伺服器系統，允許命令執行和角色提升

- **AD Search**（活動目錄搜尋）：自動化活動目錄搜尋工具
  - 自動搜尋活動目錄以發現有價值信息和潛在提權區域

## 網路攻擊工具

- **Impacket**（網路協議工具包）：Python 類和腳本套件
  - 用於處理網路協議和篡改數據包以利用網路服務實現中的漏洞
  - 提供對數據包的低級程式化存取，實現某些協議（如 SMB1-3 和 MSRPC）的實現
  - 包含許多強大工具，如 secretsdump，可從 Windows 系統提取憑證、NTLM 密碼雜湊和 LSA 機密
  - 可用於橫向移動，如 addcomputer.py 工具允許在活動目錄中添加電腦帳號

- **Scapy**（數據包製作工具）：數據包製作和操作工具
  - 用於執行複雜攻擊的數據包操作

## 攻擊模擬框架

- **Caldera**（自動化對手模擬系統）：使用預定義的戰術和技術模擬完整規模的攻擊
  - 為滲透測試人員提供重要工具

- **Infection Monkey**：入侵和攻擊模擬工具
  - 用於測試 IT 環境對網路攻擊的抵抗力

- **Atomic Red Team**：基於 MITRE ATT&CK 框架的模擬工具
  - 允許小型、可攜式和模組化測試，模擬已知惡意攻擊和技術
  - 提供全面的方法來增強系統防禦

# Empire 與 PowerSploit 框架

## Empire 框架

- **Empire**（漏洞利用後框架）：
  - 基於 PowerShell 的遠程控制木馬
  - 允許運行 PowerShell 代理而無需 PowerShell.exe，有助於規避檢測
  - 提供用於憑證收集、橫向移動和持久性任務的模組
  - 適用於已獲得初始存取權限並需要維持控制和橫向移動的情境

- **Empire Listener**（監聽器）：
  - 一種等待代理回連的伺服器
  - 設定基本監聽器的命令：`uselistener http` → `set Host http://your-ip-address` → `execute`
  - 監聽器執行後，需在目標機器上執行payload以建立連接

- **Empire Agent**（代理）：
  - 連接到Empire監聽器的程序
  - 允許執行各種漏洞利用後模組
  - 憑證收集範例：`usemodule credentials/mimikatz/logonpasswords` → `execute`

## PowerSploit 框架

- **PowerSploit**（PowerShell腳本集合）：
  - 用於漏洞利用後、偵察和漏洞利用的PowerShell腳本框架
  - 包含在Empire中，也可獨立使用
  - 主要功能包括權限提升、代碼執行等

- **PowerSploit Privesc**（權限提升套件）：
  - 用於檢查Windows機器上權限提升機會的模組
  - 使用命令：`Import-module PowerSploit/Privesc` → `Invoke-Allchecks`
  - 自動識別常見錯誤配置和漏洞

- **Invoke-Shellcode**（Shellcode注入模組）：
  - 允許直接將Shellcode注入運行進程的記憶體
  - 避免接觸磁碟，規避反病毒解決方案檢測
  - 使用命令：`Import-module PowerSploit/CodeExecution` → `Invoke-Shellcode -ProcessID 1234 -Shellcode (Get-Content shellcode.bin)`

## PowerSploit 主要功能模組 

- **CodeExecution**（代碼執行）：
  - 可在目標機器上執行程式碼
  - 包含多種注入方式：DLL注入、反射PE注入、Shellcode注入等
  - 例如：`Invoke-DllInjection`、`Invoke-ReflectivePEInjection`、`Invoke-WmiCommand`

- **Credential Harvesting**（憑證收集）：
  - `Invoke-CredentialInjection`：建立明文憑證登錄而不觸發可疑事件ID
  - `Invoke-Mimikatz`：在記憶體中反射載入Mimikatz 2.0，無需寫入磁碟即可轉儲憑證
  - `Invoke-NinjaCopy`：通過讀取原始卷和解析NTFS結構來複製文件

## 綜合利用示例

- **完整攻擊鏈自動化**：
  1. 初始存取：部署Empire代理到目標機器
  2. 權限提升：使用PowerSploit的`Invoke-Allchecks`識別可能的提升路徑
  3. 憑證轉儲：使用提升的權限和Empire的Mimikatz模組提取憑證
  4. 橫向移動：利用獲取的憑證進行網路橫向移動

- **使用提示**：
  - 如果使用PowerShell v3，可通過以下命令移除安全警告：
    ```powershell
    $Env:PSModulePath.Split(';') | % { if ( Test-Path (Join-Path $_ PowerSploit) ) {Get-ChildItem $_ -Recurse | Unblock-File} }
    ```
  - 透過`Import-Module PowerSploit`匯入模組
  - 使用`Get-Command -Module PowerSploit`查看可用命令

# PowerView

## 基本介紹

- **PowerView**（PowerView）：一個 PowerShell 工具集，屬於 PowerSploit 框架的一部分，專為自動化活動目錄環境偵察任務設計
  - 主要用於繪製活動目錄環境的結構圖，包括識別用戶、群組、電腦及它們之間的關係
  - 通過自動化偵察過程，能快速獲取 AD 環境的全景，有助於規劃滲透測試後續步驟

## 主要功能

### 使用者相關命令

- **Get-NetUser**：列出域中所有用戶帳戶
  - 可用於分析潛在目標，如具有特權的帳戶或長期未使用的帳戶
  - 範例：`Get-NetUser | select cn` 只顯示用戶的通用名稱 (CN)

### 群組相關命令

- **Get-NetGroup** / **Get-DomainGroup**：列出域中所有群組
  - 有助於了解權限結構和資源訪問控制
  - 範例：`Get-NetGroup -GroupName *Admin*` 查找名稱中包含 "Admin" 的所有域群組

- **Get-NetGroupMember** / **Get-DomainGroupMember**：找出特定群組的所有成員
  - 範例：`Get-NetGroupMember -GroupName "Domain Admins"`
  - 可使用 `-Recurse` 參數遞歸查詢子群組成員：`Get-DomainGroupMember -Identity "Domain Admins" -Recurse`
  - 可指定域：`Get-DomainGroupMember -Identity "Enterprise Admins" -Domain domain.lab`

### 電腦相關命令

- **Get-NetComputer** / **Get-DomainComputer**：列出域中所有電腦
  - 對規劃橫向移動或識別可能易受攻擊的系統很重要
  - 可根據操作系統篩選：`Get-DomainComputer -OperatingSystem "*Server 2022*"`

### 域信任相關命令

- **Get-NetDomainTrust**：顯示當前域與其他域之間的信任關係
  - 特別適用於具有多個域的大型組織環境
  - 對於尋求擴大影響範圍到組織不同部分的攻擊非常重要

### 遠程主機會話命令

- **Get-NetSession**：識別遠程機器上的活動會話
  - 可找出特定用戶的登入位置，對於定位特定用戶帳戶很有用
  - 範例：`Get-NetSession -ComputerName TARGET_COMPUTER`

### 其他進階功能

- **Get-NetLocalGroup**：列出遠程電腦上的本地群組（需要管理員權限）
  - 範例：`Get-NetLocalGroup -ComputerName Computer1 -ListGroups`

- **Get-DomainGPO**：枚舉域群組策略對象
  - 範例：`Get-DomainGPO | select displayname`
  - 可針對特定電腦：`Get-DomainGPO -ComputerName WS01 | select displayname`

- **Convert-SidToName**：將安全標識符 (SID) 轉換為可讀名稱

# PowerUpSQL

## 基本概念

- **PowerUpSQL**（PowerShell SQL 伺服器攻擊工具）：一套 PowerShell 函數工具集，專為發現和利用 SQL Server 實例所設計
  - 主要功能包括：SQL Server 探索、弱配置審計、大規模權限提升和後滲透攻擊（如 OS 命令執行）
  - 主要用於內部滲透測試和紅隊演練，但也可作為系統管理員的資產盤點工具

## 功能分類

### 探索功能（Discovery）

- **Get-SQLInstanceLocal**：掃描本地網路尋找 SQL Server 實例
  - 用法：`Get-SQLInstanceLocal -Verbose`
  - 返回發現的所有 SQL Server 伺服器清單

- **Get-SQLInstanceDomain**：探索域中的 SQL Server 實例
  - 可與其他命令結合使用，如：`Get-SQLInstanceDomain | Get-SQLServerLoginDefaultPw -Verbose`

- **Get-SQLInstanceFile**：從文件載入已知的 SQL Server 實例
  - 用法：`Get-SQLInstanceFile -FilePath C:temp\instances.txt | Get-SQLConnectionTest -Verbose -Username test -Password test`
  - 適用於已有實例列表的情況，每行一個實例名稱

### 信息收集功能

- **Get-SQLServerInfo**：收集 SQL Server 實例的詳細信息
  - 用法：`Get-SQLServerInfo -InstanceName "SQLSERVER01"`
  - 提供伺服器配置的全面概述，包括版本、用戶和資料行等信息

- **Get-SQLServerLink**：識別與特定 SQL Server 相連結的伺服器
  - 用法：`Get-SQLServerLink -Instance "SQLSERVER01"`
  - 顯示所有連結到指定伺服器的其他伺服器，有助於規劃橫向移動策略

### 權限提升功能

- **Invoke-SQLEscalatePriv**：嘗試在 SQL Server 上提升權限
  - 用法：`Invoke-SQLEscalatePriv -Instance "SQLSERVER01" -Verbose`
  - 自動嘗試多種提權方法，如利用存儲過程或其他常見漏洞

### 憑證檢測功能

- **Get-SQLServerLoginDefaultPw**：檢查 SQL Server 是否使用預設密碼
  - 結合使用：`Get-SQLInstanceDomain | Get-SQLServerLoginDefaultPw -Verbose`
  - 檢查應用程式常用的預設密碼配置

### Active Directory 相關功能

- **Get-SQLDomainUser**：查詢域用戶信息，可根據特定狀態篩選
  - 用法：`Get-SQLDomainUser -UserState SmartCardRequired`（列出需要智慧卡的用戶）
  - 用法：`Get-SQLDomainUser -UserState TrustedForDelegation`（列出可委派的用戶）
  - 幫助識別潛在的高價值目標或應避免嘗試破解的帳戶

## 攻擊策略要點

- 優先識別並避免嘗試破解需要雙因素驗證（如智慧卡）的帳戶
- 尋找信任委派的帳戶，這些帳戶可以模擬其他用戶，有利於提權或橫向移動
- 利用伺服器連結進行橫向移動，從一個伺服器跳轉到另一個伺服器
- 自動化發現和評估過程可節省時間，提高發現漏洞的機率

# PowerShell 自動化 Active Directory 搜尋

- **Active Directory**：Windows 環境中的身分驗證和授權基礎架構
  - 是滲透測試重點目標，因為它保存了組織的身分驗證資料

- **PowerShell cmdlets（PowerShell 指令程式）**：與 AD 直接互動的專用命令
  - 允許查詢和操作 AD 物件，如使用者、群組和電腦
  - 對進行滲透測試的偵察階段非常重要

## 基本 AD 搜尋指令

- **Get-ADUser**：擷取 AD 使用者帳戶資訊的基本指令
  - 範例：`Get-ADUser -Filter * -SearchBase "OU=Sales, DC=Diontraining, DC=com"`
  - `-Filter *` 表示不過濾任何使用者
  - `-SearchBase` 指定目錄中搜尋的起始點

- **使用篩選條件搜尋**：
  - 範例：`Get-ADUser -Filter {Title -like "*Manager*"} -Properties Title`
  - 此指令會傳回標題中含有「Manager」的所有使用者

- **擷取額外屬性**：
  - 使用 `-Properties` 參數取得更多屬性資訊
  - 範例：`Get-ADUser -Filter * -Properties LastLogonDate | Where-Object { $_.LastLogonDate -eq $null }`
  - 此指令找出從未登入的使用者

## 進階自動化技巧

- **管道（Pipeline）運算符**：使用 `|` 將一個指令的輸出傳送至下一個指令
  - `$_` 代表管道中的每個物件（在上例中為使用者）

- **產生報告並匯出**：
  - 範例：
```
Get-ADGroupMember -Identity "Domain Admins" | 
Get-ADUser -Properties DisplayName, EmailAddress | 
Select-Object DisplayName, EmailAddress | 
Export-Csv -Path <路徑> -NoTypeInformation
```
  - 此腳本取得 Domain Admins 群組的所有成員名稱與電子郵件，並匯出至 CSV 檔案

- **迴圈處理多個組織單位**：
```
$OUs = Get-ADOrganizationalUnit -Filter *
foreach ($OU in $OUs) {
    Get-ADUser -Filter {Enabled -eq $false} -SearchBase $OU.DistinguishedName | 
    Select-Object Name, DistinguishedName
}
```
  - 此腳本遍歷每個 OU 並找出所有已停用的使用者帳戶

- **定期排程執行**：
  - PowerShell 腳本可排程定期執行
  - 適用於持續性監控任務，如識別長期未使用的帳戶
  - 可用於找出可能被攻擊者利用的帳戶

## 應用於滲透測試

- **CSV 檔案操作**：可從 CSV 檔案批次匯入資訊或將資訊匯出到 CSV
  - 範例：`Import-CSV 路徑\檔案.csv | ForEach-Object { ... }`

- **優點**：
  - 節省時間
  - 提高資訊收集的一致性和準確性
  - 增強識別與利用 AD 環境弱點的能力

# Impacket SMB 枚舉

- **Impacket Library**（Impacket Python 函式庫）：一個包含多種網路協議類別的集合，設計用於處理網路協議如乙太網路、IP、TCP等
  - 可用於進行網路層面的攻擊和安全檢測

- **SMB**（Server Message Block 伺服器訊息區塊協議）：常用於檔案共享和網路中機器之間的通訊
  - 在 Windows 和 Linux 系統上都有實現

- **Samba**（Samba）：SMB 協議在 Linux 系統上的實現
  - 允許 Linux 系統與 Windows 系統進行檔案和印表機共享

## SMB 枚舉腳本分析

- **導入函式庫**
  ```python
  from impacket.smbconnection import SMBConnection
  ```

- **建立 SMB 連接**
  ```python
  conn = SMBConnection(targetIP)
  ```
  - 初始化 SMB 連接物件，指定目標 IP 地址

- **使用 Guest 帳戶登入**
  ```python
  conn.login('guest', '')
  ```
  - 腳本假設目標伺服器允許以 guest 用戶無密碼登入
  - 這是一種常見的 SMB 伺服器安全設定錯誤

- **列舉共享資源**
  ```python
  shares = conn.listShares()
  ```
  - 檢索伺服器上的共享資源清單
  - 共享資源是網路中存儲和分享檔案的位置

- **處理枚舉結果**
  ```python
  for share in shares:
      print(f"Share Name: {share['shi1_netname'].strip()}")
      print(f"Comment: {share['shi1_remark'].strip()}")
  ```
  - 循環處理每個共享資源
  - 提取共享名稱和相關註釋/描述
  - 使用 strip() 函數移除前後空格

- **關閉連接**
  ```python
  conn.logoff()
  ```
  - 結束 SMB 會話

## 執行結果分析

- 執行命令：`sudo python3 smb_enum.py`

- **發現共享**：
  - **print**：印表機驅動程式共享
  - **另一個無註釋共享**
  - **IPC$**：IPC 服務共享

- **安全意義**：
  - 透過共享的註釋可能會發現有價值的情報
  - 管理員可能在註釋中留下敏感信息
  - 無需驗證即可访問的共享資源可能包含敏感數據

## 其他 SMB 枚舉方法

根據網路搜索結果，還有其他方法可進行 SMB 枚舉：

- **使用 PowerShell**：
  - `Get-SmbShare`：列出本機 SMB 共享
  - `get-WmiObject -class Win32_Share`：使用 WMI 列出共享

- **使用命令提示符**：
  - `net share`：列出本機共享
  - `net view \\computername /all`：查看遠端共享

- **使用圖形界面工具**：
  - 電腦管理
  - 檔案總管（`\\computername`）

# Scapy

- **Scapy**（Python 封包操作工具）：一種基於 Python 的封包操作工具和函式庫，允許使用者捕獲、偽造、解碼和分析網路封包
  - 廣泛應用於資安領域的封包製作、嗅探和網路探索
  - 需要使用 sudo 或提升權限才能操作底層協議封包

## ARP 掃描範例

- **ARP Scan**（ARP 掃描）：使用 ARP 請求來探測網路中的活躍裝置
  - 使用廣播方式發送 ARP 請求（Layer 2 運作）
  - 目標 MAC 地址設為全 F（FF:FF:FF:FF:FF:FF）代表廣播
  - 程式會返回網路上裝置的 IP 地址及對應的 MAC 地址

## TCP SYN Flood 攻擊範例

- **TCP SYN Flood Attack**（TCP SYN 泛洪攻擊）：一種阻斷服務攻擊技術
  - 通過連續發送大量 SYN 封包但不完成連線，消耗目標伺服器資源
  - 攻擊者發送 SYN 封包後不回應 ACK，使伺服器等待連線，耗盡資源
  - 在 Scapy 中，使用 TCP 協議的 flags='S' 設置來發送 SYN 封包

- **SYN Flood 攻擊類型**：
  - **Spoofed Attack**（偽造來源攻擊）：攻擊者偽造 IP 地址，使封包看似來自可信伺服器，難以追蹤和緩解
  - **Direct Attack**（直接攻擊）：使用真實 IP 地址的單一來源裝置執行攻擊

## 攻擊偵測

- **使用 Wireshark 偵測 SYN Flood 攻擊**：透過觀察異常大量的 SYN 封包但缺少完整 TCP 三向交握來識別攻擊
  - 正常 TCP 連線程序：客戶端發送 SYN → 伺服器回應 SYN-ACK → 客戶端回應 ACK
  - 攻擊特徵：缺少第三步 ACK 回應

## 實用提示

- 在真實滲透測試中，DoS 攻擊通常不在測試範圍內，除非特別指定用於測試低階環境
- 實際的 DoS 攻擊會發送數百萬甚至數十億封包，而不僅是演示中的 1000 個
- 實際攻擊通常結合多種攻擊向量和不同類型的封包，比單一 SYN Flood 更複雜

# Caldera

- **Caldera**：MITRE 開發的開源平台，專注於自動化對手模擬，建立在 MITRE ATT&CK 框架上
  - 用於自動化執行滲透測試和對手模擬
  - 能夠在受控環境中模擬真實攻擊
  - 具有模組化架構，通過「能力」(abilities) 組合形成複雜攻擊鏈
  - 可產生詳細日誌和報告，用於分析測試結果

- **BAS（Breach and Attack Simulation）**（入侵與攻擊模擬）：設計用來模仿攻擊者嘗試入侵網路並在內部橫向移動的動作
  - 幫助識別安全控制中的弱點，如缺少補丁、錯誤配置或監控不足
  - 目標是在真正攻擊者能夠利用漏洞前突顯這些漏洞
  - Caldera 通過允許創建和執行特定攻擊模式的場景來自動化此過程

- **Caldera 代理（Agents）**：負責按照 Caldera 伺服器指示執行模擬攻擊的組件
  - 部署在目標系統上
  - 自動執行攻擊步驟並向伺服器回報結果

- **攻擊模擬流程**：Caldera 能夠模擬完整的攻擊鏈
  - 獲取初始存取權限（例如模擬釣魚郵件）
  - 執行憑證傾印（使用 Mimikatz 等工具提取密碼和哈希值）
  - 嘗試橫向移動（使用竊取的憑證在網路內部移動）

- **Caldera 優勢**：
  - 能夠反覆運行模擬並在不同條件下測試
  - 可用於評估新安全控制措施的有效性
  - 自動化流程確保結果一致性
  - 能夠測量安全改進的影響
  - 可以模擬 MITRE ATT&CK 框架中的各種技術
  - 提供 JSON 格式的操作報告匯出功能

- **測試環境設置**：使用 Caldera 時，通常從設置一個鏡像目標網路的虛擬環境開始
  - 在此環境中部署 Caldera 代理
  - 可以根據 MITRE ATT&CK 框架建立特定的攻擊腳本

- **測試價值**：
  - 優化滲透測試工作流
  - 讓測試人員專注於分析結果
  - 通過識別和解決安全防禦中的關鍵漏洞為客戶提供更多價值
  - 可用於紅隊自動化測試

# Infection Monkey

- **Infection Monkey**：一個開源的對抗模擬平台，通過模擬真實攻擊來幫助組織提升安全防禦能力
  - 被稱為網路的"惡意軟體疫苗"，以安全可控的方式模擬真實攻擊
  - 開源工具，可免費使用進行漏洞測試
  - 用於評估數據中心對於周邊突破和內部伺服器感染的彈性

- **Infection Monkey 架構組成**：
  - **Monkey Agent**：類似網路蠕蟲的二進制程序
    - 在本地網路中進行掃描、傳播和模擬攻擊技術
    - 可配置為像真實惡意軟體一樣在網路中傳播、竊取數據和傳遞有效負載
    - 完全可配置，可模擬勒索軟體、蠕蟲等不同類型的惡意軟體
  
  - **Monkey Island Server**：命令與控制（C&C）服務器
    - 提供圖形用戶界面(GUI)
    - 控制模擬攻擊的執行
    - 監控代理在網路中的移動
    - 收集和展示模擬過程的所有信息
    - 生成關於攻擊路徑和漏洞的詳細報告

- **Adversary Emulation**（對手模擬）：使用真實攻擊者的戰術、技術和程序(TTPs)來測試防禦能力
  - 傳統上由人工執行，成本高且需要額外資源
  - Infection Monkey 提供自動化的對手模擬能力

- **工作原理**：
  - 類似生物疫苗原理，使用弱化版的"病毒"來幫助網路建立"免疫力"
  - 通過配置代理模擬特定類型的惡意軟體行為
  - 釋放代理到網路中進行漏洞利用、弱密碼測試等攻擊行為
  - Monkey Island 監控整個過程，展示感染如何傳播、哪些系統受到影響
  - 提供對防禦機制效能的可視化評估

- **安全控制評估**：
  - 評估防火牆、入侵檢測系統、端點保護等安全控制的有效性
  - 識別需要更新的安全工具、政策或流程
  - 幫助組織了解攻擊者和自身防禦能力

- **利用方式**：
  - 可根據需要定期執行，甚至每天運行
  - 適合動態變化的環境，作為持續測試解決方案驗證網路的安全基線
  - 幫助組織為真實威脅做好準備

- **主要優勢**：
  - 提供網路"免疫訓練"，增強面對真實攻擊的應對能力
  - 發現並修補安全漏洞，減少被攻擊的風險
  - 通過實證數據幫助改善安全狀況
  - 提供從攻擊者視角看待內部網路的視野

# Atomic Red Team

- **Atomic Red Team**（原子紅隊）：一個開源工具，用於模擬真實世界的攻擊來測試安全防禦機制
  - 基於 MITRE ATT&CK 框架設計
  - 提供小型且專注的測試（稱為「原子測試」），不需大量設置或專業知識

- **MITRE ATT&CK Framework**（MITRE ATT&CK 框架）：攻擊者使用的戰術和技術的綜合列表
  - Atomic Red Team 將這些技術分解為可單獨執行的測試
  - 每個測試對應特定的攻擊技術

- **Atomic Test**（原子測試）：小型且專注的安全測試
  - 設計用來測試特定技術，如權限提升、橫向移動或數據竊取
  - 執行簡單，通常只需一個命令即可運行
  - 適用於各種專業程度的安全人員

## 實際應用範例

- **T1003.001**（LSASS 記憶體憑證傾印）：模擬攻擊者從記憶體中提取憑證的技術
  - 執行指令：`Invoke-AtomicTest T1003.001 -TestNumbers 1`
  - 該技術在多個威脅組織中被觀察到
  - 常用工具包括：Mimikatz、Cobalt Strike

- **T1059.001**（PowerShell 執行）：測試利用 PowerShell 執行惡意指令的防禦能力
  - 執行指令：`Invoke-AtomicTest T1059.001 -TestNumbers 2`
  - PowerShell 是 Windows 操作系統中功能強大的交互式命令行界面和腳本環境
  - 攻擊者可使用 PowerShell 執行多種操作，如信息收集和代碼執行
  - 相關工具包括 Empire、PowerSploit、PoshC2 和 PSAttack

- **T1053.005**（排程任務持久性）：模擬攻擊者使用排程任務來維持網路存取
  - 執行指令：`Invoke-AtomicTest T1053.005 -TestNumbers 1`
  - 測試創建可能被攻擊者用來維持網路訪問的排程任務

## 工具優勢

- **簡易性**：不需要複雜的基礎設施或自定義腳本
- **即時結果**：執行測試後可立即查看結果
- **針對性測試**：可針對特定安全控制進行驗證
- **廣泛適用性**：從安全測試初學者到經驗豐富的滲透測試人員皆可使用
