# 事件應變流程（Incident Response）

## 主要概念

- **Incident Response Process**（資安事件應變流程）：組織用來管理和緩解安全事件的系統性方法
  - 目標是最小化安全漏洞的影響，縮短識別和控制威脅的時間，並促進快速恢復正常運作
  - 應用範圍包括網路攻擊、資料外洩、系統漏洞和未授權存取等安全事件
  - 完善的應變計劃對組織維持韌性、保護數位資產和聲譽至關重要

## 資安事件應變階段

- **Incident Response Process Steps**（事件應變流程步驟）：事件應變的關鍵階段
  - 準備階段（Preparation）
  - 偵測與分析階段（Detection and Analysis）
  - 圍堵階段（Containment）
  - 根除階段（Eradication）
  - 復原階段（Recovery）
  - 經驗學習階段（Lessons Learned）

## 事件應變相關活動

- **Threat Hunting**（威脅狩獵）：主動式資安方法，持續搜尋和識別組織網路和系統中隱藏或新興的威脅
  - 屬於積極性、前瞻性的安全措施

- **Root Cause Analysis**（根本原因分析、根因分析）：系統性流程，用於調查事件並識別導致安全漏洞或操作問題的潛在因素
  - 協助找出問題的真正來源，而非只處理表面症狀

- **Incident Response Training and Testing**（事件應變訓練與測試）：透過各種演練準備人員和系統有效應對安全事件
  - 包括桌面演練（Table Talk Exercises）
  - 模擬演練（Simulations）
  - 實戰演習（Drills）
  - 實驗室練習（Lab Exercises）

## 數位鑑識與證據收集

- **Digital Forensic Procedures**（數位鑑識程序）：用於收集、分析和保存數位證據的系統性技術和方法
  - 適用於網路犯罪或安全事件的調查工作

- **Data Collection Procedures**（資料收集程序）：收集事件應變相關資訊和證據的既定方法
  - 包括考量資料的揮發性順序（Order of Volatility）

- **Disk Imaging and Analysis**（磁碟映像與分析）：建立儲存裝置或磁碟的逐位元複製，並檢查其內容
  - 用於資料恢復、事件調查或識別安全問題

## 資源與組織

- **FIRST (Forum of Incident Response and Security Teams)**（事件應變與安全團隊論壇）：由 NIST 於 1990 年成立的組織
  - 舉辦研討會和會議，促進合作來預防事件和快速應變
  - 提供專家交流資訊的平台

- **Computer Incident Response Teams (CERTs)**（電腦事件應變小組）：國家級組織，保護政府和關鍵基礎設施
  - 美國的 US-CERT 隸屬於國土安全部
  - 提供資安相關建議與支援

## 應變工具與架構

- **Intrusion Detection Systems (IDS)**（入侵偵測系統）：用於監控網路流量和識別可疑活動的工具

- **Security Information Event Management (SIEM)**（安全資訊與事件管理）：集中管理和分析來自各種安全系統的日誌和警報的平台

- **NIST Cybersecurity Framework**（NIST 網路安全框架）：可用於分析資安事件並整合到整體安全策略中的架構

# 資安事件回應流程

## 基本概念定義

- **Incident**（事件）：違反明確或隱含的安全政策之行為。
  - 常見類型包括：使用竊取的密碼登入他人帳號、安裝惡意軟體等。
  - 任何違反組織安全政策的行為皆可視為安全事件。

## 事件回應流程模型

- **NIST Computer Security Incident Handling Guide**（NIST 電腦安全事件處理指南）：特別出版物編號 800-61，定義了四階段事件回應流程。
  - 此為業界最常用的標準之一
  - 包含四個階段：準備、偵測與分析、遏制/根除/復原、事後活動。
  - 此流程非嚴格線性，通常會在各階段間循環。

## 七階段事件回應流程詳解

1. **Preparation**（準備）：
   - 強化系統與網路，提高對攻擊的韌性。
   - 建立政策和程序。
   - 制定加密的帶外通訊路徑。
   - 進行模擬事件訓練與測試。
   - 準備事件回應工具包。

2. **Detection**（偵測）：
   - 確定是否發生安全事件。
   - 資安和分類分析師對潛在事件進行分類與評估嚴重程度。

3. **Analysis**（分析）：
   - 徹底檢查與評估事件。
   - 了解事件範圍與影響。
   - 通知相關利害關係人。
   - 啟動遏制階段並實施必要的初始回應行動。

4. **Containment**（遏制）：
   - 限制事件範圍與規模。
   - 保護資料，減小對業務運作的影響。
   - 例如：隔離受感染系統，防止惡意軟體擴散。

5. **Eradication**（根除）：
   - 在事件遏制後，移除系統或網路中的惡意活動。
   - 例如：刪除惡意軟體或重新安裝已知乾淨的映像檔。

6. **Recovery**（復原）：
   - 將受影響的系統與服務恢復至正常安全狀態。
   - 通常涉及：從已知乾淨的備份還原、安裝安全修補程式、更新設定。
   - 監控系統，確保沒有殘餘威脅。
   - 目標是減少事件影響，讓組織恢復正常運作。

7. **Post-incident Activity**（事後活動/經驗教訓）：
   - 在系統完全復原後進行。
   - 包含三個主要行動：
     - **Root Cause Analysis**（根本原因分析）：四步驟流程
       1. 定義/確定事件範圍
       2. 確定導致事件的因果關係
       3. 找出有效解決方案
       4. 實施並追蹤解決方案，確保事件完全解決
     - **Lessons Learned Process**（經驗教訓流程）：
       - 記錄事件經驗，評估成功與失敗之處
       - 確定可改進的流程，避免同樣問題再次發生
     - **After-action Report**（事後行動報告）：
       - 正式記錄事件發生經過
       - 包含根本原因分析和改進建議
       - 報告格式依組織需求可能詳細技術性或僅提供執行摘要

## 事件回應團隊

- **Incident Response Team**（事件回應團隊）：
  - 核心成員為具備事件回應經驗的資安專業人員。
  - 依事件類型臨時加入特定專業人員（如資料庫管理員）。
  - 大型組織通常有專職團隊，小型組織則由現有人員兼任。
  - 團隊組成：
    - 領導者（熟練的事件回應者）
    - 主題專家
    - IT 支援人員
    - 法律顧問
    - 人力資源與公關人員

- **管理層職責**：
  - 確保團隊獲得必要的資金、資源與專業知識。
  - 在事件回應期間做出關鍵業務決策。
  - 向關鍵利害關係人或媒體進行適當溝通。

- **外包事件回應**：
  - 優點：專業團隊專注於事件回應。
  - 缺點：成本高，且外部組織不熟悉企業網路環境。

## 事件回應要點

- 事件回應過程通常緊張且壓力大，可能需要長時間工作。
- 主要目標：遏制問題、減輕威脅、迅速恢復組織正常運作。
- 關鍵步驟：偵測事件、回應威脅、收集證據、遏制問題、還原網路功能、加強安全防護防止再次感染。

# 資安威脅狩獵

- **Threat Hunting**（威脅狩獵）：一種主動性的網路安全技術，旨在偵測那些尚未被常規安全監控發現的潛在威脅
  - 強調主動防禦而非被動反應（與事件應變相比）
  - 不等待攻擊或利用發生，而是主動在網路中尋找威脅
  - 專注於分析組織擁有和運作的系統數據

## 威脅狩獵流程

- **Hypothesis Establishment**（假設建立）：威脅狩獵的第一步
  - 通過威脅建模確定最有可能並具最高影響力的潛在事件
  - 思考「誰可能想傷害我們？」、「誰可能試圖入侵我們的網路？」以及「他們可能如何做到？」
  - 將威脅建模與威脅情報結合，創建關於可能攻擊和威脅行為者的假設

- **Threat Actor Profiling**（威脅行為者分析）：建立攻擊者可能的入侵方式和目標的情境
  - 考量他們可能使用的戰術、技術和程序（TTPs）
  - 確定威脅來源：內部威脅、駭客主義者、犯罪組織或國家級APT（進階持續性威脅）
  - 評估他們的目標及可能針對的系統

- **Hunting Execution**（狩獵執行）：在網路中進行威脅狩獵
  - 使用常規安全監控和事件應變的工具進行
  - 分析日誌、進程資訊、檔案系統和註冊表，特別關注最近的變化
  - 通常透過安全資訊和事件管理系統（SIEM）整合和關聯數據

## 威脅狩獵特性

- **Assumption of Failure**（失敗假設）：威脅狩獵與常規監控的主要區別
  - 假設現有規則未能對惡意或可疑活動發出警報
  - 常規感測器善於偵測已知有簽章的威脅，而威脅狩獵尋找沒有簽章的新威脅
  - 威脅行為者會隨著其戰術被廣為人知而改變策略，以避免被偵測

- **Advisory and Bulletins**（資安通告和公告）：由廠商和安全研究人員發佈
  - 在發現新的戰術、技術、程序（TTPs）和漏洞時發布
  - 初期可能尚未有保護套件中的簽章可用
  - 作為威脅狩獵的重要情報來源

- **Intelligence Fusion and Threat Data**（情報融合和威脅數據）：威脅狩獵的工具
  - 結合SIEM和威脅分析平台，有效識別關注項目
  - 利用其他安全研究人員觀察到的真實世界威脅
  - 通常以TTP或IoC（妥協指標）威脅數據源的形式提供
  - 將這些威脅數據與SIEM結合，識別自身網路中可疑活動

## 威脅狩獵實例

- **案例分析**：針對新型惡意軟體的威脅狩獵流程
  - 1. 接收情報：新型惡意軟體感染多家公司的Windows桌面
  - 2. 分析網路流量：檢查是否有向可疑域名或C2伺服器的流量
  - 3. 識別可能受感染的主機：列出需要進一步調查的主機
  - 4. 分析執行程序：檢查哪些程序和服務正在執行並建立網路連線
  - 5. 評估連線的合法性：判斷是正常連線還是可疑活動
  - 6. 分析多個受感染主機：尋找共同點，如是否執行相同的惡意程序
  - 7. 識別惡意程序的執行方法：確定其啟動方式，尋找阻止攻擊途徑的方法
  - 8. 制定防護策略：例如應用白名單（允許列表）或對脆弱應用程式實施黑名單（拒絕列表）

## 威脅狩獵的效益

- **改善偵測能力**：威脅獵人發現攻擊者如何繞過偵測系統
  - 重寫規則集和偵測演算法，提高偵測精確度
  - 防止未來利用
  - 消耗大量資源和時間，但提供顯著效益

- **威脅情報整合**：將外部威脅情報與內部日誌和其他來源結合
  - 產生可行的情報
  - 提高組織整體安全態勢

# 根因分析

- **Root Cause Analysis（根因分析）**：一種系統性流程，用以識別事件的初始來源，並防止其再次發生。
  - 根因分析是透過四步驟進行：
    1. 定義事件範圍
    2. 確定導致事件的因果關係
    3. 識別有效解決方案
    4. 實施並追蹤解決方案，確保事件完全解決

- **No-Blame Approach（無責備方法）**：根因分析過程採用不指責個人或團隊的方法。
  - 主要目標是識別事件的根本原因，並開發有效的預防措施
  - 無責備方法能鼓勵開放與誠實的報告，對改善組織內的資安實踐至關重要
  - 能促進協作、透明度，並專注於解決方案而非歸咎責任

## 根因分析案例：惡意軟體感染

- **惡意軟體感染案例分析**：
  - 初始感染原因可能是：
    - 插入受感染的 USB 隨身碟
    - 點擊魚叉式網路釣魚郵件中的連結
    - 訪問惡意網站
  
- **可能的解決方案**：
  - 確保工作站安裝最新版本的防毒軟體
  - 禁止從 USB 裝置傳輸資料
  - 更新作業系統版本
  - 安裝相關安全性修補程式

- **解決方案實施與追蹤**：
  - 通過變更管理流程指示系統管理員安裝註冊表變更，防止讀取 USB 裝置
  - 納入資產管理和變更管理流程，更新作業系統和安全修補程式
  - 擴大檢視範圍，評估網路中其他可能受影響的系統

## 實際案例：波音 737 MAX 空難調查

- **NTSB（美國國家運輸安全委員會）調查方法**：
  - 進行獨立、無責備的根因分析，主要目標是確定問題所在及原因
  - 調查通常全面、獨立且涉及多個領域的專家
  - 分析整個事件鏈，包括天氣資料、飛機維護記錄、通訊記錄和駕駛艙語音記錄

- **波音 737 MAX 空難根因**：
  - 2018 年和 2019 年的兩起空難由飛機新飛行控制軟體問題導致
  - 缺陷性感應器造成 MCAS（機動特性增強系統）重複將飛機機頭下壓
  - 這奪走了飛行員的控制權，導致飛機墜毀

- **監管機構反應**：
  - NTSB 和各國監管機構迅速停飛近 400 架運營中的波音 737 MAX
  - 對缺陷飛行控制軟體進行逐行審查，確保無其他可能導致未來事故的漏洞

## 資安根因分析的價值

- **根因分析的關鍵價值**：
  - 識別漏洞或安全實踐中的弱點
  - 創建更強大的網路威脅防護措施
  - 鼓勵開放與誠實的事件報告文化
  - 防止類似事件再次發生

# 資安事件應變訓練與測試

## 訓練與測試概念

- **Incident Response Training（資安事件應變訓練）**：確保員工了解事件應變過程、程序和優先事項的教育過程。
  - 目的是確保人員在發生事件時能夠準備好進行應變。
  - 應根據不同角色提供相關視角和重點的訓練。
  - 訓練內容應包含過往事件的經驗教訓。
  - 除了技術技能外，也需包含軟技能和團隊關係建立。

- **Incident Response Testing（資安事件應變測試）**：事件應變程序的實際演練。
  - 訓練是教導「做什麼」，測試是確認「如何做」。
  - 通常會模擬重大事件，但成本可能較高。
  - 測試可幫助確認人員真正能夠執行所學的技能。

## 訓練對象與內容

- **First Responders（第一線應變人員）**：需要技術能力的訓練
  - 如何重新建立機器映像
  - 如何移除惡意軟體
  - 如何變更組態設定

- **Managers and Executives（管理者與高層）**：
  - 風險與報酬的權衡
  - 管理決策制定
  - 組織內外的溝通（含執法單位和媒體）

- **End Users（一般使用者）**：
  - 如何通報可疑事件
  - 如何識別釣魚攻擊
  - 如何預防事件發生

## 測試方法

- **Tabletop Exercise（桌面演練，TTX）**：使用事件應變情境對照控制框架或紅隊進行的演練。
  - 專家圍繞桌面提出情境並討論應對方式
  - 優點：成本較低
  - 缺點：缺乏實際操作經驗，較為理論化
  - 可分為紅隊（攻擊者）和藍隊（防禦者）進行角色扮演式討論

- **Penetration Test（滲透測試）**：
  - 紅隊根據威脅模型的特定情境嘗試入侵網路
  - 必須事先約定明確的方法論和規則
  - 常見工具和作業系統：Metasploit、Cobalt Strike、Kali Linux、ParrotOS、Commando OS
  - 在網路上發現這些工具時應提高警覺，可能是滲透測試或真實攻擊

- **Simulation Exercise（模擬演練）**：
  - 超越理論討論，包含逼真的情境和動手操作
  - 涵蓋從簡單的釣魚攻擊到複雜的多階段攻擊
  - 評估技術技能、壓力下的決策能力和有效溝通
  - 應與組織的威脅環境和風險狀況保持一致
  - 有助於識別事件應變計畫中的缺口
  - 改善團隊間協調並確保角色清晰

## 三者關係總結

- **Training（訓練）**：教育過程，提供員工理解和有效應對事件所需的知識和技能。
- **Testing（測試）**：實際演練，評估個人或團隊執行事件應變程序的能力。
- **Simulation（模擬）**：逼真的動手演練，複製實際事件應變情境，全面評估團隊能力和決策技巧。

# 數位鑑識程序與原則

## 數位鑑識基礎

- **Digital Forensics**（數位鑑識）：系統性調查和分析數位裝置與資料的過程，目的是發現法律用途的證據，通常用於刑事調查或法律爭議。
  - 必須遵循組織的明確書面程序，確保鑑識工作正確、有效且符合法規要求。

## 數位鑑識四大階段

- **Identification**（識別階段）：確保現場安全，防止證據污染，並確定需收集證據的範圍。
  - 首要任務是確保人員安全，並對現場進行保護。
  - 使用錄影或照片記錄犯罪現場狀態。
  - 確定相關資料可能儲存的位置（例如平板電腦、智慧型手機、智慧型電視或伺服器）。

- **Collection**（收集階段）：在確定所需資訊後開始收集證據。
  - 必須取得適當授權（如執法單位需要法官簽署的搜索令，企業內部調查需要高階主管授權）。
  - 遵循正確的取證程序，包括遵守揮發性順序及維持證據監管鏈。

- **Analysis**（分析階段）：使用可重複的方法和工具檢驗證據。
  - 系統性地檢查資料以發現相關資訊（如犯罪活動跡象、隱藏檔案、時間戳記和使用者互動）。
  - 遵循嚴格程序和文件協議，確保發現結果的一致性和客觀性。

- **Reporting**（報告階段）：呈現調查分析結果。
  - 文件需描述使用的方法和工具、調查過程中執行的操作、詳細發現以及最終結論。
  - 此報告在法律訴訟中作為關鍵證據，分析師必須準備在法庭上對其發現作證。

## 重要鑑識概念

- **Order of Volatility**（揮發性順序）：數位鑑識中決定資料來源收集和保存順序的系統方法，基於資料被修改或遺失的可能性。
  - 從最易揮發的資源開始收集，逐步處理較不易揮發的資源，以減少資料遺失。
  - 根據NIST特別出版物800-86的典型揮發性順序：
    1. 系統記憶體資料（處理器快取和系統RAM）
    2. 系統狀態資料（系統和網路配置、活動使用者工作階段）
    3. 儲存裝置資料（硬碟、固態硬碟等非揮發性儲存裝置）
    4. 網路流量和日誌
    5. 遠端儲存的存檔資料（備份、雲端儲存、外部裝置及列印輸出）

- **Chain of Custody**（證據監管鏈）：記錄並可驗證的文件，追蹤數位證據從收集到呈現於法庭的處理、轉移和保存過程。
  - 維持安全且不間斷的監管鏈對證明證據的完整性和可接受性至關重要。
  - 每次有人處理證據時，都必須仔細記錄其行動和任何監管狀態的變更。
  - 詳細記錄確保證據未受污染，能經得起法律程序中的審查。

- **Disk Imaging**（磁碟映像）：建立儲存裝置的逐位或邏輯複製，保存其全部內容，包括已刪除檔案和未分配空間。
  - 確保原始資料不被更動，讓鑑識分析師能使用裝置的精確副本進行分析。

- **File Carving**（檔案切削）：不依賴檔案系統從儲存媒體提取檔案和資料片段的技術。
  - 當檔案元資料遺失或損壞時特別有用。

- **Legal Hold**（法律保全）：當訴訟合理預期發生時，組織實施的正式通知，指示員工保留所有潛在相關的電子資料、文件和記錄。
  - 確保沒有證據被竄改、刪除或遺失，任何相關資料的更改或銷毀可能導致嚴重法律後果。

- **Preservation**（保存）：採取主動措施維護和保護電子證據的原始狀態，包括確保資料不被覆寫、刪除或意外修改。
  - 保存措施可能包括備份電子記錄、隔離關鍵系統及實施存取控制以防止未授權的更改。

- **E-discovery**（電子證據開示）：識別、收集和產生電子儲存資訊用於潛在法律程序的過程。
  - 涉及搜尋大量電子資料以找出相關證據，分析並以適合訴訟的格式呈現。
  - 用於有效篩選電子郵件、文件、資料庫和其他數位記錄的工具和技術。

## 道德考量

- 數位鑑識分析師必須遵守強調三項關鍵原則的道德規範：
  1. **避免偏見**：分析必須不帶任何偏見或偏見，結論應僅基於分析中的證據。
     - 調查不應基於個人特徵（如種族、信仰、國籍、性取向、政治信仰等）。
     - 最佳做法是使用與情況完全無關的鑑識分析師，以避免潛在偏見。
  
  2. **可重複行動**：所有分析必須使用其他人能執行並獲得完全相同結果的可重複流程。
     - 在最終報告中記錄所有行動的重要性。
     - 適當的方法記錄確保他人使用相同技術能重現相同結果。
  
  3. **證據保存**：收集的任何證據不應被更改或操縱。
     - 包括裝置本身（如筆記型電腦的硬碟）及從該裝置恢復的檔案或資料。
     - 應先對驅動器進行映像，然後在磁碟映像上進行分析，而非在原始驅動器上直接操作。

## 數位鑑識實踐要點

- **法律聯絡人**：組織應指派具法律知識和專業知識的聯絡人，促進與執法和鑑識團隊的溝通與合作。
  - 此聯絡人通常是律師或與組織內部法律顧問合作，確保組織遵守法律規定。

- **證據收集與分析**：可能使用分工模式，如一組人員（數位媒體收集員）負責收集資訊，另一組人（數位鑑識檢查員）負責分析。
  - 此模式有助於消除偏見，因為分析師僅依賴資料，不知道受害者或攻擊者的身分或案件其他細節。

- **報告格式建議**：詳細記錄時間、採取的行動和這些行動的結果。
  - 例如：「2024年2月2日10:23，我在Windows 10系統的命令提示字元輸入『netstat -ano』指令。我獲得該機器上活動網路連接的列表，並注意到連接到可能惡意伺服器，IP位址為66.55.44.33。」
  - 納入螢幕截圖等視覺證據。

## 結論

- 遵循正確的程序對於確保證據在法庭上的可接受性至關重要。
- 若偏離這些道德標準和程序，優秀的辯護律師可能使您的發現在法庭上失去可信度。
- 始終遵循適當的程序收集和分析證據，即使您的工作在法律程序中受到嚴格審查，也能維護正義。

# 資安事件回應之資料蒐集程序

- **Data Collection Procedures**（資料蒐集程序）：在資安事件回應中用於蒐集網路攻擊證據的流程
   - 目的是為了後續分析及同時快速恢復系統運作

- **Digital Forensic Collection Techniques**（數位鑑識蒐集技術）：用於製作伺服器資料鑑識映像的技術
   - 允許將系統快速恢復線上狀態的同時保留攻擊證據
   - 有助於與執法單位合作進行刑事訴訟

- **System Images**（系統映像檔）：系統硬碟的完整複本
   - 使用 FTK Imager 等工具製作硬碟的精確副本
   - 透過雜湊值（hash）來確保分析過程中資料未被更改

- **Forensic Tools**（鑑識工具）：協助分析蒐集資料的軟體
   - 包括 FTK（Forensic Toolkit）和 EnCase 等專業鑑識工具

- **Order of Volatility**（揮發性順序）：根據資料易於變更的速度決定蒐集的優先順序
   - 處理器快取（最快變更）→ 記憶體 → 交換檔 → 硬碟
   - 蒐集證據時需依此順序進行，先蒐集最易變更的資料

- **Data Acquisition**（資料獲取）：用來建立來源裝置（如系統記憶體或硬碟）的鑑識副本的方法和工具
   - 在進行資料獲取前應確認是否有合法搜索或扣押的權利
   - 自攜裝置（BYOD）政策可能使證據蒐集變得複雜，因裝置所有權不屬於公司

- **Volatile Memory**（揮發性記憶體）：關機後會消失的資料，包括：
   - CPU 暫存器和快取記憶體（最高揮發性）
   - 系統記憶體、路由表格、ARP 快取、程序表格、暫存交換檔

- **Persistent Mass Storage**（持久性大容量儲存裝置）：斷電後仍能保留資料的裝置
   - 包括硬碟、固態硬碟、快閃磁碟機等
   - 較揮發性記憶體穩定，但系統運作時仍會持續改變

- **Windows Registry**（Windows 登錄檔）：特殊的資料儲存區
   - 某些部分如 HKLM\Hardware 元件僅存在於記憶體中
   - 透過記憶體轉儲（memory dump）分析較為完整
   - \Hardware 登錄檔可記錄所有曾連接或移除的儲存裝置

- **Evidence Collection Hierarchy**（證據蒐集階層）：依揮發性順序蒐集
   1. CPU 暫存器和快取記憶體（最高優先）
   2. 揮發性記憶體（系統記憶體、路由表等）
   3. 持久性儲存裝置（硬碟、SSD）
   4. 遠端記錄資料（SIEM 和監控資料）
   5. 實體配置和網路拓撲
   6. 封存媒體（備份磁帶、異地儲存）

- **Forensically Sound Copy**（鑑識完整副本）：確保蒐集的資料在程序上不受污染且可作為證據使用
   - 依照文件化的流程和程序進行
   - 避免污染或遺失可能的網路攻擊證據

# DD 磁碟映像建立技術

## 基本概念

- **DD**（磁碟複製）：一種在 Linux/Unix/Mac 系統中用於建立低階磁碟或裝置影像的指令
  - 可建立完整的逐位元複製，保留原始資料的所有特性，包括已刪除檔案和未配置空間

## 磁碟映像建立流程 (Linux 方式)

- **連接存證裝置**：
  - 理想情況下應透過**Write Blocker**（寫入阻擋器）連接
  - 寫入阻擋器能防止任何寫入操作，確保原始資料不被修改

- **識別裝置**：
  - 使用 `fdisk -l` 列出所有連接裝置及其分割區
  - 範例：`/dev/sdb`（整個磁碟）和 `/dev/sdb1`（第一分割區）

- **選擇映像目標**：
  - 整個磁碟 vs. 單一分割區
  - 選擇整個磁碟（如 `/dev/sdb`）可獲取分割區內外的所有資料，包括可能隱藏在未分配空間的資料

- **執行 DD 命令**：
  - 語法：`dd bs=64k if=/dev/sdb of=usb2gb.dd`
  - 參數說明：
    - `bs=64k`：區塊大小為 64KB
    - `if=/dev/sdb`：輸入檔案（來源裝置）
    - `of=usb2gb.dd`：輸出檔案（目標映像檔）
  - 複製時間：約每 GB 需 30 秒（視系統速度而定）

- **建立雜湊值**：
  - 使用 `md5sum usb2gb.dd` 產生 MD5 雜湊
  - 也應使用 SHA-1 或 SHA-256（因 MD5 目前被視為較弱）
  - 雜湊值是證據監管鏈的重要部分

## FTK Imager 建立映像方法 (Windows 方式)

- **開啟 FTK Imager**：
  - 需要管理員權限執行

- **建立映像檔**：
  - 路徑：File → Create Disk Image
  - 選擇來源類型：Physical Drive（實體裝置）
  - 選擇正確的裝置（注意識別目標 USB 裝置）

- **選擇映像格式**：
  - 建議選擇 Raw DD 格式，具有最廣泛的相容性
  - 其他選項：E01（EnCase 格式）、AFF（FTK 格式）

- **填寫取證資訊**：
  - 案件編號、證據編號
  - 裝置描述
  - 調查員資料
  - 其他相關筆記

- **設定儲存位置**：
  - 選擇映像檔儲存路徑和檔名

- **映像建立與驗證**：
  - 選擇建立後驗證映像（自動產生雜湊值）
  - 映像檔可能會被分割為多個檔案（預設每 1.5GB 一個）
  - 系統會生成包含映像資訊和雜湊值的文字檔

## 映像檔分析

- **使用 FTK Imager 開啟映像檔**：
  - File → Add Evidence Item → Image File
  - 選擇第一個分割檔案（.001）

- **檢視可恢復的資料**：
  - 可檢視已分配和未分配空間
  - 可恢復已刪除檔案（標有 X 的檔案）
  - 可使用「最近修改日期」找出可疑活動

- **Chain of Custody**（證據監管鏈）：
  - 建立映像檔後會產生摘要文件，包含：
    - 裝置資訊和序號
    - 計算的雜湊值與報告的雜湊值
    - 驗證結果
  - 這些資料作為證據監管鏈的一部分非常重要
 