# 安全強化（Hardening）

- **Hardening**（安全強化）：指透過實施一系列措施和配置來增強系統、應用程式或網路的安全性，減少其暴露於漏洞和潛在威脅的過程。
  - 常見強化措施包括：應用安全性修補程式、配置存取控制、停用不必要的服務，以及採用最佳實踐來加強整體安全態勢並增強對網路攻擊的防禦能力

- **Default Configurations**（預設配置）：系統、應用程式或設備初始安裝時的原始設定值。
  - 需要修改的預設配置包括：預設密碼、預設開放埠和協定，以及其他不安全的預設設定

- **Application Restriction**（應用程式限制）：一種安全方法，其中只有明確批准或白名單中的應用程式才能在系統或網路上執行，而其他應用程式預設會被阻擋。
  - 這種主動措施確保只有受信任和授權的軟體可以執行
  - 可最小化惡意軟體或未授權程式危害系統安全的風險

- **Unnecessary Services**（不必要的服務）：指在電腦或網路上運行但非系統基本功能或業務運營所必須的軟體程序或網路服務。
  - 這些服務可能消耗系統資源
  - 可能引入安全漏洞
  - 會增加攻擊面，使系統更容易受到網路攻擊

- **Trusted Operating Systems**（可信任作業系統）：經過嚴格安全評估和認證以確保其可信度和處理敏感或機密信息可靠性的專用作業系統。
  - 這些作業系統設計時具有嚴格的安全控制和存取限制
  - 可保護系統免於未授權存取、資料外洩和其他安全威脅

- **Updates**（更新）：由開發人員發布的軟體修改或改進，用於增強功能、修復錯誤或改善軟體的安全性、穩定性和效能。

- **Patches**（修補程式）：特定的軟體更新，旨在解決程式、系統或應用程式中已識別的漏洞或安全問題。

- **Patch Management**（修補程式管理）：識別、測試、部署和監控軟體修補程式和更新的系統化流程，以維持電腦系統的安全性和功能性。
  - 系統修補程式管理是作業系統中的標準部分，通常內建於系統排程和自動化功能中

- **Group Policies**（群組原則）：Windows 環境中的一組規則和配置，允許管理員集中管理和控制使用者和電腦設定，確保符合操作標準並維護安全性。

- **SE Linux**（Security-Enhanced Linux，安全強化版 Linux）：Linux 作業系統的安全框架，實施強制存取控制以限制程序和使用者的行為，增強系統整體安全性。
  - 強化 Linux/Unix 系統是確保安全性和防禦的關鍵步驟，可減少攻擊的可能性

- **Data Encryption**（資料加密）：將資料轉換為密碼以防止未授權存取的過程。
  - 加密可以在不同層級實施：完整磁碟層級、分區層級、檔案層級、磁碟區層級、資料庫層級或記錄層級

- **Secure Baseline**（安全基準）：為電腦系統、應用程式或網路預先定義的標準化配置及其相關設定，建立一個安全的起點以最小化安全風險和漏洞。
  - 安全基準的實踐包括：採用最佳加密、強密碼和安全工具，配置使用者驗證和授權機制，以及使用更新且經過修補的作業系統

# 變更預設設定

- **Default Configurations**（預設設定）：硬體或軟體安裝時的原廠設定
  - 這些設定通常不是以安全性為優先考量，而是為了讓新使用者能更快速地安裝和使用
  - 若不變更這些預設設定，將對系統造成重大安全風險，可能被惡意攻擊者利用

- **Default Passwords**（預設密碼）：製造商為初始存取裝置或軟體所提供的預設認證資訊
  - 常見的預設密碼組合包括：admin - admin、administrator - password、或使用者名稱為 admin 而密碼為空白
  - 這些預設密碼通常公開於手冊及製造商的線上知識庫，因此應在設備啟用時立即更改
  - 若系統支援**Multi-factor Authentication**（多因素驗證），應在管理介面中啟用此功能
  - 若僅能使用使用者名稱和密碼，應選擇長度足夠、強度高、獨特且複雜的密碼
  - 管理員密碼應約每 90 天輪換一次
  - 建議使用**Password Manager**（密碼管理器）來建立和儲存複雜密碼

- **Unneeded Ports and Protocols**（不需要的連接埠和協定）：裝置預設啟用但實際不需要的連接埠和協定
  - 每個作用中的開放連接埠都是攻擊者潛在的入侵點
  - 應進行徹底的連接埠和協定稽核，並停用不必要的項目
  - 透過減少作用中的連接埠和運行的協定，可顯著降低攻擊面和遭受成功攻擊的可能性
  - 若發現使用不安全協定，應轉向其加密版本，例如：
    - 從 HTTP（連接埠 80）轉向 HTTPS（連接埠 443）
    - 從 SMTP（連接埠 25）轉向 SMTPS（連接埠 587 或 465）

- **Open Ports**（開放連接埠）：裝置預設開放的連接埠
  - 許多裝置出廠時預設開放多個連接埠，例如 22、23、80 和 443
  - 製造商為提供最大相容性而開放多個服務連接埠
  - 應關閉不安全的連接埠，如：
    - 關閉連接埠 23（Telnet），因其以未加密形式傳輸通訊
    - 若只需使用連接埠 443 進行安全網頁通訊，可關閉連接埠 80

- **Security Posture**（安全態勢）：組織當前的整體安全狀態包含系統、人員等
  - 變更預設設定不一定需要高度技術專業知識
  - 簡單的操作如變更密碼或關閉連接埠可成為對抗潛在威脅的第一道重要防線
  - 主動防禦永遠優於被動反應
  - 採取這些小步驟能更好地保護系統和所含資料

## 資訊安全基本原則

- 對新設備和軟體進行安全性審查和設定變更
- 使用長度足夠且複雜的密碼，並定期更換
- 只開放必要的連接埠和服務，並優先使用加密通訊
- 持續審核和維護系統安全性，採取主動防禦措施

# 應用程式安全限制技術

## 降低功能與應用程式限制

- **Least Functionality**（最小功能原則）：將工作站或伺服器配置為只提供使用者所需的基本應用程式和服務的過程
  - 需要限制系統上不必要的應用程式、服務、連接埠和協議
  - 目的是減少可能引入系統漏洞的程式碼

- **Application Allowlisting**（應用程式白名單）：只允許列表上的應用程式執行，其他所有應用程式都被阻擋
  - 最安全的應用程式限制方式
  - 類似於存取控制列表（ACL）的明確允許規則，但應用於應用程式層級
  - 管理較為困難，因為每次應用程式更新都需要更新白名單

- **Application Blocklisting**（應用程式黑名單）：阻擋列表上的應用程式執行，其他所有應用程式都被允許
  - 安全性較白名單低
  - 較容易管理但效果有限
  - 對新出現的惡意軟體無法及時防範，因為需要先將其加入黑名單

## 系統管理與配置

- **Configuration Management**（配置管理）：監督和管理應用程式安裝過程的管理機制
  - 用於企業環境中管理電腦配置
  - 有助於確保系統一致性和安全性

- **Secure Baseline Image**（安全基準映像檔）：企業環境中用於工作站初始安裝的標準映像檔
  - 包含作業系統、組織所需的最低應用程式和嚴格的配置策略
  - 可隨業務需求變化而更新

- **Group Policies**（群組原則）：用於在整個組織中推送配置變更
  - 在 Microsoft Windows 網域環境中，可通過 Active Directory 網域控制器管理和部署白名單或黑名單策略

## 安全考量

- **漏洞管理**：每個安裝的應用程式都需要管理、更新和修補以確保安全
  - 未使用的應用程式增加了系統被攻擊的可能性
  - 舊版本應用程式可能包含安全漏洞，應予以解除安裝

- **安全性與可管理性平衡**：
  - 白名單提供更高的安全性，但管理成本較高
  - 黑名單管理較簡單，但安全性較低
  - 選擇哪種方法取決於組織的安全需求

## 實務應用

- 在高安全性環境中應使用白名單方法
- 至少應使用黑名單來阻擋已知的惡意應用程式或不希望在網路上執行的應用程式
- 在大型網路環境中，預防過度安裝比解除安裝更重要
- 透過群組原則進行集中管理可提高效率

# 非必要服務

## 服務基礎概念

- **Services**（服務）：一種在操作系統背景中運行的應用程式類型，執行各種功能而無需使用者介面
  - 服務在背景執行，執行各種功能，例如列印佇列管理（print spooler）
  - 管理員應確保只有必要的服務被允許運行
  - 未使用的服務應在操作系統中被禁用以增強安全性

## Windows 服務管理

- **services.msc**（服務管理主控台）：Windows 管理服務的主要工具
  - 可以通過 Windows 鍵 + R 搜尋「services.msc」開啟
  - 顯示所有服務的名稱、描述、狀態（是否運行中）、啟動類型和登入方式
  - 服務啟動類型包括：手動（Manual）、自動（Automatic）或禁用（Disabled）

- **停止與禁用服務**（以 Windows Update 服務為例）：
  - 雙擊服務查看詳細資訊
  - 點擊「停止」（Stop）按鈕終止服務
  - 將啟動類型從「自動」（Automatic）更改為「禁用」（Disabled）防止重啟後自動啟動
  - 點擊「套用」（Apply）保存更改

- **命令列管理服務**：
  - **sc 命令（控制服務）**：`sc stop [服務名稱]`（如 `sc stop wuauserv`）
  - **net 命令（控制網路服務）**：`net stop [服務名稱]`（如 `net stop wuauserv`）

## macOS 服務管理

- **Activity Monitor**（活動監視器）：macOS 管理服務與程序的主要工具
  - 位於：應用程式 > 工具程式 > 活動監視器
  - 顯示所有背景運行的服務與程序
  - 可查看程序的記憶體使用、統計資料、開啟的檔案和連接埠

- **終止程序**：
  - 雙擊程序查看詳細資訊
  - 點擊「結束」（Quit）按鈕
  - 選擇「正常結束」或「強制結束」（Force Quit）立即終止程序

## Unix/Linux 系統服務管理

- **top**（任務管理器）：顯示當前運行的程序
  - 顯示所有運行中的程序/服務（兩者在 Unix/Linux 系統中概念相通）
  - 顯示程序 ID（PID）和其他相關資訊

- **kill 命令**：終止特定程序
  - 語法：`kill [PID]`（例如 `kill 2513`）
  - macOS（Unix-based）和 Linux 系統都可使用此命令

## 安全性應用

- 在發現惡意軟體時，可通過停止其相關服務來輔助移除
- 在企業環境中，特定服務（如 Windows Update）可能需要被禁用，以便集中透過補丁管理系統進行更新
- 服務管理是維護系統安全的重要環節

# 可信任作業系統

- **Trusted Operating System (TOS)（可信任作業系統）**：一種設計用來提供安全運算環境的作業系統，透過強制執行嚴格的安全政策來保護系統，通常依賴強制性存取控制（MAC）。
  - 適用於資料的完整性、機密性和可用性極為重要的環境
  - 通常經過 Common Criteria 安全評估認證，根據安全程度分級（EAL1-EAL7）

- **Mandatory Access Control (MAC)（強制性存取控制）**：指定哪個人或程序可以存取特定資源或資訊的機制。
  - 由系統管理員定義的政策決定存取權限，並由作業系統強制執行
  - 與自由選擇性存取控制（DAC）不同，在MAC中即使資料擁有者也無法更改存取權限
  - 提供更高層級的安全性保障

- **Evaluation Assurance Level (EAL)（評估保證等級）**：Common Criteria 資訊技術安全評估中，對作業系統安全控制有效性的評級。
  - EAL1：最低保證等級
  - EAL7：最高保證等級
  - Windows 7以後版本、macOS 10.6 以後版本與許多Linux版本皆達到EAL4或EAL4+
  - EAL6/EAL7通常僅用於嵌入式或特殊用途作業系統

- **Integrity-178B（完整性-178B）**：基於POSIX的嵌入式系統作業系統，應用於軍事和商業飛機。
  - 被評為EAL6等級
  - 使用於美國軍用飛機如B-2轟炸機、F-16、F-22和F-35戰鬥機
  - 也用於民用飛機如空中巴士A380

- **Common Criteria（通用標準）**：用於評估資訊技術安全性的國際標準。
  - 評估作業系統實施的安全控制有效性
  - 提供標準化的安全評估方法

- **Security-Enhanced Linux (SELinux)（安全增強型Linux）**：安裝在Linux發行版上的控制集，提高系統安全性。
  - 評級為EAL4+
  - 在Linux核心中實現MAC
  - 確保應用程式和用戶只有最小必要的資源存取權限
  - 使用政策強制執行安全屬性，限制潛在有害程序的影響範圍

- **Trusted Solaris（可信任Solaris）**：設計用於提供安全多級操作的分發版。
  - 實現MAC機制
  - 提供系統事件的詳細稽核
  - 實現隔離區域以隔離處理程序和資料

- **Microkernel（微型核心）**：用於可信任作業系統中，最小化系統的可信任運算基礎。
  - 減少系統的攻擊面
  - 降低安全漏洞的可能性

- **Trusted Computing Base (TCB)（可信任運算基礎）**：系統中對安全性至關重要的部分，必須被信任能正確運作。
  - 透過微型核心架構減小TCB規模可增強系統安全性

- **Application Sandboxing（應用程式沙盒）**：移動裝置作業系統中的安全機制。
  - 限制對系統資源的存取權限
  - 隔離應用程序彼此間的互動
  - 如Google Android使用AppArmor等工具實施強制存取控制

- **Trusted Operating System Challenges（可信任作業系統的挑戰）**：
  - 設計和維護成本高昂
  - 需平衡安全需求與可用性、性能和其他功能需求
  - 高等級EAL系統（EAL6/EAL7）通常限於嵌入式或特定用途系統（如自動駕駛車輛、飛機和醫療設備）

# 更新與修補程式

## 基本概念

- **Updates and Patches**（更新與修補程式）：系統強化措施的重要組成部分
  - 用於修補軟體中的安全漏洞，適用於作業系統、應用程式、雲端執行個體及韌體
  - 許多資料外洩事件的根本原因是缺少適當的軟體修補程式

## 修補程式類型

- **Hotfix**（緊急修補程式）：解決安全性問題的軟體修補程式
  - 在測試環境驗證後應立即應用，以防止攻擊者利用該漏洞
  - 屬於緊急性質的修補

- **Update**（更新程式）：提供系統額外功能的更新
  - 通常不包含安全性問題的修補
  - 由於新增功能和特性，反而可能引入新的安全漏洞，需要額外的緊急修補程式

- **Service Pack**（服務包）：大量修補程式的集合包
  - 將數百或數千個緊急修補程式和更新整合成單一安裝檔
  - 例如 Windows XP 在其 13 年生命週期內發佈了多個服務包，最終版本是 Windows XP Service Pack 3，包含了數千個更新和緊急修補程式

## 修補程式管理

- **Patch Management**（修補程式管理）：確保網路及系統安全的常規方法
  - 可以是手動、自動化或兩者結合的程序
  - 在現今環境中，純手動管理修補程式並不常見，因為工作量太大
  - 大多數組織使用修補程式管理軟體工具來自動檢查端點是否需要特定修補程式

## 修補程式管理的風險

- **Reverse Engineering**（逆向工程）：當軟體製造商發布修補程式後，駭客會嘗試逆向工程這些修補程式
  - 目的是發現原始漏洞並開發可用的攻擊方式
  - 修補程式發布後幾天內就可能出現可用的攻擊方式
  - 研究指出，72% 的 IT 管理員擔心立即套用安全修補程式會「破壞系統運作」

## 有效修補程式管理計劃的要素

1. **專責團隊**：指派專人或團隊追蹤廠商提供的安全性修補程式公告
2. **修補機制**：建立機制來修補所有系統的作業系統和應用程式，最好是自動化的流程
3. **雲端資源納入**：確保將雲端資源納入修補程式管理計劃中
4. **優先級分類**：將修補程式分類為緊急、重要和非關鍵，以優先分配資源
5. **測試環境**：擁有實驗室或測試環境來測試緊急和重要修補程式，確保功能正常後再部署到生產環境
6. **詳細記錄**：維護修補活動的詳細日誌，以便評估和監控修補程式管理計劃
7. **韌體更新機制**：建立評估、測試和部署韌體更新的機制
8. **緊急部署程序**：建立技術流程，在緊急變更諮詢委員會批准後將緊急修補程式部署到生產環境
9. **定期集中部署**：定期評估非關鍵修補程式，進行合並推出（例如每兩週一次）

## 修補程式管理的最佳實踐

- 建議設定自動更新，自動「推送」（安裝）軟體更新到系統
- 應隨時下載並安裝應用程式的最新修補程式，並關注廠商網站上的漏洞和修補資訊
- 強調修補可確保設備的持續功能和安全性，測試和檢查所有修補程式也是管理過程中的重要步驟

## 修補程式管理的挑戰

- 需平衡安全性與系統穩定性
- 對關鍵系統可能需要手動實施修補程式
- 使用生命週期結束 (EOL) 軟體會帶來安全風險和相容性問題

# 修補程式管理

- **Patch Management**（修補程式管理）：指規劃、測試、實施和稽核軟體修補程式的過程
  - 主要目的為提供安全性、增加系統運行時間、確保合規性，以及改進網路設備、伺服器和用戶端的功能
  - 透過修補已知漏洞來提高網路安全性
  - 通過安裝軟體或作業系統修補程式來修復系統軟體中的錯誤

## 修補程式管理的重要性

- **安全強化**：修復網路設備、伺服器及用戶端中的已知漏洞
- **提高系統正常運行時間**：確保設備和軟體保持最新狀態，避免因程式碼漏洞而導致資源耗盡或當機
- **法規遵循**：完善的修補程式管理是合規性考核的重要項目
  - 特別注重系統如何有效防範具有相關修補程式的已知漏洞（CVE）
- **功能改進**：部分修補程式包含功能或特性更新，使用最新版本軟體能確保擁有最佳功能和最高安全性

## 修補程式管理的四步驟流程

- **Planning**（規劃）：建立政策、程序和系統以追蹤可用的修補程式和更新
  - 確認修補程式與現有系統的相容性
  - 決定如何測試和部署每個修補程式
  - 考慮使用修補管理工具，如 Microsoft Endpoint Configuration Manager 或第三方工具

- **Testing**（測試）：在全網路部署前先測試修補程式
  - 修補程式可能會引入新問題的可能性
  - 應設置測試網路實驗室或至少一個工作站用於測試
  - 測試環境有助於發現修補程式與特定網路配置之間的衝突問題

- **Implementation**（實施）：將經過測試的修補程式部署到所有需要的工作站和伺服器
  - 小型網路可以手動安裝
  - 大型網路建議使用自動化工具進行部署
  - 可採用「修補環」（Patch Ring）的概念分階段部署：
    - 修補環 1：10-20 台機器（初步測試）
    - 修補環 2：50-100 台機器（含系統管理員和服務台）
    - 修補環 3：1000-2000 台機器
    - 修補環 4：剩餘所有機器（10000-20000 台）
  - 建議大型組織通過更新伺服器管理更新，而非使用 Windows Update 工具
  - 行動裝置則透過 MDM（Mobile Device Manager）實施修補

- **Auditing**（稽核）：確認修補程式部署後的狀態
  - 掃描網路以確定修補程式是否正確安裝
  - 檢測因安裝可能導致的意外故障
  - 相關工具能提供工作站和伺服器的掃描與驗證

## 其他系統的修補管理

- **Linux/Mac 系統**：也有內建的修補程式管理系統
  - Linux 可使用套件管理器部署 RPM 或修補程式套件
  - 基本概念與原則與 Microsoft 系統類似

- **Firmware Management**（韌體管理）：網路設備的修補程式管理
  - 網路設備（如交換機和路由器）運行韌體作為其作業系統
  - 過時的韌體版本可能存在安全漏洞與軟體錯誤
  - 如同修補電腦作業系統，網路設備的作業系統也需更新
  - 以思科設備為例，作業系統稱為 Cisco's iOS（互聯網路作業系統）
  - 更新 iOS 版本需要刷新設備韌體
  - 某些設備製造商提供集中式韌體管理方法：
    - 思科使用 Cisco UCS Manager
    - 第三方工具如 ManageEngine 的 Device Expert

## 修補管理的規模化實施

- 規模化的修補管理需要工具、自動化或協調機制
- 確保所有網路設備、伺服器、筆記型電腦和行動裝置保持最新狀態
- 防範所有已知的漏洞

# 組策略

- **Group Policy**（組策略）：一組可應用於作業系統中特定使用者或電腦帳戶的規則或政策集合。
  - 透過在執行提示字元中輸入「gpedit」來存取本地組策略編輯器
  - 每個策略作為安全範本，可套用一組規則到不同使用者
  - 策略可包含密碼複雜度要求、帳戶鎖定策略、軟體限制和應用程式限制

- **Security Template**（安全範本）：一組根據組織管理政策預先定義的規則，可透過單一程序在組策略編輯器中載入。
  - 在企業環境中常見的做法
  - 作為組織安全基準的一部分

- **Group Policy Objects (GPOs)**（組策略物件）：用於工作站或伺服器強化作業系統的策略物件。
  - 由組策略容器（GPC）和組策略模板（GPT）組成
  - GPT 包含實際的配置文件，GPC 是組織管理具體配置的容器
  - 用於建立安全基準，作為大型組態管理計劃的一部分
  - 使用這些策略，新帳戶和電腦可以快速設定所有組織要求

- **Baselining**（基準化）：測量網路、硬體或軟體環境變化的過程。
  - 有助於建立組織的「正常狀態」標準
  - 透過了解正常狀態，可以識別異常或偏差
  - 每個偏差應被分類為可接受和預期的，或需進一步調查的問題
  - 許多資料洩露是透過調查網路使用率異常發現的，例如資料外洩（exfiltration）

- **AppLocker**（應用程式鎖定器）：提供應用程式存取控制，可在組策略中建立允許或拒絕規則。
  - 位於電腦配置 > Windows 設定 > 安全設定 > 應用程式控制策略下
  - 可建立以下類型的規則：
    - 可執行文件規則
    - Windows 安裝程式規則
    - 腳本規則
    - 套件應用程式規則
  - 可基於以下條件建立規則：
    - 發行者（Publisher）
    - 路徑（Path）
    - 檔案雜湊（File Hash）

- **Allow List**（允許清單）：指定允許執行的應用程式或檔案。
  - 在 AppLocker 中設定為允許規則
  - 可設定例外情況

- **Block List**（阻止清單）：指定禁止執行的應用程式或檔案。
  - 在 AppLocker 中設定為拒絕規則
  - 可用於防止惡意軟體從特定位置（如臨時目錄）執行

- **組策略執行順序及繼承原則**：
  - Windows 系統預設每 90 分鐘刷新一次組策略，隨機偏移 30 分鐘
  - 在域控制器上，每隔 5 分鐘刷新一次
  - 用戶可使用 gpupdate 命令手動刷新組策略
  - 組策略應用順序（如有衝突，後應用的生效）：本地組策略 → 站點 → 域 → OU

## 實作範例：阻止臨時目錄執行程式

AppLocker 中建立拒絕規則步驟：
1. 在執行規則空白處右鍵點選「Create New Rule」
2. 選擇「Deny」（拒絕規則）
3. 選擇適用對象（如「Everyone」）
4. 選擇條件類型（如「Path」路徑）
5. 瀏覽並選擇要阻止的資料夾（如 %WINDIR%\Temp\*）
6. 設定例外（如需要）
7. 命名規則並加入描述（如「Block all files from running in temp directory」）
8. 選擇是否建立預設規則（通常包含允許程式檔案目錄、Windows 目錄和管理員執行檔案的規則）

這樣設定的組策略可作為安全基準，部署到整個環境中的所有 Windows 系統。

# SELinux 安全增強型 Linux

- **SELinux**（安全增強型 Linux）：由美國國家安全局（NSA）創建，為 Linux 系統提供額外安全層，用以防止未授權程序存取或竄改資料。
  - 是 Red Hat Enterprise Linux 和 CentOS 的預設上下文型權限機制
  - 通過強制存取控制（MAC）來執行對程序和資源的權限控制
  - 可根據資料的機密性和完整性需求對資訊進行分類和保護
  - 目的是防止惡意使用者或應用程式導致的損害

- **Mandatory Access Control (MAC)**（強制存取控制）：一種系統強制執行的存取控制機制，基於主體許可權和物件標籤。
  - MAC 不允許使用者自行變更安全性政策，這些政策由系統管理員集中控制
  - 與 DAC 不同，MAC 是由系統強制執行，無法被使用者覆寫或修改
  - 歷史上與多層級安全（MLS）和專門的軍事系統緊密相關
  - SELinux 和 AppArmor 都使用 MAC 作為其安全機制的基礎

- **Discretionary Access Control (DAC)**（自主存取控制）：Linux 系統中的預設存取控制方案，由物件擁有者控制。
  - 每個物件都有一個允許存取的實體列表（系統、程序、檔案或使用者）
  - 物件所有者可以直接使用 chown（改變所有權）或 chmod（改變權限模式）進行變更
  - 使用者可以自行決定（discretionary）如何控制自己擁有的資源
  - 與 MAC 相比，DAC 的安全性較低，因為它允許使用者變更安全屬性

- **Context-based permissions**（上下文型權限）：根據檔案或程序的各種屬性來定義權限的方案。
  - 使用這些屬性的組合（而非單獨考慮）來決定是否授予或拒絕使用者存取
  - Linux 中兩個主要的上下文型權限方案為 SELinux 和 AppArmor
  - 這些方案利用 MAC 來執行其工作

- **SELinux Contexts**（SELinux 上下文）：定義檔案和程序的三個主要上下文。
  1. **User Context**（使用者上下文）：定義哪些使用者可以存取物件
     - 常見使用者包括：unconfined_u（所有使用者）、user_u（無特權使用者）、sysadmin_u（系統管理員）和 root（根使用者）
  2. **Role Context**（角色上下文）：定義哪些角色可以存取給定物件
     - SELinux 使用者被授權在特定角色中運作
     - 角色用於允許或拒絕對特定域或資源和程序的存取
     - object_r 角色適用於檔案和目錄
  3. **Type Context**（類型上下文）：MAC 的標籤部分，是最重要的精細存取控制上下文
     - 用於將具有類似安全需求或特性的物件分組

- **Level**（層級）：SELinux 的可選第四上下文，用於描述檔案、目錄或程序的敏感度層級。
  - 使用層級時，稱為「多層級安全上下文」（multi-level security context）
  - 即使符合主要三個上下文的條件，也可以通過層級進一步限制存取

- **SELinux Modes**（SELinux 模式）：定義 SELinux 的運行狀態。
  1. **Disabled**（停用）：SELinux 完全關閉，系統依賴預設的 DAC 方法
  2. **Enforcing**（強制）：所有 SELinux 安全政策被強制執行，程序無法違反安全政策
  3. **Permissive**（寬容）：SELinux 啟用但安全政策不被強制執行，程序可以繞過安全政策，但會記錄違規行為

- **SELinux Policies**（SELinux 政策）：描述所有使用者、程式、程序、檔案和裝置的存取權限。
  1. **Targeted Policy**（目標政策）：Red Hat Linux 和 CentOS 的預設政策
     - 目標程序在受限域中運行
     - 非目標程序在不受限域中運行
  2. **Strict Policy**（嚴格政策）：系統中的每個主體和物件都被強制使用 MAC 方法
     - 實施更複雜，需要仔細配置所有系統元素的存取權限
     - 提供更高級別的安全性，但配置工作量大

- **SELinux Violations**（SELinux 違規）：系統強制執行 SELinux 後，違反政策的行為會被捕捉為審計日誌的一部分。
  - 違規可能發生在使用者嘗試存取沒有權限的物件或檔案時
  - 或者當某個行為違反現有政策被阻止時
  - 系統初次使用 SELinux 時可能產生大量誤報，需要調整和微調政策
  - SELinux 的強度取決於所創建的限制性設定檔

# 資料加密級別

- **Data Encryption**（資料加密）：將資料轉換成秘密代碼以防止未授權存取的過程。
  - 確保資料的機密性、完整性和安全性，即使儲存媒體或通訊管道被入侵
  - 資料加密可應用於不同級別，包括全磁碟加密、分區加密、檔案加密、磁碟區加密、資料庫加密和記錄級別加密

- **Full-Disk Encryption**（全磁碟加密）：加密整個硬碟或儲存裝置以保護所有存儲的資料。
  - Windows 系統可使用 BitLocker 軟體工具進行全磁碟加密
  - macOS 系統可使用 FileVault 進行全磁碟加密
  - 開機時需要 PIN 碼、密碼或安全金鑰來解鎖
  - 某些儲存裝置也具有硬體層級的全磁碟加密功能
  - 也稱為「靜態資料加密」（encrypting data at rest）

- **Partition Encryption**（分區加密）：類似於全磁碟加密，但僅應用於儲存裝置上的特定分區。
  - 可使用 VeraCrypt 等軟體工具來加密僅包含敏感文件的分區
  - 優點是減少加密對系統性能的影響，因為加密/解密過程會增加讀寫資料的額外開銷
  - 僅加密包含敏感資料的部分可提高整體系統速度

- **Volume Encryption**（磁碟區加密）：加密儲存媒體上的特定空間以建立可存放各種文件和資料夾的加密容器。
  - VeraCrypt 是建立這類加密磁碟區的常用工具
  - 提供靈活性，可決定加密磁碟區的大小
  - 可作為全磁碟加密的額外保護層，用於保護特別敏感的資料

- **File-Level Encryption**（檔案級別加密）：用於加密單個檔案而非整個分區或磁碟機。
  - GNU's Privacy Guard（GPG）等工具可用於加密特定檔案
  - 適用於只需要保護少數關鍵檔案的情況
  - 有助於安全地通過電子郵件或其他方式傳送敏感檔案
  - 在 Windows 中，可使用 EFS（Encrypting File System）進行檔案級別加密

- **Database Encryption**（資料庫加密）：加密整個資料庫，類似於全磁碟加密，但可跨越多個儲存裝置或雲端儲存環境。
  - 可使用 SQL Server 透明資料加密（Transparent Data Encryption，TDE）等技術
  - 自動加密整個資料庫，無需修改底層應用程式
  - 資料庫系統負責處理加密和解密任務
  - 適用於需要保護大量結構化資料的場景

- **Record-Level Encryption**（記錄級別加密）：用於加密資料庫中的個別記錄或行。
  - 提供更細粒度的加密方法
  - 允許只加密資料庫中包含敏感信息的特定欄位（如信用卡號碼、社會安全號碼）
  - 相比加密整個資料庫，可提高系統性能並減少資源消耗

## 加密方案選擇考量因素

在選擇適當的加密級別時，需要考慮以下方面：
- 安全需求與系統性能間的平衡
- 加密對系統資源的影響
- 資料敏感性的程度
- 法規遵循要求
- 使用場景（本地存儲、傳輸中資料、共享環境等）

加密實施需要認真規劃、實施和持續監督，以確保資料在任何位置都能保持安全且不被未授權實體訪問。

# 安全基準線

- **Secure Baseline**（安全基準線）：套用於系統、網路或應用程式的標準配置和控制集合，以確保最低安全水平。
  - 幫助組織維持一致的安全狀態
  - 減輕組織數位資產中的常見漏洞
  - 基於最佳實踐、行業標準和合規要求（如 ISO 27001 或 NIST SP 800-53）建立

## 安全基準線的建立、部署和維護流程

- **建立安全基準線**（Establishing a Secure Baseline）：對需要保護的系統、網路或應用程式進行全面評估。
  - 識別處理的資料類型
  - 了解資料工作流程
  - 評估潛在漏洞和威脅
  - 針對特定系統（如筆記型電腦）建立配置：
    1. 獲取新設備作為範本
    2. 格式化、安裝作業系統
    3. 更新並適當設定安全配置
    4. 根據基準配置指南檢查並掃描已知漏洞
    5. 安裝所需應用程式（辦公套件、端點偵測響應代理、網頁瀏覽器等）
    6. 再次掃描漏洞並修復
    7. 建立映像檔作為已知安全基準

- **部署安全基準線**（Deploying a Secure Baseline）：將安全基準線應用於所有組織的數位資產。
  - 配置防火牆
  - 設定使用者權限
  - 實施加密協議
  - 確保正確安裝和更新防毒和防惡意軟體解決方案
  - 使用自動化工具和腳本確保統一應用
  - 將非使用映像檔安裝的設備與已知配置比對並確保適當設定
  - 在 Windows 域環境中，管理員可使用群組原則物件（GPOs）套用安全基準線
  - 雲端環境（如 AWS）可使用 AWS Config 定義和部署安全配置

- **維護安全基準線**（Maintaining a Secure Baseline）：確保基準線保持有效並跟上最新威脅和漏洞。
  - 鎖定系統，防止使用者安裝額外軟體或修改配置
  - 定期進行審計和監控
  - 使用工具識別與基準線的偏差，並觸發警報以立即進行補救
  - 定期審查和更新安全基準線，以符合組織基礎架構、業務需求和不斷演變的威脅
  - 進行培訓和提高員工意識，確保他們理解遵循安全配置的重要性
  - 鼓勵員工報告可疑活動

## 安全基準線的重要性與益處

- 保護組織網路的關鍵實踐
- 確保數位資產一致配置以抵抗攻擊
- 減輕已知漏洞和錯誤配置
- 透過持續監控和更新，增強組織安全狀態
- 保護寶貴的資料和資源免受潛在資料洩露

## 安全基準線相關技術與工具

- **Group Policy Objects (GPOs)**（群組原則物件）：在 Windows 域環境中應用安全基準線的工具
  - 可用於實施密碼原則
  - 分配使用者權限
  - 設定審計設定
  
- **AWS Config**：AWS 雲環境中定義和部署安全配置的服務
  - 可用於雲端資源的安全基準管理

- **Security Compliance Toolkit (SCT)**：Microsoft 提供的工具，協助管理安全基準
  - 包含協助管理安全基準的工具
  - 可從 Microsoft 下載中心獲得
  - 用於管理基於群組原則的安全基準

- **Mobile Device Management (MDM) Security Baselines**：行動裝置管理安全基準
  - 類似於基於 Microsoft 群組原則的安全基準
  - 可以輕鬆整合到現有的 MDM 管理工具中
