# 惡意軟體（Malware）

-   設計用於在未經用戶知情或同意的情況下滲透計算機系統並可能造成損害的軟體。
-   是一個廣泛的軟體代碼類別，包含許多有害程式

## 攻擊途徑與方式

-   **Threat Vector**（威脅路徑）：可能產生威脅的來源或環境。

    -   例如：未修補的軟體、通過 USB 隨身碟安裝代碼、釣魚活動
    -   主要關注攻擊者計劃如何入侵系統的漏洞點

-   **Attack Vector**（攻擊路徑）：具體的攻擊方法或路徑。
    -   包含攻擊者進入系統的方式以及如何感染該系統
    -   例如：掃描網路找到未修補的電腦，利用已知漏洞執行惡意程式

## 惡意軟體類型

-   **Virus**（病毒）：附著在乾淨檔案上的惡意軟體，能夠在計算機系統中擴散，通常會破壞或損害宿主檔案。

-   **Worm**（蠕蟲）：獨立的惡意軟體，能自我複製並傳播到其他計算機，通常利用軟體漏洞在網路中傳播。

-   **Trojan**（木馬）：偽裝成合法軟體的惡意程式，執行後可讓攻擊者獲得受害系統的未授權訪問權限。

-   **RAT** (Remote Access Trojan，遠程訪問木馬)：允許攻擊者遠程控制受感染電腦的特洛伊木馬。

-   **Ransomware**（勒索軟體）：加密用戶數據並持有為人質，直到向攻擊者支付贖金以獲取解密密鑰。

-   **Zombie**（殭屍電腦）：被攻擊者遠程控制的受感染計算機，通常與其他殭屍電腦協同作業形成殭屍網路。

-   **Botnet**（殭屍網路）：由攻擊者控制的受感染計算機網路，常用於分散式阻斷服務攻擊、垃圾郵件分發或加密貨幣挖礦。

-   **Rootkit**（隱匿軟體）：隱藏其存在和活動的惡意工具，通常在操作系統層級或更低層級運行，以維持對系統的特權訪問。

-   **Backdoor**（後門）：繞過正常認證過程的惡意手段，用於獲取系統未授權訪問，通常由惡意軟體或威脅行為者植入。

-   **Logic Bomb**（邏輯炸彈）：嵌入在合法程式中的代碼，當特定條件或觸發器出現時執行惡意操作。

-   **Keylogger**（鍵盤記錄器）：記錄用戶按鍵的隱秘工具或惡意軟體變體，通常用於捕獲密碼和其他敏感資訊。

-   **Spyware**（間諜軟體）：秘密監控和收集用戶信息或系統活動的軟體，未經用戶知情或同意將數據發送給第三方。

-   **Bloatware**（膨脹軟體）：設備上不必要或預裝的軟體，常消耗系統資源和空間，卻未能提供相應價值。

--  **Adware**（廣告軟體）：擅自在用戶計算機設備上彈出、顯示廣告的惡意軟體。

## 惡意軟體攻擊技術

-   **Malware Exploitation Techniques**（惡意軟體利用技術）：惡意軟體滲透和感染目標系統的方法
    -   從基於文件的戰術演變為現代無檔案技術，在感染機器上留下極少痕跡
    -   高級惡意軟體通常使用多階段部署，利用系統內建工具和各種混淆技術

## 惡意軟體攻擊跡象

-   需識別的惡意軟體攻擊指標包括：
    -   帳戶鎖定（Account lockouts）
    -   並行會話使用（Concurrent session utilization）
    -   內容被阻止（Blocked content）
    -   不可能的旅行（Impossible travel）
    -   資源消耗（Resource consumption）
    -   資源不可訪問（Resource inaccessibility）
    -   非正常週期的日誌記錄（Out-of-cycle logging）
    -   丟失的日誌（Missing logs）
    -   已公開發布或記錄的攻擊手法（Documented attacks）

## 實例分析

-   **WannaCry 勒索軟體案例**：
    -   利用未修補的 WindowsMS17-010 安全漏洞攻擊 Windows 7/8/10 系統
    -   攻擊者自動掃描未修補機器，利用 EternalBlue 漏洞獲取系統管理權限
    -   加密用戶文件並顯示勒索信息，要求比特幣贖金換取解密密鑰

# 電腦病毒（Viruses）定義

由惡意程式碼所組成，在使用者不知情的情況下在電腦上執行，使該程式碼能夠在執行時感染電腦。

-   病毒需要使用者採取某種行動才能傳播，例如安裝含有惡意程式碼的軟體
-   一旦啟動，病毒會自我複製並擴散到網路中
-   常見惡意活動包括：跨網路複製、刪除關鍵檔案、佔用系統資源

## 病毒類型

-   **Boot Sector Virus**（開機區病毒）：儲存在硬碟或固態裝置第一個磁區，並在電腦啟動時載入記憶體。

    -   難以偵測，因其在作業系統啟動前就已安裝
    -   能夠隱藏自己避開一般防毒軟體的掃描
    -   需要專門針對開機區病毒的防毒軟體才能找出並移除
    -   通常需透過網路防毒掃描引擎或從 Linux 啟動碟載入的防毒軟體來處理

-   **Macro Virus**（巨集病毒）：一種程式碼形式，允許病毒嵌入在其他文件中，當使用者開啟該文件時，病毒就會被執行。

    -   最常見於 Microsoft Word 文件、Excel 試算表和 PowerPoint 簡報
    -   巨集本身並非惡意，原本設計用於增加文件功能性
    -   攻擊者會利用社交工程技術誘騙使用者開啟含有惡意巨集的文件

-   **Program Virus**（程式病毒）：尋找可執行檔或應用程式檔案來感染其惡意程式碼。

    -   會安裝自身到電腦上已有的程式中（如 Microsoft Word）
    -   每次開啟受感染的應用程式時，都會重新感染系統
    -   專門針對程式或應用程式，以確保能夠反覆感染系統

-   **Multipartite Virus**（複合型病毒）：結合開機區病毒和程式病毒的特性的混合體。

    -   能夠同時將自己放在開機區及程式中
    -   即使安全專業人員清除了程式部分的病毒，開機區部分仍可在重開機時重新感染系統
    -   具有很強的持續性，難以完全清除

-   **Encrypted Virus**（加密病毒）：通過加密其惡意程式碼或有效負載來隱藏自己，避免被防毒軟體檢測。

    -   將惡意程式碼加密為密文，使用者和防毒軟體都無法讀取
    -   是攻擊者對抗不斷進步的防毒技術的應對方式

-   **Polymorphic Virus**（多態病毒）：加密病毒的進階版本，每次執行時都會改變病毒程式碼。

    -   透過修改解密模組來逃避檢測
    -   目的是改變程式碼外觀，使基於特徵的防毒應用無法將其識別為惡意

-   **Metamorphic Virus**（變形病毒）：能夠在嘗試感染檔案前完全重寫自身。

    -   多態病毒的更進階版本
    -   能完全改變其程式碼結構，使其更難被識別

-   **Stealth Virus**（隱匿型病毒）：不是特定類型的病毒，而是病毒用來防止被防毒軟體檢測的技術。

    -   使用多種技術隱藏自己，包括加密內容、修改有效負載等

-   **Armored Virus**（裝甲病毒）：具有保護層，能混淆試圖分析它的程式或人。

    -   病毒創造者為其程式碼添加保護，增加傳播機會
    -   設計用來躲避組織的安全設備或防毒掃描器

-   **Hoax Virus**（詐騙病毒）：嚴格來說不是病毒，而是一種技術性社交工程。
    -   試圖嚇唬終端使用者在系統上採取不良行動
    -   常見形式為彈出訊息，宣稱來自技術支援團隊，告知電腦已被感染
    -   目的是誘騙使用者安裝真正的惡意軟體或支付金錢
    -   實際上是社交工程的一種形式，試圖欺騙使用者授予訪問權限或代為安裝惡意程式

## 現代病毒的複合性

現代病毒通常會結合多種類別，建立更強大的病毒形式，如「加密、變形、複合型」病毒，這種病毒能牢牢控制系統並試圖避開安全設備和防毒軟體的檢測。

# 電腦蠕蟲（Computer Worms）定義

一種惡意軟體，能夠在沒有使用者介入的情況下自我複製

-   與病毒的關鍵區別：病毒需要使用者採取行動（如開啟檔案、點擊惡意連結或連接存儲裝置）才能傳播，而蠕蟲不需要使用者同意或操作
-   蠕蟲會利用作業系統和應用程式中的漏洞進行傳播
-   危險性有兩方面：感染工作站和其他計算資產，以及使網路流量中斷
-   蠕蟲複製過程會消耗網路資源、計算能力、處理能力、記憶體和網路容量，導致系統和網路速度變慢
-   過快的複製可能導致對網路和相關伺服器的阻斷服務攻擊（DoS）

## 蠕蟲類型

-   **Security Patching**（安全性修補）：減輕漏洞風險的關鍵措施

    -   若未進行適當的安全性修補，蠕蟲可以掃描網路並找出缺少安全更新的工作站
    -   組織需選擇適當的安全控制並執行必要的安全性修補來防範蠕蟲攻擊

-   **Nimda Worm**（Nimda 蠕蟲）：2001 年出現的知名蠕蟲

    -   名稱為「admin」的反寫
    -   在僅僅 22 分鐘內就能夠傳播到整個網際網路
    -   特別驚人的是當時大多數網路連線非常緩慢，主要依靠撥號調製解調器

-   **Conficker Worm**（Conficker 蠕蟲）：2009 年出現的大規模蠕蟲

    -   感染了約 900 萬到 1500 萬台機器
    -   利用 Windows 作業系統中缺少關鍵安全補丁（Microsoft 補丁 08-067）的機器
    -   該安全補丁旨在解決 Windows 檔案和印表機共享中的軟體漏洞
    -   Conficker 會積極掃描組織內部網路及網際網路上的每個資源
    -   發現未安裝安全補丁的機器後，會執行惡意程式碼接管該機器並將其加入到更大的殭屍網路（botnet）
    -   資安專業人員成功在攻擊者利用殭屍網路進行惡意活動前將其關閉

-   **Botnet**（殭屍網路）：被蠕蟲感染的機器組成的網路
    -   攻擊者可以控制這些機器用於其他惡意目的
    -   Conficker 蠕蟲的目標之一是建立大規模殭屍網路

# Trojan（木馬）定義

一種偽裝成無害或用戶需要的軟體的惡意程式

-   源自希臘和特洛伊城戰爭的歷史典故，特洛伊木馬是希臘人給特洛伊城的「禮物」，內藏士兵
-   特洛伊木馬確實會執行宣稱的功能，但同時會執行惡意操作
-   常見惡意操作：安裝後門、植入病毒

## 木馬類型

-   **RAT (Remote Access Trojan)**（遠端存取特洛伊木馬）：一種廣泛被現代攻擊者使用的特洛伊木馬

    -   提供攻擊者對受害機器的遠端控制能力
    -   歷史案例：1980 年代流行的俄羅斯方塊遊戲被植入惡意程式
    -   允許攻擊者完全控制受害者電腦：登入系統、操控硬體（如開關光碟機）、翻轉螢幕等

-   **特洛伊木馬攻擊常見用途**：

    -   利用工作站中的漏洞
    -   進行數據竊取（Data Exfiltration）
    -   建立後門維持對系統的持續存取（Persistence）
    -   其他惡意活動

-   **防護措施**：
    -   下載程式前使用可靠的防毒或反惡意軟體進行檢查
    -   確保系統修補已知漏洞
    -   安裝或開啟下載的程式前進行安全檢查

# Ransomware（勒索軟體）定義

一種惡意軟體，通過加密電腦系統或數據阻止用戶訪問，直到支付贖金給攻擊者為止。

-   可視為數據資產的數位綁架行為
-   通常會顯示訊息要求支付贖金換取解密金鑰
-   贖金金額從幾百美元到數百萬美元不等，取決於受害者類型

## 重大案例

-   **Colonial Pipeline 攻擊**（2021 年）：

    -   美國主要燃料公司，運輸美國東岸近一半燃料供應
    -   勒索軟體攻擊導致管道關閉 5 天
    -   造成燃料短缺、恐慌性購買和油價上漲
    -   攻擊者（DarkSide）獲得約 440 萬美元比特幣作為贖金

-   **杜塞爾多夫大學醫院**（2020 年 9 月）：
    -   勒索軟體攻擊癱瘓醫院系統，導致急診患者轉移
    -   因轉移延誤，一名女性患者死亡
    -   成為首例直接與勒索軟體攻擊相關的死亡案例
    -   攻擊者發現錯誤目標後，提供解密金鑰而不要求贖金

## 防護策略

-   **定期備份**：

    -   同時使用實體設備和雲端儲存備份重要數據
    -   確保備份與主系統分離存儲，避免同時被加密
    -   提供復原數據的完整副本

-   **定期軟體更新**：

    -   更新操作系統和防毒程式，避免被利用漏洞
    -   案例：2017 年 WannaCry 勒索軟體攻擊成功是因 Windows 系統缺少 MS17-010 補丁

-   **安全意識培訓**：

    -   許多勒索軟體攻擊始於使用者點擊釣魚郵件連結
    -   培訓用戶對帶有附件或連結的未經請求的電子郵件保持警惕
    -   若有可疑，不應點擊

-   **多因素認證**（MFA）：
    -   為認證系統提供額外安全層
    -   增加攻擊者破壞用戶帳戶並安裝勒索軟體的難度

## 遭受攻擊時的應對措施

-   **不要支付贖金**：

    -   支付不保證能拿回數據
    -   獎勵犯罪行為並資助未來攻擊
    -   可能使你成為重複攻擊目標

-   **立即斷開網路連接**：

    -   隔離受感染機器，防止勒索軟體在網路中擴散

-   **通知當局**：

    -   勒索軟體攻擊是犯罪行為，應該報告
    -   遵循組織的事件響應流程決定是否報案

-   **從備份恢復系統**：
    -   確保勒索軟體完全清除後再恢復數據
    -   使用離線或異地備份快速恢復業務運作

# Botnet（殭屍網路）與 Zombie（殭屍電腦）定義

-   **Botnet**（殭屍網路）：由被惡意行為者遠端控制的受感染電腦或設備組成的網路，常用於發動網路攻擊或其他惡意活動。

    -   透過其他類型的惡意軟件來創建，攻擊者可以在未經用戶同意的情況下使用被感染系統的處理能力、記憶體、存儲或網路功能
    -   一個殭屍網路可能由數百、數千甚至數百萬個受感染的系統（Zombie）組成
    -   由一個主節點（master node）控制所有受感染的電腦

-   **Zombie**（殭屍電腦）：指被攻擊者遠端控制的單一受感染電腦或設備，是殭屍網路的一部分，不知情的情況下執行攻擊者的命令。

    -   當電腦被惡意軟件感染後，會被轉變為殭屍電腦並添加到更大的殭屍網路中
    -   殭屍電腦會完全受攻擊者控制，攻擊者可以通過命令和控制節點（C2 node）來操控

-   **C2 Node**（命令和控制節點）：攻擊者用來控制殭屍網路中所有殭屍電腦的中央控制點。

    -   攻擊者可以通過 C2 節點向殭屍電腦發送各種命令
    -   可以將殭屍電腦用作攻擊其他目標的跳板（pivot point）
    -   通過殭屍電腦進行的攻擊會看起來像是由殭屍電腦的擁有者發動的

-   **用途**

    -   **DDoS Attack**（分散式阻斷服務攻擊）：殭屍網路最常見的用途，多台機器同時針對單一目標進行攻擊。

        -   攻擊者可以命令數十萬台殭屍電腦同時向目標服務器發送請求
        -   大量請求會導致目標服務器負載過大而崩潰，使合法用戶無法使用該服務

    -   **殭屍網路的其他用途**：

        -   **儲存非法內容**：將非法內容分散存儲在多台受感染的電腦上，降低被發現的風險
        -   **發送垃圾郵件**：用於發送網路釣魚郵件和其他惡意軟件
        -   **加密貨幣挖礦**：利用殭屍電腦的處理能力進行加密貨幣挖礦，獲得的加密貨幣會被轉移到攻擊者的數位錢包中
        -   **破解加密方案**：使用殭屍網路的分布式計算能力來暴力破解各種加密方案

    -   **隱蔽技術**：
        -   攻擊者通常只會使用受感染電腦 20-25%的處理能力，而非 90-100%，以避免被察覺
        -   如果使用太多處理能力，用戶會注意到電腦變慢並可能發現感染

-   **防禦建議**：
    -   監控系統資源使用情況，留意處理器異常使用情形
    -   安裝並更新防毒軟件
    -   保持系統和應用程式更新以修補安全漏洞
    -   留意網路流量異常

# Rootkit（隱匿軟體）定義

一種特殊軟體，通常是由一系列工具組成，設計用於在不被偵測的情況下獲取電腦系統的管理員級控制權

-   允許攻擊者獲取最高權限（root 或 administrator），可以安裝、刪除程式、開關連接埠等
-   對攻擊者有利，但對系統安全性極為不利
-   非常難以被偵測，能夠執行惡意操作而不被管理員、使用者甚至作業系統本身察覺

-   **Permission Rings**（分級保護域）：電腦系統中不同的權限級別層，實務上不一定有確切分成幾層，根據不同作業系統設計有不同的分層

    -   **Ring 3**（環 3）：最外層，普通用戶權限操作層
    -   **Ring 2**（環 2）：中間層，部分特權指令
    -   **Ring 1**（環 1）：管理員/root 用戶操作層
    -   **Ring 0**（環 0）：核心層，最高權限層，又稱 Kernel Mode（核心模式）
    -   Rootkit 會嘗試進入 Ring 0，以隱藏自己並避免被偵測

-   **Kernel Mode**（核心模式）：操作系統中最信任且最有權限的模式

    -   控制對設備驅動程式、音效卡、顯示器等硬體的存取
    -   操作系統設計中最內層的分級保護域
    -   Rootkit 進入此層可造成最大破壞

-   **DLL Injection**（動態連結庫注入）：一種技術，通過強制加載動態連結庫，在另一個進程的地址空間中執行任意代碼

    -   用於將惡意代碼插入 Windows 機器上正在運行的進程中
    -   利用在運行時加載的動態連結庫執行

-   **Dynamic-Link Library**（動態連結庫，DLL）：代碼和資料的集合，可被多個程序同時使用

    -   允許軟體開發中的代碼重用和模組化
    -   Windows 作業系統默認提供許多 DLL
    -   Rootkit 可以嵌入在 DLL 中，讓系統每次啟動時自動加載

-   **Shim**（墊片）：放置在兩個組件之間的軟體代碼

    -   攔截組件間的調用並能重定向這些調用
    -   Rootkit 用它來攔截 Windows 作業系統和動態連結庫之間的通信，重定向到惡意代碼

-   **Rootkit 偵測與移除**：
    -   常規防毒和反惡意軟體解決方案難以偵測
    -   最有效的方法是從外部設備啟動（如 Linux Live 啟動盤）
    -   使用良好的反惡意軟體掃描解決方案掃描內部硬碟或固態硬碟
    -   需要持續的警惕和實施強健的安全措施

# Backdoor（後門）相關概念

-   **Backdoor**（後門）：一種被放入電腦程式中，用來繞過正常安全和驗證功能的隱藏入口

    -   起源於 1980 年代，當時製造商和程式設計師為了方便進行系統維護和修復，而不必通過正常的身份驗證和防火牆
    -   在現代網路中，被視為違反安全編碼最佳實踐的行為
    -   雖然大多數軟體已移除後門，但某些惡意程式仍具有後門功能

-   **Remote Access Trojan**（遠端存取木馬）：由威脅行動者放置的惡意程式，用於維持對系統的持續訪問
    -   當攻擊者成功誘使用戶點擊釣魚郵件連結時，可安裝此類惡意程式
    -   建立回撥連接，允許攻擊者繞過系統的默認安全狀態
    -   功能類似後門，使攻擊者能隨時訪問目標系統

## 彩蛋與邏輯炸彈

-   **Easter Egg**（彩蛋）：程式設計師添加到軟體中的隱藏功能或新奇元素

    -   通常作為一種玩笑或驚喜給使用者
    -   例如：Google 搜尋引擎中輸入"do a barrel roll"會觸發頁面 360 度旋轉
    -   雖然通常無害，但可能增加應用程式的代碼量，創造額外的漏洞
    -   彩蛋代碼通常在產品發布前倉促添加，未經過嚴格的安全測試

-   **Logic Bomb**（邏輯炸彈）：一種插入程式中的惡意代碼，只有在特定條件滿足時才會執行
    -   被視為彩蛋的惡意演變
    -   典型案例：一位心懷不滿的員工在被解僱後，設置系統自動執行惡意行為，如刪除文件或盜取資金
    -   電影《侏羅紀公園》中的例子：程式設計師設置邏輯炸彈，在特定時間關閉電網以便盜竊恐龍胚胎

## 最佳實踐

-   現代應用程式開發中，應避免使用後門、彩蛋和邏輯炸彈
    -   這些做法違反安全編碼標準和最佳實踐
    -   建議掃描客戶開發的應用程式，確保不含這三種元素
    -   這有助於確保組織網路的最高安全性

# 鍵盤記錄器 (Keylogger) 定義

一種惡意軟體或硬體，用於記錄電腦或行動裝置上的每一個按鍵輸入。

-   最初由系統管理員開發用於排解技術問題，後被網路犯罪者武器化
-   能夠在不知情或未經同意的情況下捕獲輸入的每一個字母、密碼和網路搜索，並傳送給威脅行為者
-   被視為網路犯罪者獲取個人和財務數據的簡單而有效的機制
-   可能導致身份盜竊、財務詐騙和企業間諜活動

## 鍵盤記錄器的類型

-   **Software-based keylogger**（軟體型鍵盤記錄器）：安裝在受害者電腦上的惡意程式。

    -   通常與其他軟體一起捆綁或透過釣魚、假冒等社交工程攻擊傳遞
    -   可以逃避防毒軟體偵測，特別是當攻擊者使用複雜的迴避技術時
    -   在背景中靜默運作，捕獲每一次按鍵輸入並傳送回由威脅行為者控制的遠端伺服器

-   **Hardware keylogger**（硬體型鍵盤記錄器）：需要實體插入電腦的設備。
    -   通常外形類似 USB 隨身碟，或嵌入鍵盤線中
    -   難以大規模部署，但對於針對性攻擊非常有效
    -   免疫於軟體偵測方法（如防毒掃描）
    -   電腦會將其識別為正常鍵盤，無法感知被硬體鍵盤記錄器攻擊

## 鍵盤記錄器的風險

-   **個人風險**：

    -   用戶名、密碼、信用卡號碼和其他敏感信息被盜
    -   可能導致未經授權的銀行交易、未授權購物或完全的身份盜竊

-   **企業風險**：
    -   受感染員工可能無意中洩露登入憑證、機密電子郵件內容、公司專有數據或戰略計劃
    -   可能造成財務損失、組織聲譽受損、法律後果，並失去市場競爭優勢

## 防範鍵盤記錄器的方法

-   **定期更新和修補系統**：

    -   保持作業系統和軟體更新，確保已知漏洞不被鍵盤記錄器利用

-   **使用高品質的防毒和反惡意軟體解決方案**：

    -   投資全面的安全軟體，能夠檢測和隔離系統上安裝的鍵盤記錄軟體
    -   定期進行防毒和反惡意軟體掃描

-   **針對終端用戶進行釣魚意識培訓**：

    -   由於鍵盤記錄器常透過釣魚郵件分發，培訓組織用戶謹慎下載附件和點擊未知或不可信發件人的連結

-   **實施多因素認證（MFA）**：

    -   即使密碼被鍵盤記錄器捕獲，威脅行為者也無法訪問系統，因為需要額外驗證步驟
    -   驗證方式包括認證應用程式代碼、一次性簡訊或生物識別（指紋或臉部掃描）

-   **加密傳送至系統的按鍵輸入**：

    -   某些安全軟體可以透過按鍵加密保護系統，在發送前混淆輸入的信息
    -   若數據被鍵盤記錄器捕獲，也會以密文形式出現，對威脅行為者無用

-   **執行實體檢查**：
    -   在敏感環境中尤為重要，定期檢查系統硬體是否有可能含有硬體鍵盤記錄器的不熟悉設備

# 間諜軟體（間諜軟體）與膨脹軟體（Bloatware）

-   **Spyware**（間諜軟體）：一種惡意軟體，設計用來在使用者不知情的情況下收集和傳送有關使用者或組織的信息。

    -   收集的信息範圍：從瀏覽習慣、軟體使用模式到密碼、信用卡號碼等敏感資料
    -   安裝途徑：
        -   與其他軟體捆綁安裝
        -   通過惡意網站安裝
        -   點擊欺騙性彈出廣告
    -   運作特性：在後台運行，不經用戶知情或同意
    -   負面影響：
        -   侵犯隱私
        -   顯著降低系統性能
        -   持續消耗系統資源
    -   防護措施：
        -   使用信譽良好的防毒和反間諜軟體
        -   只從可信來源下載軟體
        -   閱讀 **EULA**（最終用戶許可協議）
        -   保持作業系統和應用程式更新

-   **Bloatware**（膨脹軟體）：預裝在新電腦或智慧型手機上，用戶未特別要求、不需要或不想要的軟體。

    -   特性：
        -   通常不具危險性，但會消耗寶貴的設備資源
        -   佔用儲存空間和 **RAM**（隨機存取記憶體）
    -   安裝原因：
        -   廠商或供應商的促銷合作關係
        -   作為市場營銷技巧（例如：Microsoft Office 365 的 30 天免費試用版、Norton Antivirus 的 90 天免費試用版）
    -   常見形式：不必要的工具列或促銷特定服務的應用程式
    -   負面影響：
        -   浪費儲存空間
        -   降低設備性能
        -   引入新的安全漏洞（代碼中可能存在 bug）
    -   移除方法：
        -   手動移除（通過控制面板或設備設定）
        -   使用膨脀軟體移除工具
        -   執行乾淨的作業系統安裝（推薦方法）

-   **Attack Surface**（攻擊面）：每安裝一個軟體，就會增加一個潛在的威脅向量，供攻擊者利用。

    -   最佳實踐：移除任何非日常使用的額外軟體或應用程式，以最小化設備和系統的攻擊面

-   **Clean Operating System Installation**（乾淨的作業系統安裝）：購買新設備時，不使用預裝的作業系統和膨脀軟體，而是重新安裝作業系統。
    -   優點：確保系統只有所需的軟體

# 惡意軟體攻擊技術

利用特定的方法，讓惡意程式碼滲透和感染目標系統

-   傳統惡意軟體通常會修改可執行檔案或在文件中插入惡意巨集

## 惡意軟體的演變

-   **Traditional Malware**（傳統惡意軟體）：透過修改可執行檔或文件內巨集進行感染
    -   以檔案系統為基礎，每次開啟檔案時觸發惡意行為
-   **Worms**（蠕蟲）：專注於感染系統記憶體

    -   利用遠端程序呼叫（RPC）透過組織網路傳播惡意程式碼

-   **Fileless Malware**（無檔案惡意軟體）：現代惡意軟體的演進
    -   直接以腳本或簡短的殼層程式碼執行惡意行為
    -   繞過基於簽章的安全系統（如防毒軟體和反惡意軟體解決方案）
    -   在系統記憶體中創建程序而不依賴本地檔案系統
    -   較難被偵測，因為留下的痕跡（指標）很少
    -   某些變種可能暫時寫入數據到系統，但會在執行完畢後清除這些痕跡

## 現代惡意軟體操作模式

-   **Two-stage Deployment Model**（兩階段部署模型）：現代惡意軟體使用的基本部署模型
    -   第一階段：當使用者點擊惡意連結或開啟惡意檔案時被觸發
    -   第二階段：安裝遠端存取木馬，為攻擊者提供命令和控制能力

## 惡意軟體組件

-   **Dropper**（投放器）：專門用於在受感染主機上啟動或執行其他形式惡意軟體的特定類型

    -   作為惡意軟體感染的第一階段

-   **Downloader**（下載器）：在初始感染後，負責取得額外攻擊工具的組件

    -   協助攻擊者安裝遠端存取木馬（RAT）

-   **Shell Code**（殼層程式碼）：泛指在目標系統上執行漏洞利用的輕量級程式碼

    -   通常作為第一階段感染的執行載體

-   **Remote Access Trojan**（遠端存取木馬）：提供攻擊者對受害系統的命令和控制能力
    -   透過第二階段下載器安裝到系統中

## 攻擊者行動階段

-   **Consolidation**（鞏固階段）：攻擊者鞏固在系統上的位置

    -   使用遠端存取工具識別並感染網路中的其他系統
    -   尋找高價值目標（如伺服器或網域控制器）以獲得更強大的立足點

-   **Action on Objectives**（目標實現階段）：執行攻擊者的主要目標

    -   可能包括數據竊取、檔案加密（勒索軟體攻擊）等惡意活動

-   **Concealment**（隱蔽階段）：延長未經授權的訪問時間
    -   透過隱藏足跡、清除日誌檔案和隱藏惡意活動證據

## 惡意軟體部署技術

-   **Code Injection**（程式碼注入）：將惡意程式碼偽裝成合法程序運行的技術

    -   使惡意行為能以合法程序的身分執行

-   **Masquerading**（偽裝）：讓惡意軟體看起來像是合法軟體的技術

-   **DLL Injection**（DLL 注入）：將惡意 DLL 注入合法程序的技術

-   **DLL Sideloading**（DLL 側載）：利用 Windows 動態連結庫搜尋順序漏洞

-   **Process Hollowing**（進程挖空）：用惡意程式碼替換正常進程內容的技術

## 反取證技術與先進策略

-   **Anti-forensic Strategies**（反取證策略）：使惡意軟體更難被分析的技術

    -   包含加密、壓縮和混淆等方法

-   **Living Off the Land**（就地取材）：利用系統內建工具進行攻擊的高級策略
    -   被許多高級持續性威脅（APT）和犯罪組織採用
    -   利用如 PowerShell 等標準系統工具進行惡意活動
    -   由於使用的是系統原生工具，因此很難被偵測出惡意行為

# 惡意軟體攻擊的常見指標

以下是九種常見的惡意軟體攻擊指標，可幫助資安專業人員及早發現攻擊並減輕損害：

-   **Account Lockouts**（帳戶鎖定）：使用者帳戶被鎖定的狀態

    -   通常是由於憑證竊取或暴力攻擊導致多次登入失敗
    -   若突然出現大量用戶無法存取帳戶，或企業網路中鎖定帳戶激增，可能表示惡意軟體攻擊正在進行

-   **Concurrent Session Utilization**（同時工作階段使用）：同一用戶帳戶同時有多個活動工作階段

    -   用戶通常在任何時候只應有一個活動工作階段
    -   若單一帳戶有多個同步或同時工作階段，尤其是來自不同地理位置，應引起高度警覺
    -   可能表明惡意軟體已劫持用戶帳戶並用於惡意活動

-   **Blocked Content**（被封鎖的內容）：安全工具攔截的有害內容

    -   現代網路安全工具能夠阻擋已知的惡意內容（如特定類型的檔案或連結）
    -   若安全工具顯示被封鎖內容警報突然增加，可能表示惡意軟體已成功滲透系統

-   **Impossible Travel**（不可能的旅行）：用戶帳戶在短時間內從地理上相距甚遠的地點登入

    -   例如，用戶 10 分鐘前在奧蘭多登入，現在卻從紐約登入（實際需要約 3 小時飛行時間）
    -   通常表示用戶帳戶已被入侵，可能是惡意軟體攻擊的結果，攻擊者成功獲取了用戶憑證

-   **Resource Consumption**（資源消耗）：系統資源使用異常增加

    -   許多形式的惡意軟體（如加密挖礦程式、殭屍網路和蠕蟲）會消耗大量系統資源
    -   如觀察到 CPU、記憶體或網路頻寬利用率不尋常的激增，且無法與合法工作關聯，可能是惡意軟體攻擊的指標
    -   資源高消耗通常會導致系統變慢，使惡意軟體感染更加明顯

-   **Resource Inaccessibility**（資源無法訪問）：無法訪問系統資源或檔案

    -   勒索軟體是一種會加密用戶檔案使其無法存取的惡意軟體
    -   如果大量檔案或關鍵系統突然無法存取，或用戶收到要求付款解密資料的訊息，這是勒索軟體攻擊的明確跡象

-   **Out-of-cycle Logging**（週期外日誌記錄）：非常規時間產生的日誌

    -   若在奇怪時段（如深夜無員工工作時間）產生日誌，可能表示遭受惡意軟體攻擊
    -   可能揭示攻擊者正在進行未經授權的資料傳輸或系統修改
    -   定期檢查日誌有助於檢測此類感染

-   **Missing Logs**（缺失的日誌）：系統日誌被刪除或出現缺口

    -   威脅行為者通常會刪除系統日誌以隱藏入侵痕跡
    -   若日誌中出現大段缺口或未經授權被完全清除，可能表示有惡意活動或惡意軟體攻擊
    -   通常意味著有人試圖掩蓋其行動軌跡

-   **Published or Documented Attacks**（已發布或記錄的攻擊）：公開報導的攻擊
    -   若網路安全研究人員或記者發布報告顯示組織網路已感染惡意軟體，這將成為被攻擊的明確通知
    -   理想情況下，組織的資安專業人員應在新聞報導前發現惡意軟體感染
