# 密碼學與加密技術

-   **Cryptography**（密碼學）：編寫和解決代碼以隱藏資訊真正含義的實踐。

    -   密碼學最常被用作加密的一種形式。
    -   古代中國周朝兵書《六韬》中的《陰符》和《陰書》已記載密碼學的運用

-   **Encryption**（加密）：將普通資訊（明文）轉換為不可讀（密文）的過程。
    -   未持有金鑰的人無法閱讀加密內容。
    -   持有金鑰的人可將密文轉回明文並閱讀。

## 資料保護狀態

-   **Data at rest**（靜態資料）：用於加密非活動資料，如硬碟或儲存裝置上的資料。

    -   指的是靜態存放的檔案資料。

-   **Data in transit**（傳輸中的資料）：指在網路上傳輸或在電腦記憶體（RAM）中移動的資料。

    -   包括從儲存裝置移動到處理器的資料。

-   **Data in use**（使用中的資料）：處於不斷變化狀態的資料。
    -   如正在處理器中進行計算的資料。

## 加密概念示例

-   **ROT13 cipher**（ROT13 密碼）：一種簡單的替換密碼，將字母向右移動 13 位。
    -   例如：C 轉換為 P，R 轉換為 E。
    -   這種簡單的加密方式展示了加密的基本原理。

## 加密核心要素

-   **Algorithm**（演算法）：執行加密或解密功能的密碼（演算法）。

    -   加密演算法是一種數學函數，將輸入轉換為加密輸出。
    -   幾乎所有現代加密演算法都經過公開審核，任何人都能了解其運作方式。

-   **Key**（金鑰）：決定密碼輸出的關鍵資訊。

    -   在 ROT13 示例中，金鑰是"13"（移動 13 位）。
    -   加密的安全性主要來自金鑰，而非演算法。
    -   金鑰越長，安全程度越高，抵抗暴力破解能力越強。
    -   128 位金鑰對大多數應用已足夠安全，而 256 位金鑰提供指數級更高的保護。

-   **Key rotation**（金鑰輪替）：定期更換加密金鑰的最佳實踐。
    -   減少未授權解密的風險。
    -   許多組織實施每年輪替 TLS（傳輸層安全）金鑰的政策。
    -   某些雲端服務提供商會每 90 天自動輪替金鑰。

## 加密演算法分類

-   **Symmetric encryption**（對稱加密）：使用相同金鑰進行加密和解密。

    -   包括：DES、3DES、IDEA、AES、Blowfish、Twofish 和 Rivest 密碼系列。

-   **Asymmetric encryption**（非對稱加密）：使用一對金鑰（公鑰和私鑰）進行加密和解密。
    -   包括：Diffie-Hellman、RSA 和橢圓曲線加密（ECC）。

## 雜湊技術

-   **Hashing**（雜湊）：將資料轉換為固定大小的字元字串（訊息摘要 Digest）的過程。
    -   使用雜湊函數產生。
    -   常見演算法：MD5、SHA 系列、RIPEMD 和 HMAC。

## 加密基礎設施

-   **Public Key Infrastructure (PKI)**（公鑰基礎設施）：管理數位金鑰和憑證的框架，確保安全資料傳輸和身份驗證。

-   **Digital certificates**（數位憑證）：由受信任機構發行的電子憑證，用於驗證實體身份並提供安全通訊的方法。

## 區塊鏈技術

-   **Blockchain**（區塊鏈）：去中心化、不可變的分類帳，記錄分布於多台電腦的交易，確保資料完整性和透明度。
    -   相關概念：公共分類帳、加密貨幣、數位控制和供應鏈管理。

## 加密工具

-   **TPM (Trusted Platform Module)**（可信平台模組）：確保資料安全性和完整性的工具。

-   **HSM (Hardware Security Module)**（硬體安全模組）：專用設備，用於安全管理密碼金鑰。

-   **Key management systems**（金鑰管理系統）：管理加密金鑰生命週期的系統。

-   **Secure enclaves**（安全隔離區）：提供隔離區域進行敏感操作的技術。

## 混淆技術

-   **Steganography**（隱寫術）：在普通非機密檔案或訊息中隱藏機密資料的做法，避免被偵測。

-   **Tokenization**（令牌化）：用無意義的等效物（令牌）替代敏感資料元素。

-   **Data masking**（資料遮罩）：偽裝原始資料以保護敏感資訊，同時保持其真實性和可用性。

## 加密攻擊類型

-   **Downgrade attacks**（降級攻擊）：迫使系統使用較弱的加密協議。

-   **Collision attacks**（碰撞攻擊）：嘗試找出產生相同雜湊值的不同輸入。

-   **Birthday attacks**（生日攻擊）：基於生日悖論的雜湊攻擊。

-   **Quantum-based cryptographic attacks**（量子加密攻擊）：利用量子計算威脅現有加密演算法。

## 加密系統安全實踐

-   金鑰必須嚴格保護，因為它們是加密系統的安全核心。
-   加密金鑰應存儲在安全硬體模組中，靜態時加密，傳輸時安全傳輸。
-   對金鑰的訪問應嚴格限制，進行定期審計和監控。
-   公開審查的演算法比保密演算法更可靠（避免"通過隱蔽獲得安全"的不可靠方法）。

# 對稱加密 vs 非對稱加密（Symmetric VS Asymmetric Encryption）

加密密碼的基本分類方式，根據其使用的演算法和用於保護資料的金鑰類型進行分類。所有加密演算法都可歸類為對稱或非對稱加密。

## 對稱加密

-   **Symmetric Key Encryption**（對稱金鑰加密）：使用單一金鑰來加密和解密資料的加密方式。

    -   也稱為**Private Key Encryption**（私鑰加密）或**Private Key Algorithms**（私鑰演算法）。
    -   發送者和接收者需要知道相同的共享密鑰（shared secret）。
    -   生活中的例子：家門鑰匙 - 相同的鑰匙可用於上鎖和開鎖。

-   **Shared Secret Key**（共享密鑰）：在對稱加密中，所有授權使用者共同持有的密鑰。

    -   可以確保資料的機密性（confidentiality），因為只有擁有密鑰的人才能存取資料。
    -   無法保證不可否認性（non-repudiation），因為無法確定是哪個持有密鑰的人使用了系統。

-   **Key Distribution Problem**（密鑰分發問題）：對稱加密面臨的主要挑戰。
    -   當使用者數量增加時，需要的密鑰對數呈指數增長（n 人需要 n(n-1)/2 個密鑰對）。
    -   例如：5 位好友間互相通訊需要 15 組不同的密鑰。
    -   無線網路密碼就是一種共享密鑰，當分享給太多人時會降低安全性。

## 非對稱加密

-   **Asymmetric Algorithms**（非對稱演算法）：使用兩個不同金鑰的加密演算法。

    -   也被稱為**Public Key Cryptography**（公開金鑰密碼學）。
    -   一個金鑰用於加密資料，另一個金鑰用於解密資料。
    -   不需要共享密鑰，解決了對稱加密的密鑰分發問題。

-   **Common Asymmetric Algorithms**（常見的非對稱演算法）：
    -   **Diffie-Hellman Algorithm**（迪菲-赫爾曼演算法）
    -   **RSA**（RSA 演算法）
    -   **Elliptic Curve Cryptography (ECC)**（橢圓曲線密碼學）

## 對稱與非對稱加密比較

-   **Performance**（效能）：對稱演算法通常比同等安全級別的非對稱演算法快 100 至 1000 倍。

-   **Hybrid Approach**（混合方法）：結合對稱和非對稱加密的優點。
    -   使用非對稱（公開金鑰）加密來安全地分享對稱加密的共享密鑰。
    -   使用對稱加密來保護實際的資料傳輸，提高處理速度。
    -   這種混合方法結合了兩種技術的優勢。

## 加密分類方式

-   **Stream Cipher**（串流加密）：一種逐位元或逐位元組加密的演算法。

    -   逐位元處理資料。
    -   使用金鑰串流產生器（key stream generator）創建位元流。
    -   透過 XOR 函數將位元流與明文混合產生密文。
    -   適合保護即時通訊資料流，如串流音訊或影片。
    -   通常是對稱演算法。
    -   主要應用於硬體解決方案。

-   **Block Cipher**（區塊加密）：將輸入分為固定長度的資料區塊再進行加密的演算法。
    -   加密前將資料分割成固定大小的區塊（如 64、128 或 256 位元）。
    -   若資料不足一個區塊，會添加額外填充（padding）。
    -   比串流加密更容易設置和實作。
    -   對安全問題的敏感度較低。
    -   易於透過軟體解決方案實現。

# 常見對稱加密演算法

-   **DES (Data Encryption Standard)**（資料加密標準）：使用 64 位元密鑰（實際有效長度為 56 位元）的加密標準。

    -   1970 年代至 2000 年代初期被廣泛使用
    -   將訊息分割成 64 位元區塊，經過 16 輪替換和置換操作產生密文
    -   由於密鑰長度短，現代計算能力已可以輕易破解

-   **3DES (Triple DES)**（三重 DES）：DES 的改良版本，使用三個不同的 56 位元密鑰。

    -   加密過程為：用第一把密鑰加密 → 用第二把密鑰解密（進一步擾亂資料）→ 用第三把密鑰加密
    -   有效密鑰長度為 112 位元
    -   比原始 DES 更安全，但比 AES 慢且效率低

-   **IDEA (International Data Encryption Algorithm)**（國際資料加密算法）：使用 64 位元區塊和 128 位元密鑰的對稱區塊加密。

    -   比 DES 更難破解，但不如 AES 普及
    -   主要在 PGP（Pretty Good Privacy）工具套件中使用
    -   曾參與 NIST 舉辦的替代 DES 的競賽，但未獲勝

-   **AES (Advanced Encryption Standard)**（高級加密標準）：美國政府通過 NIST 選定的 DES 和 3DES 替代品。

    -   也被稱為 Rijndael 算法（以其創造者命名）
    -   提供 128 位元、192 位元或 256 位元密鑰選項
    -   目前對稱密鑰加密的實際標準
    -   用於美國政府敏感但非機密信息的加密標準
    -   AES 已取代了舊有的 DES 標準

-   **Blowfish**（河豚加密）：使用 32 到 448 位元加密密鑰的區塊加密，每次處理 64 位元資料。

    -   原本設計為 DES 替代品，但未被廣泛採用
    -   開源且未申請專利

-   **Twofish**（雙魚加密）：處理 128 位元區塊的加密算法。

    -   支持 128 位元、192 位元或 256 位元加密密鑰
    -   與 Blowfish 一樣，開源且未申請專利

-   **RC (Rivest Cipher) 系列**（Rivest 加密系列）：由密碼學家 Ron Rivest 設計的六種算法。
    -   RC1 從未公開發布
    -   RC2 被視為不安全而被跳過
    -   RC3 在公開發布前就被破解
    -   RC4 是一種流加密，使用 40 至 2,048 位元的可變密鑰大小
        -   被用於 SSL（安全套接層）和 WEP, Wired Equivalent Privacy（有線等效加密）
        -   是本課討論的唯一一種流加密
    -   RC5 是一種區塊加密，使用最大 2,048 位元的密鑰
    -   RC6 基於 RC5，但更強大且更先進
        -   曾參與 NIST 替代 DES 的競賽，但輸給了 Rijndael（AES）

## 重要概念

-   對稱加密算法可分為**區塊加密**和**流加密**
    -   RC4 是唯一的流加密，其餘都是區塊加密
-   AES 目前是最常用且最強大的對稱加密算法

# 常見非對稱加密演算法

-   **Diffie-Hellman**（迪菲-赫爾曼金鑰交換）：用於金鑰交換和安全金鑰分發的一種安全協定

    -   用於讓雙方在完全沒有對方任何預先資訊的條件下通過不安全通道建立起一個金鑰
    -   廣泛應用於建立 VPN 通道或其他加密通道
    -   容易受到中間人攻擊（on-path/person-in-the-middle attacks）
    -   需要額外身分驗證（如密碼或數位證書）來提高安全性

-   **RSA**（RSA 加密演算法）：以發明者 Ron Rivest、Adi Shamir 和 Leonard Adleman 命名

    -   用於金鑰交換、加密和數位簽章
    -   依賴大質數因式分解的數學難題
    -   支援 1024 位元至 4,096 位元的金鑰大小
    -   常見於安全令牌（secure token）用於多因素認證

-   **ECC**（Elliptic Curve Cryptography，橢圓曲線加密）：基於橢圓曲線代數結構
    -   比同等大小的 RSA 金鑰提供更佳安全性（約六倍效率）
    -   256 位元 ECC 金鑰 ≈ 2,048 位元 RSA 金鑰
    -   適用於行動裝置和低功耗計算設備
    -   主要變種：
        -   **ECDH**（Elliptic Curve Diffie-Hellman）：ECC 版本的迪菲-赫爾曼協議
        -   **ECDHE**（Elliptic Curve Diffie-Hellman Ephemeral）：使用臨時金鑰的變種
        -   **ECDSA**（Elliptic Curve Digital Signature Algorithm）：美國政府採用的數位簽章演算法

## 非對稱加密的安全功能

-   **Confidentiality**（機密性）：使用接收者的公鑰加密

    -   只有接收者擁有私鑰能解密
    -   即使發送者也無法解密已加密的訊息
    -   是一種單向加密（one-way encryption）

-   **Non-repudiation**（不可否認性）：使用發送者的私鑰加密

    -   確保訊息確實由特定發送者發出
    -   任何人都可使用發送者的公鑰解密，但無法提供機密性

-   **Digital Signature**（數位簽章）：提供完整性和不可否認性
    -   過程：先對訊息建立雜湊摘要（hash digest）
    -   使用發送者私鑰加密該雜湊摘要
    -   提供訊息完整性和發送者身分不可否認性

# 雜湊、哈希（Hashing）

一種單向加密函數，接收輸入並產生唯一的訊息摘要作為輸出。

-   因為是單向函數，無法從訊息雜湊或雜湊摘要推導出原始訊息
-   產生的訊息摘要可作為原始檔案的數位指紋
-   無論輸入長度如何，輸出長度始終相同（取決於所選的雜湊算法）
-   即使輸入僅有微小變化，輸出的雜湊值也會發生顯著不同

## 主要雜湊演算法

-   **MD5**（Message Digest 5）：過去最流行和廣泛使用的雜湊算法。

    -   創建 128 位元的雜湊值
    -   由於位元數有限，可能導致碰撞（兩個不同檔案產生相同的雜湊摘要）
    -   安全性較低，現已不推薦用於安全用途

-   **SHA 家族**（Secure Hash Algorithm）：因 MD5 限制而創建的更安全算法。

    -   **SHA-1**：創建 160 位元雜湊摘要，比 MD5 碰撞率低
        -   已遭破解，不建議用於安全用途
    -   **SHA-2**：包含多個雜湊函數，如 SHA-224、SHA-256、SHA-384 和 SHA-512
        -   雜湊摘要長度從 224 至 512 位元不等
        -   執行 64 至 80 輪數學計算來創建雜湊摘要
    -   **SHA-3**：更新的雜湊函數家族
        -   雜湊摘要長度同樣為 224 至 512 位元
        -   安全性更高，使用 120 輪計算來創建訊息摘要
        -   比 SHA-2 更安全

-   **RIPEMD**（Race Integrity Primitive Evaluation Message Digest）：開源雜湊算法。

    -   有 160 位元、256 位元和 320 位元版本
    -   RIPEMD-160 最常用
    -   作為 SHA 家族的競爭對手，但未獲得同等普及度

-   **HMAC**（Hash-based Message Authentication Code）：用於檢查訊息完整性並提供真實性保證。
    -   會與其他算法配對使用，如 HMAC-MD5、HMAC-SHA1 或 HMAC-SHA256
    -   根據底層使用的雜湊算法命名

## 數位簽章與應用

-   **Digital Signature**（數位簽章）：確保檔案或訊息在網路傳輸過程中完整性的機制。

    -   通過雜湊檔案並使用私鑰加密所得的雜湊摘要來創建
    -   接收方使用發送方的公鑰解密數位簽章，然後比較雜湊值
    -   提供完整性檢查和不可否認性（Non-repudiation）
    -   不可否認性確保發送者無法否認曾發送該訊息

-   **數位簽章實用演算法**：

    -   **DSA**（Digital Security Algorithm）：美國聯邦政府使用的數位安全標準（DSS）的一部分
    -   **RSA**（Rivest-Shamir-Adleman）：商業實體常用，速度較快且可用於數位簽章、加密和金鑰分發
    -   **ECC**（Elliptic Curve Cryptography）：DSA 或 SHA 的橢圓曲線加密版本

-   **Code Signing**（代碼簽署）：檔案數位簽章的擴展應用。
    -   用於軟體和應用程序安裝檔案
    -   開發人員需向平台（如 Apple 或 Google）註冊並獲得私鑰
    -   確保安裝程序自發布以來未被修改或損壞

## 雜湊特性與安全性

-   **碰撞**（Collision）：當兩個不同的輸入產生相同雜湊值時發生。

    -   雜湊算法的位元長度越短（如 MD5 的 128 位元），碰撞可能性越大
    -   雜湊空間越大（如 SHA-256 或 SHA-512），碰撞可能性越小
    -   這也是為何現代應用多採用 SHA-256 或 SHA-512 等更安全的算法

-   **完整性驗證**：雜湊用於驗證資料在傳輸過程中未被更改。

    -   若雜湊值匹配，可確定資料未被更改
    -   任何微小變化（如單個字元）都會導致雜湊值顯著不同

-   **（補充）彩虹表**（Rainbow Table）：用於破解雜湊碰撞的演算法。

    -   將雜湊值和常見字串一一對應，從而能夠實現雜湊反向查詢（Reverse Lookup）
    -   通常用於經常被使用的密碼（password, apple, banana...）

# 增強雜湊安全性

## 雜湊攻擊類型

-   **Pass-the-Hash Attack**（傳遞雜湊攻擊）：一種駭客技術，允許攻擊者使用用戶密碼的雜湊值向遠端伺服器或服務進行身份驗證，而無需知道明文密碼。

    -   攻擊者只需獲取雜湊值，無需破解還原為明文密碼
    -   攻擊者可重用雜湊值模擬用戶身份進行認證
    -   雜湊在功能上等同於原始密碼
    -   難以防禦，因為 Windows 作業系統和應用程式存在眾多潛在漏洞
    -   域環境中僅需一台機器配置錯誤或缺少關鍵安全補丁即可實施此攻擊
    -   Mimikatz 等滲透工具可自動化收集雜湊並執行攻擊

-   **Birthday Attack**（生日攻擊）：攻擊者嘗試找出兩個不同的訊息經過雜湊演算法後產生相同的雜湊摘要，其實就是一種「碰撞」的實現。
    -   基於生日悖論（Birthday Paradox）：隨機人群中有兩人同一天生日的機率非常高
        -   57 人群體中有 99%機率出現兩人生日相同
        -   23 人群體中有約 50%機率出現碰撞
    -   若攻擊者找到與目標密碼雜湊值相同的碰撞，可繞過身份驗證系統
    -   使用較長輸出摘要的雜湊函數（如 SHA-256 而非 MD5）可減少碰撞發生率

## 增強雜湊安全性的方法

-   **Key Stretching**（金鑰延展）：一種用於增強較弱金鑰安全性的技術，通過增加破解所需時間來提高安全性。

    -   將較弱的金鑰透過演算法處理，創建更長、更安全的金鑰
    -   廣泛應用於 WPA、WPA2、PGP 等系統，以減輕短金鑰的固有弱點

-   **Salting**（加鹽）：在密碼進行單向加密雜湊前，添加隨機數據（稱為「鹽值」）的過程。

    -   確保即使兩個用戶使用相同密碼，其雜湊輸出也會因不同的鹽值而不同
    -   能有效抵禦多種密碼破解策略：
        -   字典攻擊：鹽值改變常用密碼的雜湊結果
        -   暴力破解攻擊：使破解過程更耗時
        -   彩虹表攻擊：攻擊者需為每個鹽值計算新表，使攻擊變得不切實際

-   **Nonce**（臨時數字）：一種增強密碼安全性的策略，為「Number Used Once」（僅使用一次的數字）的縮寫。

    -   是添加到基於密碼的身份驗證過程中的獨特隨機數
    -   確保即使攻擊者獲取密碼或相應的身份驗證數據，也無法重複使用
    -   每次身份驗證序列中添加此臨時數字，使結果雜湊數據每次都不同
    -   特別有效防禦重放（replay）攻擊

-   **限制登入嘗試次數**：配置系統限制用戶的失敗登入嘗試次數。
    -   建議設定較低的錯誤密碼輸入次數上限（如 3 次）
    -   超過限制後自動鎖定帳戶
    -   雖可能造成用戶不便，但能大幅提高安全性
    -   有效減緩攻擊者嘗試猜測用戶密碼的速度

## 防範建議總結

-   確保只有受信任的作業系統能夠連接到伺服器
-   Windows 域環境中正確設置信任關係
-   工作站需及時修補更新
-   正確使用多因素身份驗證
-   遵循最小權限原則設置用戶帳戶
-   採用更安全的雜湊演算法（如 SHA-256）
-   實施金鑰延展、加鹽和臨時數字等技術增強雜湊安全性
-   限制失敗登入嘗試次數

# 公鑰基礎設施 (Public Key Infrastructure, PKI)

一組由硬體、軟體、參與者、管理政策與流程組成的基礎架構，用於創造、管理、分配、使用、儲存以及復原數位憑證

-   任何使用 HTTPS 連接網站的人都已經是 PKI 的一部分

## PKI 工作流程

-   **建立安全連線的過程**：
    -   當瀏覽器連接到 HTTPS 網站
    -   瀏覽器向憑證授權機構(CA)獲取網站伺服器的公鑰
    -   瀏覽器產生隨機密碼（共享密鑰）
    -   使用網站公鑰加密該隨機密碼
    -   加密後的資料透過網路傳送至網站伺服器
    -   網站伺服器使用私鑰解密，獲取共享密鑰
    -   雙方使用該共享密鑰透過對稱加密建立安全通道(TLS/SSL)
    -   通道建立後，瀏覽器會顯示鎖頭圖示，表示連線安全

## PKI 與公鑰密碼學的區別

-   **Public Key Cryptography（公鑰密碼學）**：僅指加密和解密過程
    -   為 PKI 架構的一小部分
-   **PKI（公鑰基礎設施）**：
    -   完整系統，負責創建非對稱密鑰對（公鑰和私鑰）
    -   管理密鑰對，確保其有效性和可信度
    -   包含多個組件和流程，實現端到端安全連接

## PKI 關鍵組件

-   **Certificate Authority (CA)（憑證授權機構）**：

    -   擔任受信任的第三方
    -   負責發行數位憑證
    -   維護全球憑證授權機構之間的信任關係

-   **Key Escrow（密鑰託管）**：
    -   將密碼金鑰存儲在安全的第三方
    -   用途：
        -   當組織或個人遺失加密金鑰時可取回
        -   在法律調查的情況下可使用
    -   優點：確保加密資料不會完全無法存取
    -   風險：如果惡意攻擊者獲取託管金鑰，可能解密大量資料
    -   安全考量：託管金鑰的存儲必須極為安全，訪問需嚴格管控

## PKI 重要性

-   確保網路上的安全通信和資料交換
-   提供身份驗證：確保網站身份真實性
-   提供機密性：只有授權方可解密資料
-   提供額外安全保障，例如通過密鑰託管機制
-   實現 HTTPS 連線的基礎架構

## PKI 實際應用

-   網站安全通訊 (HTTPS)
-   電子商務交易加密保護
-   企業文件加密
-   身份驗證
-   數位簽名

# 數位憑證（Digital Certificates）

-   **Digital Certificate（數位憑證）**：一種經過數位簽署的電子文件，將公鑰與使用者身份綁定在一起。

    -   使用者可以是真實人物、伺服器、工作站或其他被指派數位憑證的設備。
    -   通常使用 X.509 協議標準。
    -   包含使用者資訊（姓名、組織、公鑰）以及憑證授權機構的資訊。

-   **X.509（X.509 標準）**：用於數位憑證的協議標準。
    -   X.509 憑證將身份與公鑰通過數位簽章綁定在一起。
    -   在 X.509 系統中有兩種憑證：CA 憑證和終端實體憑證。
    -   CA 憑證可以簽發其他憑證。

## 憑證類型

-   **Wildcard Certificate（萬用字元憑證）**：允許所有子域名使用相同的公鑰憑證並顯示為有效。

    -   優點：易於管理、節省成本（只需購買一個憑證）、維護簡單。
    -   缺點：如果憑證被撤銷，會影響所有使用該憑證的子域名伺服器。

-   **Single-sided Certificate（單向憑證）**：僅伺服器需要向瀏覽器提供憑證進行身份驗證。

    -   使用者不需要提供自己的數位憑證進行身份驗證。
    -   最常見的憑證使用情境，如大多數網站。

-   **Dual-sided Certificate（雙向憑證）**：伺服器和使用者需互相驗證身份。

    -   提供更好的安全性，但需要伺服器兩倍的處理能力。
    -   通常只用於高安全環境。

-   **Self-signed Certificate（自簽憑證）**：由同一實體簽署而非受信任的第三方憑證授權機構簽署的數位憑證。

    -   能提供加密功能，但不具備相同程度的信任因為沒有外部驗證。
    -   常用於測試環境、封閉系統和非生產系統。
    -   在公開網站使用時，會在瀏覽器中產生警告。

-   **Third-party Certificate（第三方憑證）**：由受信任的憑證授權機構（CA）簽發的數位憑證。
    -   CA 的根憑證已嵌入主要瀏覽器和作業系統中。
    -   使用者可追溯其真實性至已知且受信任的 CA。
    -   為公開網站或應用程式的首選憑證。

## 信任機制

-   **Root of Trust（信任根）/ Chain of Trust（信任鏈）**：憑證驗證的基本概念，從底部向頂部移動。

    -   類似家族樹，根憑證授權機構就像是這個家族的祖父，大家都信任它。
    -   驗證過程遵循祖父-父親-子女的信任關係模式。
    -   大多數憑證的信任根是第三方提供商，如 Verisign、Amazon、Google、CloudFlare 等。

-   **Certificate Authority (CA)（憑證授權機構）**：發行數位憑證的受信任第三方。

    -   憑證中包含 CA 名稱、數位簽章、序號、發行及過期日期、版本。
    -   維護使用者公鑰的公開可訪問副本，供其他用戶加密資訊使用。

-   **Registration Authority (RA)（註冊授權機構）**：負責處理使用者憑證請求的實體。
    -   收集使用者識別信息並轉發憑證請求至 CA。
    -   CA 據此為使用者創建數位憑證。

## 憑證管理

-   **Certificate Signing Request (CSR)（憑證簽署請求）**：獲取數位憑證過程中的重要組件。

    -   包含請求實體資訊（組織名稱、域名、地區、國家）和公鑰的編碼文本。
    -   私鑰保留在請求方，不會發送給憑證授權機構。
    -   CA 驗證實體憑證後，會將憑證返回給實體安裝。

-   **Certificate Revocation List (CRL)（憑證撤銷列表）**：CA 維護的已撤銷數位憑證列表。

    -   通常因資料外洩而使憑證被撤銷。
    -   包含該 CA 曾經撤銷的所有憑證完整列表。
    -   連接到新伺服器時，系統會先檢查 CRL 確保憑證未被撤銷。

-   **Online Certificate Status Protocol (OCSP)（線上憑證狀態協議）**：判斷憑證是否已被撤銷的協議。

    -   使用序號確定單一數位憑證的撤銷狀態。
    -   作為 CRL 的替代方案，運行更快速高效（無加密，一次只查一個憑證）。
    -   缺點：缺少加密，安全性較低。

-   **OCSP Stapling（OCSP 裝訂）**：OCSP 的替代方案。
    -   曾稱為「TLS 證書狀態查詢擴展」。
    -   允許憑證持有者定期從伺服器獲取 OCSP 記錄，作為 SSL/TLS 握手的一部分。
    -   消除了使用者請求時的額外連線，加速了安全通道創建過程。

## 進階安全機制

-   **Public Key Pinning（公鑰固定）**：防止伺服器身份被冒充的機制。

    -   允許 HTTPS 網站通過在 HTTP 標頭中呈現一組受信任的公鑰來抵抗冒充攻擊。
    -   如果瀏覽器無法從 CA 獲得匹配的公鑰，會警告使用者存在問題。

-   **Key Escrow Agent（金鑰託管代理）**：存放使用者私鑰的安全副本到託管庫，以防使用者意外丟失金鑰時使用。

    -   適用於不能接受任何資料丟失的組織。
    -   託管庫需要保護，防止金鑰被盜。
    -   建議取出託管金鑰時至少有兩名不同管理員在場，實現職責分離。

-   **Key Recovery Agent（金鑰恢復代理）**：允許恢復丟失或損壞金鑰的專用軟體。
    -   作為 CA 金鑰的備份，防範重大事故或災難。

## 補充

-   伺服器有可能判斷使用者的設備而決定回傳不同加密方式的憑證，主要是為了優化性能，對於移動設備，可能會回傳較輕量的憑證，例如使用橢圓曲線演算法的憑證。

# 區塊鏈技術（Blockchain）

一種共享的、不可變的分類帳，用於記錄交易、追蹤資產和建立信任。

-   區塊鏈以長系列的資訊區塊組成，每個區塊包含特定資訊。
-   每個區塊包含前一個區塊的雜湊值（hash）和時間戳記。
-   區塊中還包含根交易和各個交易的雜湊值。

-   **Public Ledger**（公共分類帳）：一種記錄保存系統，以安全和匿名的格式維護參與者的身份。

    -   追蹤加密貨幣餘額（如使用加密貨幣時）。
    -   記錄網路參與者之間執行的所有真實交易。
    -   作為去中心化的點對點網路的基礎。
    -   使用一系列雜湊確保一切正確記錄且未經共識確認難以更改。

-   **Smart Contracts**（智能合約）：於區塊鏈上運行的應用，基本上其程式碼無法被更動，除非使用代理合約等技術（間接引用）。

    -   當特定條件滿足時，自動執行操作，無需中介機構。
    -   例如：買家確認收到貨物後自動向賣家釋放資金。
    -   一旦部署就不能更改，使協議防篡改且完全可信。
    -   以太坊（Ethereum）使智能合約獲得廣泛普及。
    -   提供透明度，減少欺詐風險和傳統合約流程的成本。
    -   所有執行的合約操作都記錄在區塊鏈上，提供明確的交易記錄。

-   **Permissioned Blockchain**（許可制區塊鏈）：用於商業交易的區塊鏈類型。

    -   通過使用不可變的公共分類帳，提升信任和透明度的新水平。
    -   IBM 積極推動在商業環境中應用許可制區塊鏈。

-   **供應鏈應用**：區塊鏈在供應鏈管理中的應用。

    -   提供完全可追溯和透明的供應鏈。
    -   食品行業應用案例：記錄食品的生長、採摘、運輸、加工等全過程資訊。
    -   確保產品遵循正確程序並提供安全性保證。
    -   因為位於不可變的公共分類帳中，數據無法被修改，確保信息的真實性。

-   **區塊鏈的廣泛應用**：不僅限於金融部門或加密貨幣。
    -   其去中心化特性結合透明度和安全性可革新傳統系統。
    -   應用領域包括：供應鏈管理、投票系統、財產轉移、知識產權保護等。
    -   提供增強的可追溯性和責任制。
    -   提供信任、開放和透明度，解決商業往來中長期存在的挑戰。
    -   隨著技術發展，將成為數位演進的基石，以前所未有的方式影響各個行業。

# 企業網路與系統加密工具

-   **Encryption Tools**（加密工具）：用於保護企業網路和系統的關鍵技術
    -   包括 TPM、HSM、密鑰管理系統和安全隔離區
    -   確保各種平台和環境中的數據安全性和完整性

## 主要加密工具

-   **Trusted Platform Module (TPM)**（可信平台模組）：專用晶片，通過集成加密密鑰來保護硬體

    -   提供硬體層級安全保障，確保數位資產保持機密性和完整性
    -   類似於保險庫，保持信息加密，防止未授權訪問或篡改
    -   常見用途：Windows 操作系統中的 BitLocker 驅動器加密
    -   將加密密鑰安全地隔離在硬體中，增加抵禦軟件攻擊的安全層
    -   TPM 含有不可被軟體存取的背書（認證）金鑰 (Endorsement Key, EK)，可用於驗證設備身分
    -   在設備開機時檢查系統健康狀態和環境，只允許處於可信狀態的系統運行
    -   包含多種物理安全機制使其具有防篡改性

-   **Hardware Security Module (HSM)**（硬體安全模組）：外接式或獨立設備，用於保護和管理數位密鑰

    -   類似於高安全性銀行保險庫
    -   主要用於關鍵任務場景，如金融交易
    -   在防篡改環境中執行加密操作
    -   安全生成加密密鑰，並提供加速的加密操作
    -   幫助企業滿足監管合規標準
    -   應用案例：線上零售商使用 HSM 保護交易數據，即使系統或數據庫受到入侵，交易細節仍保持安全加密

-   **Key Management System (KMS)**（密鑰管理系統）：集成式方法，用於生成、分發和管理加密密鑰

    -   密鑰是加密過程的核心要素
    -   集中式機制，控制加密密鑰的整個生命週期（從創建到最終銷毀）
    -   應對不斷增長的網路安全挑戰的必要工具
    -   應用案例：數位媒體公司自動管理雲存儲中大量加密文件的密鑰，定期更新密鑰以增強安全性

-   **Secure Enclave**（安全隔離區）：集成在某些設備 SOC 的專用安全子系統
    -   專為資料保護而設計
    -   與主處理器隔離，為敏感數據提供屏蔽處理和存儲位置
    -   如同設備內的堡壘，保護指紋、面部識別數據和支付信息等敏感信息
    -   應用案例：Apple iPhone 的 Face ID 和 Touch ID，生物識別數據存儲在安全隔離區中，即使設備被入侵也保持安全

## 加密工具的重要性

-   隨著網路安全威脅的不斷演變和複雜化，強大高效的加密機制變得尤為重要
-   隨著技術進步，持續更新有關最新工具和技術的知識至關重要
-   這些加密技術共同為企業系統和網路提供多層次保護

# 資料混淆技術

-   **Obfuscation（混淆）**：隱藏資訊有時與加密同等重要，主要包含三種技術：隱寫術、令牌化和資料遮罩。

## 主要技術

-   **Steganography（隱寫術）**：隱藏寫作的藝術，源自希臘文「covered writing」

    -   定義為在普通非機密檔案或訊息中隱藏機密資料以避免被發現的做法
    -   主要目標不是防止未授權訪問資料，而是防止他人懷疑存在隱藏資料
    -   範例：在社群媒體貼出的貓咪照片中，可通過具體像素的細微顏色變化嵌入隱藏訊息
    -   技術特點：隱藏訊息的存在本身，讓資料「明顯可見卻不被察覺」
    -   常與加密結合使用，提供額外安全層級
    -   實際應用：
        -   傳統方式：報紙分類廣告中每個字的首字母組成秘密訊息
        -   數位方式：在圖像中嵌入資訊，肉眼無法區分，但使用工具可提取

-   **Tokenization（令牌化）**：資料保護的轉換技術

    -   定義為將敏感資料元素替換成無意義的非敏感代等物（令牌），真實資料安全儲存在別處
    -   只有特定系統可將令牌映射回原始值
    -   範例：信用卡交易中，商家不儲存實際卡號，而是儲存令牌並建立相關映射
    -   技術特點：
        -   原始資料被隨機字符串替代
        -   即使發生資料洩露，駭客也只能獲取無用的令牌
        -   真實資料安全存放在獨立保護的資料庫中
    -   常用於支付系統，有助於符合 PCI DSS 等標準
    -   平衡了資料安全性與可用性

-   **Data Masking（資料遮罩）**：又稱資料混淆（Data Obfuscation）
    -   定義為偽裝原始資料以保護敏感資訊，同時保持資料真實性和可用性的過程
    -   範例：
        -   軟體開發環境：用類似但非真實的客戶資料進行測試
        -   客服系統：只顯示信用卡最後四碼，遮住前 12 位數字
        -   醫療機構：只使用社會安全號碼最後四位數字進行身分識別
    -   技術特點：建立已遮住部分資料的資料集，減少非生產環境中的資料洩露風險
    -   適用於處理大量個人資料的行業

## 技術比較

-   **隱寫術**：將秘密資訊嵌入其他媒體中，隱藏資訊存在的事實
-   **權杖化**：用無意義標記替換敏感資料
-   **資料遮罩**：改變資料以保護真實內容，同時保持可用性

# 密碼學攻擊（Cryptographic Attacks）

指攻擊者用來利用密碼系統漏洞的技術和策略，目的是破壞資料的機密性、完整性和真實性。

-   這些攻擊旨在通過未經授權的方式解密資料、冒充使用者或創造系統會視為真實的偽造內容。

-   攻擊方法包括利用密碼演算法和協議的弱點、軟體實現的缺陷，或使用暴力破解猜測金鑰。

## 主要攻擊類型

### 降級攻擊

-   **Downgrade Attack**（降級攻擊）：又稱為版本回滾攻擊（Version Rollback Attack），旨在迫使系統使用較弱或較舊的密碼標準或協議。

    -   通過強制系統回退到舊版本，攻擊者可以利用這些舊協議中已知的漏洞。
    -   現代密碼系統通常支援多種協議版本以確保向後相容性，這反而成為了安全隱患。

-   **POODLE Attack**（POODLE 攻擊）：全稱為 Padding Oracle On Downgraded Legacy Encryption，針對 SSL 3.0 的著名降級攻擊。

    -   儘管有更安全的 TLS 協議，許多系統為了向後相容性仍支援 SSL 3.0。
    -   POODLE 攻擊強制受害者使用這個較不安全的協議，使攻擊者能夠提取敏感資料。

-   **降級攻擊防護措施**：
    -   完全淘汰已知不安全的舊協議，即使會犧牲向後相容性。
    -   應用版本不相容性檢查，系統可以先宣稱只支援最新協議版本，以此檢測是否有降級攻擊嘗試。

### 碰撞攻擊

-   **Collision Attack**（碰撞攻擊）：尋找兩個不同的輸入產生相同雜湊輸出的攻擊方式。

    -   由於雜湊常用於資料驗證，如果攻擊者能夠產生具有相同雜湊值的惡意檔案，使用者可能誤以為是合法檔案。
    -   MD5（Message Digest Algorithm 5）曾是流行的雜湊函數，但研究人員發現了其結構中的多個漏洞，使得碰撞攻擊變得可行。

-   **Birthday Paradox**（生日悖論）或 **Birthday Attack**（生日攻擊）：基於概率論的碰撞攻擊理論基礎。
    -   在一個只有 23 人的小組中，有超過 50%的機率有兩個人同一天生日。
    -   應用於密碼學時，指兩個不同輸入經過同一雜湊函數處理後產生相同輸出的機率比直覺上認為的要高。
    -   對於具有固定大小輸出的雜湊演算法（如 MD5、SHA-1、SHA-256、SHA-3），這意味著碰撞漏洞可能比預期更快出現。

### 量子運算威脅

-   **Quantum Computing**（量子運算）：一種使用量子力學原理生成和操控量子位（qubits）以獲得巨大處理能力的計算機。

    -   與傳統電腦使用的二進位位元（0 或 1）不同，量子位可以同時代表多種 0 和 1 的組合（稱為疊加態）。
    -   量子運算特別適合解決複雜的數學問題，而密碼學恰恰依賴於數學問題的複雜性來保證安全。

-   **Qubit**（量子位）：量子計算的基本單位，由電子或光子組成。

    -   透過疊加態（superpositioning）可以同時表示多種 0 和 1 的組合。
    -   這使得量子電腦能夠同時處理多種可能的結果，特別適合複雜的數學計算。

-   **量子運算對密碼學的威脅**：

    -   非對稱加密演算法（如用於 PKI 的公鑰基礎設施）在數學上已被證明可被量子電腦破解。
    -   目前量子電腦尚處於原型和開發階段，估計政府和大型企業可能在 2030 年前開始使用，而消費者則要等到 2030 年代末或 2040 年代初。

-   **Post-quantum Cryptography**（後量子密碼學）：能夠在當今傳統電腦上實現，但對未來量子電腦攻擊仍然有效的新型密碼演算法。

    -   解決方法之一：增加金鑰大小，如從 AES-128 增加到 AES-256，不僅使金鑰長度翻倍，也使可能的組合數量呈平方增長。
    -   其他後量子抗性演算法包括基於格密碼學（lattice-based cryptography）和超奇點同源金鑰交換（supersingular isogeny key exchanges）。

-   **NIST 後量子密碼標準**：2022 年，美國國家標準與技術研究院完成了六年的競賽選出後量子密碼標準。
    -   一般加密推薦：CRYSTALS-Kyber 演算法
    -   數位簽章推薦：CRYSTALS-Dilithium（主要推薦）、FALCON 或 SPHINCS+
