# 資安事件應變準備階段

## 事件應變準備階段主要內容

- **事件應變流程文件化**：記錄完整的應變程序和步驟

- **資料關鍵性分類**（Data Criticality）：
  - 開發事件應變計劃時需考慮的七種資料關鍵性類型

- **溝通計劃**（Communication Plans）：
  - 事前規劃的溝通策略和報告要求
  - 在事件發生前就必須完成規劃

- **應變協調**：
  - 如何在組織內部和外部利害關係人之間協調應變工作

- **業務持續性計劃**（Business Continuity Plan）：
  - 確保企業在自然災害、網路攻擊和其他惡意事件期間能夠繼續運作

- **訓練與測試**：
  - 對任何事件應變成功至關重要
  - 缺乏充分準備會導致應變失敗，造成更高成本和災難性後果
  - "一分預防勝於十分治療"（an ounce of prevention is worth a pound of cure）

## 重要觀念

- **事件不可避免性**：
  - 現今環境下，事件應變不是"是否"會發生的問題，而是"何時"會發生
  - 網路攻擊和資料外洩以驚人速度增加
  - 充分準備至關重要，因為事件終將發生

# 資安事件回應階段與團隊

## Incident（資安事件）：
- 違反明確或隱含安全政策的行為
  - 範例：竊取密碼、安裝惡意軟體等違反組織安全程序的行為

## 資安事件回應模型：

### NIST 模型（四個階段）：
- 來自《Computer Security Incident Handling Guide》(SP 800-61)
  - 第一階段：準備 (Preparation)
  - 第二階段：偵測與分析 (Detection and Analysis)
  - 第三階段：圍堵、根除與復原 (Containment, Eradication and Recovery)
  - 第四階段：事後活動 (Post-incident Activity)

### CompTIA 模型（五個階段）：
- 將 NIST 模型的第三階段拆分為兩個階段
  - 第一階段：準備 (Preparation)
  - 第二階段：偵測與分析 (Detection and Analysis)
  - 第三階段：圍堵 (Containment)
  - 第四階段：根除與復原 (Eradication and Recovery)
  - 第五階段：事後活動 (Post-incident Activity)

## 事件回應階段說明：

### 準備階段：
- 透過系統強化、政策制定、建立機密溝通管道來增強抵抗力
  - 包括測試演練、準備工具套件、人員培訓

### 偵測與分析階段：
- 判斷事件是否發生，進行分類並通知相關利害關係人
  - 確認事件性質並開始後續回應行動

### 圍堵階段：
- 限制事件的範圍和影響，保護資料並減少對業務營運的衝擊
  - 主要目標是防止威脅擴散

### 根除與復原階段：
- 移除事件原因並將系統還原至安全狀態
  - 根除：移除威脅
  - 復原：回復正常狀態並預防再次受攻擊

### 事後活動階段：
- 分析事件及回應過程，識別哪些程序有效、哪些需要改進
  - 找出問題根源並制定未來預防措施

## 資安事件回應程序：
- 涵蓋安全事件中的適當優先順序、行動和職責的指導方針
  - 包含在各個回應階段中的具體行動

## 資安事件回應團隊：

### 職位角色：
- 事件回應經理/團隊主管：
  - 監督並優先處理偵測、分析和圍堵階段的行動
  - 需要良好的軟技能和專業技術能力
  - 向管理層溝通回應和復原工作

- 安全分析師：
  - 直接在受影響網路上工作，調查事件發生經過
  - 分為兩類：
    - 分類分析師：配置入侵偵測系統，過濾誤報，持續監控
    - 鑑識分析師：專注調查工作，收集證據並建立事件時間軸

- 威脅研究員：
  - 提供威脅和整體情境資訊
  - 掌握最新威脅情報和行業特定風險
  - 結合未來預測和歷史威脅知識

- 跨職能支援角色：
  - 管理層/執行團隊成員
  - 人力資源（處理內部威脅）
  - 法務人員（處理法律行動）
  - 公關人員（處理媒體關注）
  - 技術專家（系統管理員、網路管理員等）

### CSIRT（Computer Security Incident Response Team）：
- 安全事件的單一聯絡窗口
  - 可能是 SOC（安全營運中心）的一部分或獨立團隊
  - 需要 24/7 全天候待命
  - 人員需要輪班避免過勞

### 團隊組成模式：
- 內部團隊：適合大型組織，成本高
- 外包團隊：適合中小型組織，成本效益高
  - 外部團隊處理內部威脅時更加客觀中立

# 文件化程序

## 準備階段概述

- **準備階段（Preparation Phase）**：確保系統對攻擊具有彈性的階段
  - 包括系統強化、制定政策和程序、建立機密通信渠道
  - 目標是在事件發生前做好準備，能夠迅速響應

## 關鍵文件與工具

- **事件響應計劃（Incident Response Plan）**：組織的「作戰計劃」
  - 針對不同類型的攻擊（DDoS、病毒、釣魚攻擊等）制定不同的響應方案
  - 在事件發生前準備好標準流程，並經過測試

- **標準操作程序手冊（Playbook）**：詳細的操作指南
  - 為分析師和事件處理人員提供明確的步驟指導
  - 可從 incidentresponse.com/playbook 獲取範本並自定義
  - 典型的釣魚攻擊手冊包含：
    - 準備階段流程圖
    - 檢測方法
    - 分析與分類方法
    - 遏制措施
    - 根除步驟
    - 恢復程序
    - 事後處理

- **呼叫清單（Call List）**：預先定義的聯絡人階層名單
  - 定義通知和升級的聯絡順序
  - 包含不同的聯絡方式（電話、電子郵件等）
  - 針對不同嚴重程度的事件，定義不同的通知層級
  - 必須包含備用通訊方式（避免在遭受攻擊時透過可能被監控的網路溝通）

- **事件表單（Incident Form）**：記錄事件詳細資訊的文件
  - 可以是紙本或電子表單（SharePoint、數據庫等）
  - 必須包含的關鍵資訊：
    - 日期、時間和事件發生/檢測地點
    - 報告者和事件處理人員的姓名和聯絡方式
    - 事件觀察/檢測方法（相關日誌或警報）
    - 事件類型（蠕蟲、數據洩露、惡意軟體等）
    - 事件範圍（影響整個組織還是部分系統）
    - 事件描述和事件日誌（所有相關細節和時間線）

# 資料關鍵性

- **Data Criticality**（資料關鍵性）：評估資料重要程度的方法，用於決定資源分配優先順序和安全防護措施。
  - 在準備階段就需要考慮，影響標準作業程序、劇本和事件應變計畫
  - 重點在於系統上的資料，而非系統本身
  - 幫助優先處理資源有限情況下的安全事件

## 資料關鍵性分類

- **PII (Personally Identifiable Information)**（個人識別資訊）：可用來識別、聯絡或冒充個人的資料。
  - 包含：生日、社會安全號碼、出生地、全名、生物識別資料（指紋、視網膜掃描）
  - 若與IP地址和地理位置資料結合，可能導致實體世界的目標攻擊
  - 是最常見的資料關鍵性議題

- **SPI (Sensitive Personal Information)**（敏感個人資訊）：關於個人意見、信仰和特性的資訊，受隱私法規特別保護。
  - GDPR定義的SPI包括：宗教信仰、政治觀點、工會會員資格、性別、性傾向、種族和民族出身、基因資料、健康資訊
  - 在美國，SPI沒有統一定義，但某些部分（如健康資訊）有特定法規保護

- **PHI (Personal Health Information/Protected Health Information)**（個人健康資訊/受保護健康資訊）：識別個人為醫療記錄、保險記錄、醫院結果或實驗室測試結果主體的資訊。
  - 受HIPAA法規保護
  - 包含所有與健康或身體相關的資料
  - 可透過匿名化或去識別化處理後用於研究
  - 在黑市上價值高，可用於保險詐騙

- **Financial Information**（財務資訊）：有關銀行帳戶、投資帳戶、薪資帳戶、稅務申報、信用卡資料及其他商業交易的資料。
  - 接受信用卡支付的組織需遵循PCI DSS標準（支付卡產業資料安全標準）
  - 因直接涉及金錢價值，常成為攻擊目標

- **Intellectual Property**（智慧財產權）：組織創建的與其產品或服務相關的資訊。
  - 包含：著作權、專利、商標或商業機密
  - 例如：KFC的11種香料配方（商業機密）、教學影片（著作權）
  - 不同形式的智慧財產保護方式不同（如專利有時效，商業機密可永久保存）

- **Corporate Information**（企業資訊）：公司擁有的機密資料，如產品、銷售、行銷、法律和契約資訊。
  - 包含：利潤、現金流、薪資、市場占有率、關鍵客戶等
  - 與智慧財產不同，但對競爭對手仍有價值
  - 資訊洩漏可能導致股價波動（如Kodak案例）

- **High Value Assets**（高價值資產）：處理對關鍵任務功能至關重要資料的資訊系統。
  - 維護其機密性、完整性和可用性對組織成功至關重要
  - 在準備階段需識別這些資產，以便在事件回應時知道哪些系統優先檢查
  - 幫助快速識別關鍵系統可減少事件影響範圍和復原時間

# 事件應變溝通計畫

- **Communication Plan（溝通計畫）**：在事件應變準備階段需要考慮的重要元素
  - 特別重要於大型組織或分散式團隊環境中
  - 必須建立安全的溝通管道來管理事件

- **Out-of-band Communication System（帶外通訊系統）**：使用不同於主要溝通管道的路徑或方法進行訊息傳遞
  - 避免使用可能被攻擊者監控的主要通訊系統（如公司電子郵件、VoIP系統）
  - 常見選項包括：
    - 個人手機通話
    - 加密通訊應用程式（如WhatsApp、Signal、Off the Record）
    - 這些應用提供端對端加密，防止攻擊者竊聽

- **Backup Communication Plan（備用溝通計畫）**：當主要溝通方式無法使用時的替代方案
  - 需考慮特殊情境，如：
    - 團隊成員在不允許使用智慧型手機的環境中工作
    - 在沒有良好行動網路覆蓋的區域需使用衛星電話
    - 定期安排離開安全區域進行回報的時程

- **Up-to-date Contact List（最新聯絡清單）**：預先準備並維持更新的聯絡資訊清單
  - 包含事件應變團隊所有成員的電話號碼和電子郵件
  - 組織內其他相關人員的聯繫方式
  - 第三方合作夥伴的聯絡資訊

- **Escalation Procedure（升級程序）**：明確界定何時需要通知待命人員或團隊
  - 定義事件嚴重程度的判斷標準
  - 考量使用外部合約人員的額外費用因素
  - 根據組織優先順序設定明確的升級標準

- **Notification Methods（通知方法）**：根據事件優先級別決定通知方式
  - 低優先級事件：可能不需通知，或透過日/週報告、內部網站入口
  - 中優先級事件：電子郵件、語音留言、工作時間內的電話
  - 高優先級事件：電話或面對面通知，後續提供電子郵件或報告
  - 應根據組織需求和相關人員偏好進行調整

- **Information Control（資訊控制）**：防止未經授權的資訊外洩
  - 避免事件資訊未經規劃就被公開於新聞或社群媒體
  - 所有對外溝通應經由適當管道和公關團隊
  - 確保擁有特權資訊的人員不會有意或無意洩漏給不受信任的對象

# 資安事件通報要求

- **Reporting Requirements**（通報要求）：必須根據法律或法規，向受影響的當事人提供的資安事件通知
  - 應在準備階段就規劃好通報程序

## 資安事件類型

- **Data Exfiltration**（資料外洩）：攻擊者入侵系統並將資料轉移到另一個系統
  - 例如：攻擊者入侵信用卡資料庫並竊取卡號資料

- **Insider Data Exfiltration**（內部人員資料外洩）：具有系統權限的員工或前員工將資料轉移到外部系統
  - 例如：員工下載共享資料夾的檔案到 USB 隨身碟，並上傳至 WikiLeaks

- **Device Theft or Loss**（裝置失竊或遺失）：含有資料的裝置遺失或被盜
  - 例如：裝有公司資料的智慧型手機遺失在計程車上
  - 例如：放在車內的筆記型電腦被盜

- **Accidental Data Breach**（意外資料洩漏）：因人為錯誤或錯誤配置導致的資訊公開揭露或未授權傳輸
  - 此類事件通常是無意造成的錯誤

- **Integrity or Availability Breaches**（完整性或可用性侵害）：資料遭到篡改或處理資料的系統被破壞
  - 例如：資料庫中的資料被修改（完整性侵害）
  - 例如：對網路伺服器進行阻斷服務攻擊（可用性侵害）

## 通報法規

- **HIPAA**（健康保險可攜性與責任法案）：美國的健康資訊保護法規
  - 當受保護健康資訊（PHI）受到影響時必須通報
  - 通報對象：受影響的個人、衛生與人類服務部部長、媒體（若超過 500 人受影響）

- **GDPR**（一般資料保護規範）：適用於歐盟的資料保護法規
  - 要求在發現個人資料洩漏後 72 小時內進行通報
  - 通報對象：受影響的個人及 GDPR 監管機構（歐盟）

## 揭露（Disclosure）

- **Disclosure**（資安事件揭露）：向受影響當事人通知事件的方式與內容
  - 應包含的關鍵資訊：
    - 洩漏資訊的描述
    - 聯絡窗口的詳細資訊
    - 可能產生的後果
    - 已採取的緩解措施

# 事件應變協調

- **Response Coordination**（應變協調）：在安全事件準備階段需要考慮如何協調不同內部部門和外部機構的應變工作
  - 事件應變需要在內部部門和外部機構之間進行協調
  - Twitter 大規模資安事件案例：高知名度帳號（包括 Apple、Jeff Bezos、Barack Obama、Kanye West 等）被駭，發送索要比特幣的訊息
  - Twitter 立即鎖定受影響帳號，並與 FBI 合作調查，兩週內逮捕嫌疑人

- **Affected Stakeholders**（受影響的利害關係人）：事件發生時需要考慮的內外部相關人員或組織
  - 事件應變需要考慮誰是受影響的利害關係人，以及如何協調應變
  - 主要利害關係人包括：
    1. 高階管理層
    2. 監管機構
    3. 法務部門
    4. 執法機構
    5. 人力資源部門
    6. 公關部門

- **Senior Leadership**（高階管理層）：負責業務運營和公司各功能領域的主管與管理人員
  - 技術人員可能提出從技術角度解決問題的方案，但可能忽略業務影響
  - 示例：若信用卡處理系統被入侵，從技術角度可能建議立即關閉，但從業務角度可能造成無法處理新交易的嚴重影響
  - 需要高階管理層參與權衡技術解決方案與業務影響

- **Regulatory Bodies**（監管機構）：監督特定法規和法律合規性的政府組織
  - HIPAA（醫療資訊）由衛生與人類服務部監管
  - CCPA（加州消費者隱私法案）由加州政府監管
  - PCIDSS（支付卡產業資料安全標準）由支付卡產業監管（非法律要求，而是合約要求）

- **Legal**（法務）：組織的法律顧問，負責降低民事訴訟風險
  - 在規劃應變措施時需要法務參與，確保行動不會在日後造成法律風險
  - 可以提供應變過程中的法律建議

- **Law Enforcement**（執法機構）：外部利害關係人，提供協助事件處理或準備對攻擊者採取法律行動
  - 如 Twitter 事件中的 FBI 參與
  - 注意：涉及執法機構的決定應由高層主管在法律顧問指導下做出，而非由事件應變人員直接聯繫
  - 某些情況下，通報執法機構是法律要求；其他情況下是組織自行決定是否提起訴訟

- **Human Resources**（人力資源部門）：確保事件應變過程中不違反勞動法或員工合約
  - 當懷疑內部威脅並需要調查員工或檢視員工檔案時，必須諮詢人力資源部門
  - 避免在調查過程中違反勞動法規或員工合約

- **Public Relations/PR**（公關部門）：管理嚴重事件的負面輿論
  - 技術人員不應直接回應媒體詢問
  - 公關部門負責制定清晰一致的對外訊息
  - 確保組織在面對媒體時保持一致的立場和說法
  - 大型資安事件特別需要公關部門的參與

- **CSIRT 角色**（電腦安全事件應變小組）：向利害關係人提供關鍵資訊
  - 提供預估停機時間、受影響系統和資料範圍等相關細節
  - 確保所有利害關係人獲得一致的資訊，協調應變工作

# 業務持續性計劃

- **Business Continuity Plan (BCP)（業務持續性計劃）**：確保組織能從干擾事件或災難中恢復的計劃和流程。
  - 專門針對應對任何可能干擾業務的威脅或事件
  - 包含預防行動和恢復步驟的系統
  - 可涵蓋非 IT 相關的業務中斷情況

- **Disaster Recovery Plan (DRP)（災難復原計劃）**：業務持續性計劃的子集，專門針對災難期間的計劃和流程。
  - 主要集中在災難後如何快速恢復業務
  - 例如：颶風、地震、火災、洪水等自然災害的應對措施

- **業務持續性計劃的開發責任**：
  - 高階管理層負責推動並確保適當執行
  - 業務持續性協調員帶領業務持續性委員會
  - 委員會應包括來自不同部門的代表（IT、法務、安全、通訊等）

- **NIST SP 800-34 業務持續性計劃七大步驟**：
  1. 制定應急計劃政策
  2. 進行業務影響分析
  3. 識別預防控制措施
  4. 創建復原策略
  5. 開發業務持續性計劃
  6. 測試、培訓和演練 BCP
  7. 維護 BCP

- **業務持續性位置類型**：

  - **Hot Site（熱站點）**：持續運作的站點，幾乎不會有停機時間。
    - 優點：立即可用，幾乎零停機時間
    - 缺點：成本高，需要完全備份的設備和資源
    - 適合需要 24/7 持續運作的關鍵業務

  - **Warm Site（溫站點）**：配備基本設施，能在幾天內恢復運作。
    - 已具備基本條件：電力、電話線路、網路連接等
    - 比熱站點便宜，但恢復時間較長

  - **Cold Site（冷站點）**：設施更少，恢復時間更長。
    - 通常只是一個空置的建築物，具備最基本設施
    - 需要 1-2 個月時間才能完全投入使用
    - 成本低於溫站點

  - **Mobile Site（移動站點）**：可移動的獨立復原單位。
    - 通常為拖車或帳篷形式
    - 可以快速部署到需要的位置
    - 完全自給自足，包含所需的設備、電源和技術人員
    - 例如：美軍的 DJC2（可部署的聯合指揮控制系統）

- **選擇合適的站點類型**：
  - 可以根據不同業務功能、情境或時間線選擇不同的站點類型
  - 關鍵業務可能需要熱站點，非關鍵業務可使用溫站點或冷站點
  - 應考慮電源、網路連接等多重備援策略

# 事件應變訓練與測試

- **Training（訓練）**：教育確保員工和職員了解在事件應變期間的流程、程序和優先事項
  - 確保人員在發生事件時準備好進行應對
  - 應根據不同角色需求提供相關的訓練

- **不同角色的訓練需求**：
  - **應變人員**：需要技術能力訓練
    - 如何重新建立機器映像
    - 如何移除惡意軟體
    - 如何變更設定
  - **管理者/主管**：
    - 專注於風險與回報評估
    - 管理決策制定
    - 組織內外部溝通（包含執法單位和媒體）
  - **終端使用者**：
    - 如何回報可疑事件
    - 釣魚郵件識別訓練
    - 預防事件發生的最佳實踐

- **訓練重點**：
  - 納入過往事件的經驗教訓
  - 包含技術技能與軟技能培養
  - 團隊關係建立

- **Testing（測試）**：事件應變程序的實際演練
  - 目的是確保人員不只知道該做什麼，還知道如何實際操作
  - 通常會模擬重大事件
  - 可能成本高且複雜，但能確保團隊在實際情況中的表現

- **測試類型**：
  - **Tabletop Exercise（桌面演練）**：
    - 使用事件應變情境對抗控制框架或紅隊
    - 專家圍坐討論並回應假設情境
    - 成本較低但缺乏實際操作經驗
    - 可採用紅隊（攻擊者）vs 藍隊（防禦者）模式進行角色扮演

  - **Penetration Test（滲透測試）**：
    - 紅隊基於特定威脅模型嘗試入侵網路
    - 必須事先同意明確的測試方法論和交戰規則
    - 深入了解可參考 CompTIA PenTest+ 認證

- **常見滲透測試工具**：
  - Metasploit
  - Cobalt Strike
  - Kali Linux
  - ParrotOS
  - Commando OS
  - 防禦者應警惕網路中出現這些工具，它們可能用於滲透測試或被攻擊者利用