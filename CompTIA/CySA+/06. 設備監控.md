# 資安設備監控

## 概要

- **Log Ingestion**（日誌擷取）：指從各種安全設備收集日誌資料的過程
  - 著重於日誌讀取和分析，用於識別系統或網路中的威脅

- **IDS**（入侵偵測系統）：用於監控網路流量並偵測可疑活動的系統
  - 負責識別網路中的異常行為和潛在威脅
  - 與 IPS 配合使用可提供更完整的網路防護

- **IPS**（入侵防禦系統）：不僅可偵測還能阻止惡意活動的進階系統
  - 具備主動防禦能力，可自動回應偵測到的威脅
  - 需要正確配置以避免誤判導致合法流量被阻擋

- **NAC**（網路存取控制）：控制哪些設備可以連接到網路的安全框架
  - 用於管理網路接入權限，確保只有授權裝置可連接企業網路
  - 可與端口安全性（Port Security）相互配合增強網路防護

## 安全設備類型

- **Firewall**（防火牆）：控制網路間流量的安全設備
  - 負責依據安全規則過濾進出網路的流量
  - 需要正確設定規則以實現有效的安全防護

- **Web Application Firewall**（網頁應用程式防火牆）：專門保護網頁應用程式的特殊防火牆
  - 專門防護針對網頁應用程式的攻擊，如 SQL 注入、XSS 等
  - 與傳統防火牆配合使用可提供更全面的應用層防護

- **Proxy**（代理伺服器）：作為客戶端和伺服器間的中介
  - 可用於過濾網路流量、加強隱私性和提高存取效率
  - 代理日誌對於追蹤使用者網路活動非常重要

## 日誌分析與安全監控

- **Log Analysis**（日誌分析）：檢查系統日誌以識別安全事件的過程
  - 有助於及早發現安全漏洞和惡意活動跡象
  - 是資安分析師的核心技能之一

- **Log Correlation**（日誌關聯分析）：將多個來源的日誌關聯起來以全面了解事件的過程
  - 幫助識別跨多個系統的複雜攻擊模式
  - 常見於 SIEM 系統中，如 ArcSight ESM

- **Security Appliance Monitoring**（安全設備監控）：持續監控安全設備的運作狀況和日誌
  - 確保安全設備正常運作並提供有效防護
  - 對於即時識別和應對安全威脅至關重要，常見於 SOC 環境

- **SIEM**（安全資訊與事件管理）：整合各種安全設備日誌並進行集中分析的系統
  - 如 Wazuh 等開源工具可提供完整的日誌和端點監控解決方案
  - 幫助組織在有限資源下建立有效的資安監控機制

# 防火牆日誌

## 防火牆基礎

- **Firewall**（防火牆）：在網路邊界提供防禦線，限制進出特定網路的流量類型
  - 通常使用存取控制清單(ACL)實現流量過濾
  - 提供網路安全邊界保護，是網路安全的第一道防線

- **Access Control List**（存取控制清單）：基於 IP 地址、連接埠或應用程式使用情況的允許和拒絕網路連接清單
  - 用於定義哪些流量可以通過防火牆
  - 可以針對特定來源、目標或服務制定規則

## 防火牆日誌分析價值

防火牆日誌提供四種有用的安全資料：

1. **Connection Status**（連線狀態）：顯示允許或拒絕的連接
   - 可用於識別安全態勢中的漏洞
   - 幫助分析可能的入侵嘗試

2. **Port and Protocol Usage**（連接埠和協定使用情況）：
   - 顯示網路中使用的連接埠和協定
   - 幫助識別異常通訊和潛在的惡意活動

3. **Bandwidth Utilization**（頻寬使用率）：
   - 顯示特定連接的持續時間和使用量
   - 可按連接、使用者、部門或伺服器進行細分分析

4. **Address Translation Audit**（位址轉換稽核）：
   - 記錄網路位址轉換(NAT)和連接埠位址轉換(PAT)
   - 在事件回應時，幫助確定特定時間點哪台主機使用了特定 IP

## 防火牆日誌格式

### Linux iptables（CIS log 格式）

- **CIS log**（通用網際網路安全日誌）：Linux 系統常用的日誌格式
  - 每條日誌條目都以時間戳記、裝置 ID/主機名和設施（通常是核心）為前綴
  - 包含日誌前綴值或日誌級別，指示應用的規則
  - 詳細記錄封包資訊，包括介面、MAC 位址、IP 位址、連接埠等

- **CIS log 日誌級別**：從 0（緊急）到 7（除錯）的等級
  - 0：Emergency（緊急）
  - 1：Alert（警報）
  - 2：Critical（嚴重）
  - 3：Error（錯誤）
  - 4：Warning（警告）
  - 5：Notice（通知）
  - 6：Informational（資訊）
  - 7：Debug（除錯）

### Windows 防火牆（W3C Extended Log File Format）

- **W3C Extended Log File Format**（W3C 擴展日誌檔案格式）：Windows 防火牆使用的格式
  - 包含註解行，使日誌更易於閱讀
  - 記錄軟體版本、日期、欄位定義等資訊
  - 記錄連線詳情，包括客戶端 IP、使用者名稱、伺服器 IP、連接埠等
  - 提供 HTTP 方法（如 GET、POST）和狀態碼（如 200 表示成功）
  - 包含客戶端使用者代理資訊，表明使用的瀏覽器和作業系統

## 日誌管理最佳實踐

- **Log Collection Tool**（日誌收集工具）：使用工具收集大量防火牆日誌以進行後續分析
  - 避免將所有日誌存放在單一機器上，以防資料遺失
  - 集中管理可提高分析效率

- **Proper Logging Scope**（適當的日誌記錄範圍）：
  - 決定記錄的內容和重要性
  - 確定感測器和防火牆的位置，以收集資訊並提供最佳保護
  - 避免記錄過多導致資訊超載或系統無法處理

- **Blinding Attack**（致盲攻擊）：當防火牆資源不足，無法快速記錄所有資料時發生的情況
  - 導致日誌中缺失資料，影響後續分析
  - 可能被攻擊者利用來掩蓋其活動

- **Log Retention**（日誌保留）：決定保留日誌的時間
  - 取決於生成的事件數量、可用儲存容量和業務需求
  - 考慮 APT（進階持續性威脅）的威脅，建議保留 6-12 個月的日誌
  - APT 平均可在網路中存在 5-7 個月才被發現

## 實務建議

- **PF Sense**（PF Sense 防火牆）：免費開源的統一威脅管理工具
  - 包含防火牆功能
  - 可用於家庭網路設置，實踐日誌分析技能
  - 提供真實世界的日誌分析經驗

# 防火牆配置

## 邊界防禦的局限性

- **Boundary Defense**（邊界防禦）：傳統網路安全主要聚焦於保護網路邊界
  - 僅靠邊界防禦無法提供完整的安全保障
  - 類似於僅靠社區大門無法保護家中所有物品的安全

- **Defense in Depth**（縱深防禦）：結合多層安全控制的策略
  - 需要結合網路層防禦（如防火牆）和主機層防禦（如主機入侵偵測/防禦系統）
  - 單一防禦措施無法抵擋所有類型的攻擊

## 防火牆部署架構

- **Screened Subnet**（屏蔽子網路）：組織對外服務的專用網段
  - 是現代術語，取代了傳統的「DMZ」（非軍事區）概念
  - 用於放置需要對外提供服務的伺服器（Web、電子郵件、VoIP 系統等）
  - 透過防火牆與內部網路隔離，提供額外安全層

## 存取控制清單（ACL）配置

- **ACL Processing**（ACL 處理順序）：從上到下處理規則
  - 最具體的規則放在頂部，最通用的規則放在底部
  - 採用明確許可（Explicit Permission）策略，僅允許指定的流量

- **ACL 防禦最佳實踐**：
  - 阻擋來自內部/私有 IP、迴環和多播 IP 範圍的傳入請求
  - 阻擋僅應在本地使用的協定（如 ICMP、DHCP、OSPF、SMB）
  - 妥善配置 IPv6，避免雙堆疊主機的安全漏洞

- **Deny 操作類型**：
  - **Drop**（丟棄）：靜默丟棄封包，不返回任何回應
  - **Reject**（拒絕）：明確拒絕連接並返回 TCP 重置或 ICMP 錯誤
  - 丟棄策略使攻擊者更難識別連接埠狀態，可防止 Firewalking 等偵察技術

## 進階防火牆策略

- **Egress Filtering**（出口過濾）：限制離開網路的流量
  - 防止惡意軟體與命令和控制伺服器通訊
  - 防止網路指紋識別和 Firewalking
  - 最佳實踐包括：
    - 僅允許白名單應用程式連接埠和目標地址
    - 限制 DNS 查詢至可信任的 DNS 服務
    - 阻擋已知惡意 IP 地址（黑名單）
    - 阻擋不需要網際網路存取的子網路

- **Firewalking**（防火牆走訪）：一種偵察技術
  - 攻擊者透過發送 TTL 值為 1 的封包來列舉防火牆後的主機
  - 可透過阻擋外發 ICMP 狀態訊息來防止此類攻擊

## 流量處理特殊技術

- **Black Hole**（黑洞）：緩解拒絕服務或入侵攻擊的方法
  - 靜默丟棄或捨棄流量，不回應攻擊者
  - 可在路由層實現，比防火牆 ACL 更有效率
  - 適合用於未使用的網路空間（Dark Net）
  - 缺點是可能同時阻擋合法用戶

- **Dark Net**（暗網）：未使用的實體網路連接埠或本地網路中未使用的 IP 位址空間
  - 將未使用的 IP 空間路由到黑洞可提高安全性
  - 若攻擊者嘗試使用這些 IP，會被自動引導到黑洞而非正常網路

- **Sink Hole**（沉洞）：類似黑洞但功能不同
  - 將流量重定向到不同網路進行分析，而非僅丟棄
  - 適合用於確定 DDoS 攻擊的原因
  - 專業服務如 CloudFlare 或 Akamai 提供沉洞網路服務，可過濾惡意流量
  - 優點是可以允許合法流量通過，同時阻擋惡意流量

## 防 DDoS 策略

- **DDoS Mitigation**（DDoS 緩解）：防禦大規模網路攻擊的策略
  - 黑洞適合快速阻擋攻擊流量
  - 沉洞適合需要分析攻擊來源的情況
  - 專業服務如 CloudFlare 和 Akamai 提供「流量清洗」，過濾掉惡意流量

# 代理伺服器日誌

- **Proxy Server**（代理伺服器）：作為使用者與網際網路之間的閘道，是一種中介伺服器，將終端使用者與他們嘗試瀏覽的網站分開。
  - 提供不同程度的功能、安全性和隱私保護，取決於使用案例、需求和公司政策。

## 代理伺服器類型

- **Forward Proxy**（正向代理）：一種伺服器，用於調解客戶端與另一伺服器之間的通訊。
  - 可以過濾或修改通訊內容，並提供快取服務以提高性能。
  - 代表內部主機或工作站轉發HTTP請求至預定目的地。

- **Non-transparent Proxy**（非透明代理）：重定向來自已配置代理地址和埠的客戶端請求與回應的伺服器。
  - 使用者知道有代理存在，在瀏覽器網際網路設定中可以看到代理配置。

- **Transparent Proxy**（透明代理）：又稱強制或攔截代理，重定向請求和回應，但客戶端並未明確配置使用它。
  - 在網路層實施，確保所有機器都經過此代理，不僅限於配置過的設備。
  - 常用於確保員工不會關閉代理設定。

- **Reverse Proxy**（反向代理）：保護伺服器免受客戶端請求直接接觸的代理伺服器。
  - 提供特定協議的入站流量處理。
  - 外部請求先到達代理伺服器，再由代理伺服器向內部伺服器發送適當請求。
  - 保護內部伺服器不直接暴露給外部客戶端，減少惡意流量風險。
  - 提供單一日誌來源，方便分析攻擊或入侵指標。

## 代理日誌分析

- **Proxy Logs**（代理日誌）：揭示網頁請求的確切性質，包括使用者訪問的網站和每個請求的內容。
  - 通過代理伺服器並記錄這些信息，可以了解使用者行為、訪問的網站及停留時間。

- **Common Log Format**（通用日誌格式）：最常見的代理日誌格式之一，也被網頁伺服器使用。
  - 包含資訊：日期、時間、目的地、請求類型、連接埠、操作等。

- **代理日誌內容**：
  - 客戶端身份驗證到代理時的使用者ID
  - 請求方法（如GET或POST）
  - 狀態碼（如200、403、404）
  - 返回給客戶端的資訊大小（位元組）和類型（文字檔、圖片等）

- **攔截規則**：設定攔截或阻止流量的代理可記錄請求匹配的規則，用於確定員工意圖（惡意或無害）。

## 日誌分析實例

- **Squid Access Table**：代理伺服器日誌範例
  - 狀態碼200表示成功請求，允許訪問
  - 狀態碼403表示禁止訪問，通常是因為策略更新阻止了先前允許的網站
  - TCP_denied狀態表示代理阻止了請求

- **反向代理日誌**：
  - 記錄所有從外部IP進入內部伺服器的請求
  - 提供單一檢查點分析所有進入內部網路的流量
  - 可用於統計分析不同回應碼，識別可疑趨勢或基準流量的異常偏差

# 網頁應用程式防火牆日誌

- **Web Application Firewall (WAF)**（網頁應用程式防火牆）：專門設計用於保護網頁伺服器上運行的軟體及其後端資料庫，防止不同類型的程式碼注入和DoS攻擊。
  - 主要用於防止網頁式攻擊和漏洞，如SQL注入、XML注入和跨站腳本攻擊。
  - 與標準狀態封包過濾防火牆不同，WAF能解析回應和請求標頭，查看HTML訊息內容。
  - 可根據內容應用檢測和過濾規則。

## WAF日誌特性

- **JSON Format**（JSON格式）：WAF常用的日誌格式，全稱JavaScript物件表示法。
  - 日誌內含豐富資訊，包括：
    - 事件發生時間
    - 事件嚴重程度
    - URL參數（如本地資源路徑或查詢字串）
    - HTTP方法（如POST請求或GET請求）
    - 規則的上下文（可能包含對已知漏洞資料庫、攻擊技術或知識庫文章的參考）

## WAF應用案例

- **WAF使用時機**：當需要保護網頁伺服器時，特別是防止以下攻擊：
  - SQL注入攻擊
  - XML注入攻擊
  - 跨站腳本攻擊（XSS）
  - 任何在OSI模型第七層（應用層）運作的攻擊

- **實際應用範例**：
  - 能夠識別漏洞掃描工具（如Nikto掃描）的活動
  - 可檢測出各類應用層攻擊並觸發對應的安全規則
  - 可記錄大量事件（範例中顯示超過12,000個不同事件）

# 入侵偵測系統與入侵防禦系統配置

## 入侵偵測系統 (IDS)

- **Intrusion Detection System (IDS)**（入侵偵測系統）：軟體或硬體系統，用於掃描、稽核和監控安全基礎架構以發現攻擊跡象。
  - 包含封包嗅探器（稱為感應器），讀取網路上的所有封包
  - 連接分析引擎，使用規則集比對流量，生成事件日誌、通知或警報
  - 僅能偵測和記錄，無法阻止攻擊
  - 通常放置在防火牆內部或需要保護的伺服器附近

- **IDS部署方式**：
  - 在交換環境中需使用SPAN埠（鏡像埠）或網路分流器（TAP）
  - 常見部署位置：DMZ邊緣（企業網際網路存取）和外部網路（Extranet）連接處
  - 這些位置是企業網路與不受信任區域（如DMZ或網際網路）的邊界

## 入侵防禦系統 (IPS)

- **Intrusion Prevention System (IPS)**（入侵防禦系統）：具有主動阻止攻擊能力的IDS。
  - 掃描、稽核和監控安全基礎架構以發現進行中的攻擊
  - 能夠主動阻止攻擊
  - 基於與IDS相同的規則集運作
  - 可配置為對高優先級事件執行阻擋動作

- **IPS運作模式**：
  - **Inline IPS**（內聯IPS）：所有流量都通過IPS，符合需阻擋規則的流量會被直接阻擋
  - 可執行第三方程式來執行其他動作，如記錄、警報或其他自訂動作

## 常見 IDS/IPS 軟體

- **Snort**：開源軟體，適用於Windows和特定Linux發行版。
  - 可配置為IDS或IPS
  - 使用「Oinkcode」簽名系統來識別要阻擋和記錄的內容
  - 付費訂閱可獲得最新的威脅規則集
  - 非訂閱用戶可使用社群編寫的規則集
  - 可在嗅探模式、僅記錄模式或主動回應模式下運作

- **Zeek**（前稱Bro）：開源IDS，適用於Unix和Linux平台。
  - 包含腳本引擎，可對重要事件（稱為通知）採取行動
  - 可生成警報並實施隔離機制
  - 可配置為IDS或IPS

- **Security Onion**：開源Linux平台，用於安全監控、事件回應和威脅獵捕。
  - 整合多種工具，包括Snort、Suricata、Zeek、Wireshark和NetworkMiner
  - 也包含日誌管理和事件管理工具
  - 類似於防禦者版本的Kali Linux（Kali是滲透測試人員的工具集）
  - 適合安全分析師和事件回應人員使用

## 實用建議

- 這些工具大多免費開源，適合下載來熟悉和實踐
- 在考試中不需要成為工具專家，但應了解它們的功能和用途
- 在實際工作環境中，安全分析師和事件回應人員會頻繁使用這些工具

# IDS與IPS日誌筆記

## 日誌概述

- **IDS/IPS日誌**：每當IDS或IPS中的規則被匹配時，都會創建一筆日誌條目。
  - 根據配置，規則可以觸發警報、發送通知或阻擋流量
  - **主要挑戰**：過度記錄（over-logging）會導致資料過多，降低分析師的敏感度，需要適當調整系統

## 輸出格式

IDS/IPS軟體提供多種日誌輸出選項，以Snort為例，有五種主要格式：

- **Unified Output**（統一輸出）：機器可讀的二進位檔案
  - 人類無法直接閱讀，需使用解釋器

- **Syslog**（系統日誌）：標準系統日誌格式
  - 記錄事件詳情，如IP地址、埠號和匹配的規則/簽名
  - 可整合至SIEM或系統日誌軟體

- **CSV**（逗號分隔值）：
  - 使用逗號分隔各欄位
  - 可匯入第三方應用程式，使用正則表達式解析
  - 可在Excel或Google Sheets等電子表格軟體中開啟

- **TCP Dump**：
  - 以PCAP檔案格式輸出
  - 捕獲事件相關的所有封包
  - 適合後續深入分析

- **SIEM輸入**：
  - 可作為安全資訊與事件管理系統的輸入
  - 提供集中儲存庫，整合網路中所有IDS和其他網路設備的日誌

## 監控與分析

- **實時監控**：所有警報需要實時監控以確定是否發生安全事件
  - 如Security Onion中的Squeal工具，提供易用的圖形介面
  - 可查看觸發規則、底層封包資料及封包本身

## 規則結構

IDS/IPS使用規則來創建警報，Snort規則格式是最常見的格式之一：

- **規則基本結構**：動作 + 協議 + 來源IP + 來源埠 + 方向 + 目標IP + 目標埠 + 規則選項

- **動作欄位**（Action）：
  - 常見選項：alert（警報）、log（記錄）、pass（忽略）、drop（丟棄）、reject（拒絕）

- **地址與埠**（Source/Destination Addresses/Ports）：
  - 可設置為關鍵字：any（任何）
  - 可設置為變數：external_net（外部網路）、home_net（內部網路）
  - 可設置為靜態值：如port 80

- **方向**（Direction）：
  - 單向：-> （入站）或 <- （出站）
  - 雙向：<>

- **規則選項**（Rule Options）：
  - **msg**（訊息）：告知回應者觸發規則的文字
  - **flow**：匹配新的或現有的TCP連接
  - **flags**：匹配封包中的標誌（如TCP SYN、FIN、RST）
  - **track**：對規則應用速率限制器
  - **reference**：將條目匹配到攻擊資料庫（如MITRE ATT&CK）
  - **classtype**：攻擊分類（暴力破解、拒絕服務等）
  - **sid**（Snort ID）和**rev**（版本）：規則識別碼和版本號

## 規則範例解析

以下是IMAP郵箱帳戶暴力破解嘗試的Snort規則範例：

```
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 (msg:"PROTOCOL-IMAP login brute force attempt"; 
flow:to_server,established,no_stream; 
content:"LOGON";
fast_pattern:only;
detection_filter:track by_dst, count 30, seconds 30; metadata:ruleset community, service imap;
reference:url,attack.mitre.org/techniques/T1110; 
classtype:suspicious-login; sid:2273; rev:12;)
```

- **動作**：alert（警報）
- **協議**：TCP
- **來源**：外部網路的任何埠
- **方向**：入站（->）
- **目標**：內部網路的143埠（IMAP）
- **訊息**：「PROTOCOL-IMAP login brute force attempt」
- **流量特徵**：前往伺服器，已建立連接
- **內容匹配**：「LOGON」
- **偵測過濾器**：30秒內有30次嘗試才觸發
- **參考**：MITRE ATT&CK技術T1110
- **類型**：可疑登入
- **規則ID**：2273，版本12

# 連接埠安全配置

## 概述

- **Port Security**（連接埠安全）：指封鎖主機和防火牆上未經授權的應用服務埠，或用於允許主機在本地網路上通訊的實體和遠端存取埠。
  - 網路設備（如交換器、路由器和防火牆）也容易受到軟體漏洞和修補不足的影響，需要特別保護

## 網路設備的安全風險

- **嵌入式作業系統風險**：
  - 許多網路設備運行在嵌入式作業系統上（如Linux）
  - 研究人員發現許多網路設備仍在運行存在漏洞、過時或未修補的Linux核心版本
  - 這些設備應納入常規修補程序，與伺服器同等對待

- **網頁管理介面風險**：
  - 許多產品提供網頁前端管理介面
  - 這些介面常受到多種軟體漏洞影響，如跨站腳本攻擊（XSS）和跨站請求偽造（CSRF）
  - 建議停用網頁管理介面，改用SSH殼層以提高安全性

## 網路設備安全最佳實踐

- **使用ACL限制存取**：
  - 僅允許指定的主機設備存取管理介面
  - 限制有權存取管理區域的筆記型電腦或桌上型電腦數量

- **監控指定介面數量**：
  - 限制可連接到防火牆和網路設備的實體埠數量
  - 指定辦公室中的特定埠具有連接權限

- **拒絕透過網際網路進行遠端管理**：
  - 設備的管理介面不應直接暴露在網際網路上
  - 技術人員需要遠端工作時，應先通過VPN連接到本地網路
  - 再連接到管理LAN，避免將管理埠直接暴露於網際網路

## 防止非授權設備

當網路中發現未授權設備時，有三種連接埠安全機制可以防止：

- **Physical Port Security**（實體連接埠安全）：
  - 限制對交換器連接埠和硬體的實體存取
  - 交換器應放置在上鎖的機櫃或網路機房內
  - 未使用的牆壁連接埠可從配線架實體拔除
  - 缺點：需要大量人力且容易出錯

- **MAC Filtering**（MAC篩選）：
  - 電子機制，在交換器或存取點上應用存取控制清單
  - 只允許已批准MAC地址的客戶端連接
  - 缺點：需要手動維護，且攻擊者可輕易更改MAC地址（5-10秒）
  - 單獨使用MAC篩選不足以提供足夠安全性

- **Network Access Control (NAC)**（網路存取控制）：
  - 集合各種協定、政策和硬體
  - 在設備層級對網路存取進行認證和授權
  - 被認為是三種方法中最有效的

## 重要提示

- 網路設備雖然不是傳統意義上的伺服器，但同樣需要嚴格的安全保護
- 實體安全與邏輯安全同等重要
- 單一防護措施往往不夠，應採用多層防禦策略

# 網路存取控制 (NAC) 配置

## NAC 基礎概念

- **Network Access Control (NAC)**（網路存取控制）：提供在允許網路連接前驗證使用者身份並評估設備完整性的方法。
  - 依賴 **802.1X** 標準，該標準用於封裝 EAP（可擴展認證協定）在區域網路或無線區域網路上的通訊
  - 提供基於連接埠的認證機制

## 802.1X 運作流程

- **連接埠基礎 NAC**：交換器或路由器在啟用連接埠前對連接的設備進行某種認證
  - **Supplicant**（請求者）：請求存取的主機
  - **Authenticator**（認證者）：處理認證請求的交換器或其他網路設備
  - **Authentication Server**（認證伺服器）：驗證憑證的伺服器

- **認證流程**：
  1. 請求者使用 EAPOL（Extensible Authentication Protocol over LAN）與認證者通訊
  2. 認證者將請求轉發至認證伺服器（通常使用 RADIUS 或 DIAMETER 協定）
  3. 認證伺服器檢查憑證後，向認證者發送准許或拒絕存取的回應
  4. 如果獲准，請求者被路由至適當的網路資源（網際網路、LAN 資源、VPN 或 VLAN）
  5. 如果被拒，請求者被置於隔離區或完全拒絕連接

## NAC 關鍵功能

- **姿態評估（Posture Assessment）**：評估終端裝置是否符合健康政策的過程
  - 健康政策檢查項目可包括：
    - 防毒軟體的運行狀態
    - 韌體層級或作業系統修補程式級別
    - 主機防火牆或主機 IDS 的存在
    - 最新的防毒定義
    - 登錄檔掃描或檔案簽名驗證

- **修復（Remediation）**：當設備不符合最低安全政策時的處理程序
  - 例如：提供最新病毒定義、執行掃描，待合規後才允許網路存取

- **准入前和准入後控制（Pre and Post-admission Control）**：
  - **准入前控制**：基於健康政策合規性授予或拒絕客戶端設備存取
  - **准入後控制**：定期檢查已連接設備的合規性，確保持續符合標準
    - 例如：每四小時檢查一次安全更新和防毒狀態，不合規時將設備移至修復區

## NAC 存取控制方法

除了基於健康政策的存取控制外，NAC 還可使用其他方法：

- **時間基礎（Time-based）**：基於時間表定義特定主機的存取期間
  - 例如：僅允許在工作時間（9:00-17:00）存取，或根據不同時區設定不同存取時間

- **位置基礎（Location-based）**：使用 IP 地理位置、GPS 或其他機制評估請求存取的終端位置
  - 例如：若員工通常從佛羅里達登入，突然從義大利登入時會被標記為異常

- **角色基礎（Role-based）**：當設備被用於執行某操作時重新評估其授權，又稱為自適應 NAC
  - 例如：用戶筆電嘗試加入伺服器管理子網時被拒絕，但伺服器則允許連接

- **規則基礎（Rule-based）**：執行一系列複雜規則的准入政策，通常以邏輯陳述式編寫
  - 使用「如果...那麼...」（If...then...）邏輯結構
  - 可結合多個條件（AND、OR）來決定存取許可

## 重要性

- NAC 提供比簡單密碼認證更全面的網路保護
- 可確保連接到網路的設備符合組織的安全標準
- 可動態調整存取權限，根據時間、位置、角色和規則進行授權決策
- 協助組織實現零信任安全模型